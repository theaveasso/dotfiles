"use strict";var mv=Object.create;var ao=Object.defineProperty;var vv=Object.getOwnPropertyDescriptor;var yv=Object.getOwnPropertyNames;var Cv=Object.getPrototypeOf,wv=Object.prototype.hasOwnProperty;var k=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Rv=(n,e)=>{for(var t in e)ao(n,t,{get:e[t],enumerable:!0})},Xl=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of yv(e))!wv.call(n,i)&&i!==t&&ao(n,i,{get:()=>e[i],enumerable:!(r=vv(e,i))||r.enumerable});return n};var Oe=(n,e,t)=>(t=n!=null?mv(Cv(n)):{},Xl(e||!n||!n.__esModule?ao(t,"default",{value:n,enumerable:!0}):t,n)),bv=n=>Xl(ao({},"__esModule",{value:!0}),n);var vi=k((WS,Ql)=>{var Dv="2.0.0",Tv=Number.MAX_SAFE_INTEGER||9007199254740991,Sv=16;Ql.exports={SEMVER_SPEC_VERSION:Dv,MAX_LENGTH:256,MAX_SAFE_INTEGER:Tv,MAX_SAFE_COMPONENT_LENGTH:Sv}});var yi=k((zS,Jl)=>{var _v=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};Jl.exports=_v});var gr=k((Zn,Yl)=>{var{MAX_SAFE_COMPONENT_LENGTH:Is}=vi(),Pv=yi();Zn=Yl.exports={};var Ev=Zn.re=[],B=Zn.src=[],G=Zn.t={},xv=0,ae=(n,e,t)=>{let r=xv++;Pv(n,r,e),G[n]=r,B[r]=e,Ev[r]=new RegExp(e,t?"g":void 0)};ae("NUMERICIDENTIFIER","0|[1-9]\\d*");ae("NUMERICIDENTIFIERLOOSE","[0-9]+");ae("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*");ae("MAINVERSION",`(${B[G.NUMERICIDENTIFIER]})\\.(${B[G.NUMERICIDENTIFIER]})\\.(${B[G.NUMERICIDENTIFIER]})`);ae("MAINVERSIONLOOSE",`(${B[G.NUMERICIDENTIFIERLOOSE]})\\.(${B[G.NUMERICIDENTIFIERLOOSE]})\\.(${B[G.NUMERICIDENTIFIERLOOSE]})`);ae("PRERELEASEIDENTIFIER",`(?:${B[G.NUMERICIDENTIFIER]}|${B[G.NONNUMERICIDENTIFIER]})`);ae("PRERELEASEIDENTIFIERLOOSE",`(?:${B[G.NUMERICIDENTIFIERLOOSE]}|${B[G.NONNUMERICIDENTIFIER]})`);ae("PRERELEASE",`(?:-(${B[G.PRERELEASEIDENTIFIER]}(?:\\.${B[G.PRERELEASEIDENTIFIER]})*))`);ae("PRERELEASELOOSE",`(?:-?(${B[G.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${B[G.PRERELEASEIDENTIFIERLOOSE]})*))`);ae("BUILDIDENTIFIER","[0-9A-Za-z-]+");ae("BUILD",`(?:\\+(${B[G.BUILDIDENTIFIER]}(?:\\.${B[G.BUILDIDENTIFIER]})*))`);ae("FULLPLAIN",`v?${B[G.MAINVERSION]}${B[G.PRERELEASE]}?${B[G.BUILD]}?`);ae("FULL",`^${B[G.FULLPLAIN]}$`);ae("LOOSEPLAIN",`[v=\\s]*${B[G.MAINVERSIONLOOSE]}${B[G.PRERELEASELOOSE]}?${B[G.BUILD]}?`);ae("LOOSE",`^${B[G.LOOSEPLAIN]}$`);ae("GTLT","((?:<|>)?=?)");ae("XRANGEIDENTIFIERLOOSE",`${B[G.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);ae("XRANGEIDENTIFIER",`${B[G.NUMERICIDENTIFIER]}|x|X|\\*`);ae("XRANGEPLAIN",`[v=\\s]*(${B[G.XRANGEIDENTIFIER]})(?:\\.(${B[G.XRANGEIDENTIFIER]})(?:\\.(${B[G.XRANGEIDENTIFIER]})(?:${B[G.PRERELEASE]})?${B[G.BUILD]}?)?)?`);ae("XRANGEPLAINLOOSE",`[v=\\s]*(${B[G.XRANGEIDENTIFIERLOOSE]})(?:\\.(${B[G.XRANGEIDENTIFIERLOOSE]})(?:\\.(${B[G.XRANGEIDENTIFIERLOOSE]})(?:${B[G.PRERELEASELOOSE]})?${B[G.BUILD]}?)?)?`);ae("XRANGE",`^${B[G.GTLT]}\\s*${B[G.XRANGEPLAIN]}$`);ae("XRANGELOOSE",`^${B[G.GTLT]}\\s*${B[G.XRANGEPLAINLOOSE]}$`);ae("COERCE",`(^|[^\\d])(\\d{1,${Is}})(?:\\.(\\d{1,${Is}}))?(?:\\.(\\d{1,${Is}}))?(?:$|[^\\d])`);ae("COERCERTL",B[G.COERCE],!0);ae("LONETILDE","(?:~>?)");ae("TILDETRIM",`(\\s*)${B[G.LONETILDE]}\\s+`,!0);Zn.tildeTrimReplace="$1~";ae("TILDE",`^${B[G.LONETILDE]}${B[G.XRANGEPLAIN]}$`);ae("TILDELOOSE",`^${B[G.LONETILDE]}${B[G.XRANGEPLAINLOOSE]}$`);ae("LONECARET","(?:\\^)");ae("CARETTRIM",`(\\s*)${B[G.LONECARET]}\\s+`,!0);Zn.caretTrimReplace="$1^";ae("CARET",`^${B[G.LONECARET]}${B[G.XRANGEPLAIN]}$`);ae("CARETLOOSE",`^${B[G.LONECARET]}${B[G.XRANGEPLAINLOOSE]}$`);ae("COMPARATORLOOSE",`^${B[G.GTLT]}\\s*(${B[G.LOOSEPLAIN]})$|^$`);ae("COMPARATOR",`^${B[G.GTLT]}\\s*(${B[G.FULLPLAIN]})$|^$`);ae("COMPARATORTRIM",`(\\s*)${B[G.GTLT]}\\s*(${B[G.LOOSEPLAIN]}|${B[G.XRANGEPLAIN]})`,!0);Zn.comparatorTrimReplace="$1$2$3";ae("HYPHENRANGE",`^\\s*(${B[G.XRANGEPLAIN]})\\s+-\\s+(${B[G.XRANGEPLAIN]})\\s*$`);ae("HYPHENRANGELOOSE",`^\\s*(${B[G.XRANGEPLAINLOOSE]})\\s+-\\s+(${B[G.XRANGEPLAINLOOSE]})\\s*$`);ae("STAR","(<|>)?=?\\s*\\*");ae("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");ae("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Ci=k((US,Zl)=>{var kv=["includePrerelease","loose","rtl"],qv=n=>n?typeof n!="object"?{loose:!0}:kv.filter(e=>n[e]).reduce((e,t)=>(e[t]=!0,e),{}):{};Zl.exports=qv});var co=k((KS,nd)=>{var ed=/^[0-9]+$/,td=(n,e)=>{let t=ed.test(n),r=ed.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},Ov=(n,e)=>td(e,n);nd.exports={compareIdentifiers:td,rcompareIdentifiers:Ov}});var Ct=k((VS,sd)=>{var uo=yi(),{MAX_LENGTH:rd,MAX_SAFE_INTEGER:lo}=vi(),{re:id,t:od}=gr(),Iv=Ci(),{compareIdentifiers:Wr}=co(),Ut=class{constructor(e,t){if(t=Iv(t),e instanceof Ut){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>rd)throw new TypeError(`version is longer than ${rd} characters`);uo("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?id[od.LOOSE]:id[od.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>lo||this.major<0)throw new TypeError("Invalid major version");if(this.minor>lo||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>lo||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let o=+i;if(o>=0&&o<lo)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(uo("SemVer.compare",this.version,this.options,e),!(e instanceof Ut)){if(typeof e=="string"&&e===this.version)return 0;e=new Ut(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Ut||(e=new Ut(e,this.options)),Wr(this.major,e.major)||Wr(this.minor,e.minor)||Wr(this.patch,e.patch)}comparePre(e){if(e instanceof Ut||(e=new Ut(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(uo("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Wr(r,i)}while(++t)}compareBuild(e){e instanceof Ut||(e=new Ut(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(uo("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Wr(r,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(Wr(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}};sd.exports=Ut});var mr=k((BS,ld)=>{var{MAX_LENGTH:Nv}=vi(),{re:ad,t:cd}=gr(),ud=Ct(),Fv=Ci(),Lv=(n,e)=>{if(e=Fv(e),n instanceof ud)return n;if(typeof n!="string"||n.length>Nv||!(e.loose?ad[cd.LOOSE]:ad[cd.FULL]).test(n))return null;try{return new ud(n,e)}catch{return null}};ld.exports=Lv});var fd=k((GS,dd)=>{var Av=mr(),Mv=(n,e)=>{let t=Av(n,e);return t?t.version:null};dd.exports=Mv});var hd=k((XS,pd)=>{var jv=mr(),$v=(n,e)=>{let t=jv(n.trim().replace(/^[=v]+/,""),e);return t?t.version:null};pd.exports=$v});var vd=k((QS,md)=>{var gd=Ct(),Hv=(n,e,t,r)=>{typeof t=="string"&&(r=t,t=void 0);try{return new gd(n instanceof gd?n.version:n,t).inc(e,r).version}catch{return null}};md.exports=Hv});var Yt=k((JS,Cd)=>{var yd=Ct(),Wv=(n,e,t)=>new yd(n,t).compare(new yd(e,t));Cd.exports=Wv});var fo=k((YS,wd)=>{var zv=Yt(),Uv=(n,e,t)=>zv(n,e,t)===0;wd.exports=Uv});var Dd=k((ZS,bd)=>{var Rd=mr(),Kv=fo(),Vv=(n,e)=>{if(Kv(n,e))return null;{let t=Rd(n),r=Rd(e),i=t.prerelease.length||r.prerelease.length,o=i?"pre":"",s=i?"prerelease":"";for(let a in t)if((a==="major"||a==="minor"||a==="patch")&&t[a]!==r[a])return o+a;return s}};bd.exports=Vv});var Sd=k((e_,Td)=>{var Bv=Ct(),Gv=(n,e)=>new Bv(n,e).major;Td.exports=Gv});var Pd=k((t_,_d)=>{var Xv=Ct(),Qv=(n,e)=>new Xv(n,e).minor;_d.exports=Qv});var xd=k((n_,Ed)=>{var Jv=Ct(),Yv=(n,e)=>new Jv(n,e).patch;Ed.exports=Yv});var qd=k((r_,kd)=>{var Zv=mr(),ey=(n,e)=>{let t=Zv(n,e);return t&&t.prerelease.length?t.prerelease:null};kd.exports=ey});var Id=k((i_,Od)=>{var ty=Yt(),ny=(n,e,t)=>ty(e,n,t);Od.exports=ny});var Fd=k((o_,Nd)=>{var ry=Yt(),iy=(n,e)=>ry(n,e,!0);Nd.exports=iy});var po=k((s_,Ad)=>{var Ld=Ct(),oy=(n,e,t)=>{let r=new Ld(n,t),i=new Ld(e,t);return r.compare(i)||r.compareBuild(i)};Ad.exports=oy});var jd=k((a_,Md)=>{var sy=po(),ay=(n,e)=>n.sort((t,r)=>sy(t,r,e));Md.exports=ay});var Hd=k((c_,$d)=>{var cy=po(),uy=(n,e)=>n.sort((t,r)=>cy(r,t,e));$d.exports=uy});var wi=k((u_,Wd)=>{var ly=Yt(),dy=(n,e,t)=>ly(n,e,t)>0;Wd.exports=dy});var ho=k((l_,zd)=>{var fy=Yt(),py=(n,e,t)=>fy(n,e,t)<0;zd.exports=py});var Ns=k((d_,Ud)=>{var hy=Yt(),gy=(n,e,t)=>hy(n,e,t)!==0;Ud.exports=gy});var go=k((f_,Kd)=>{var my=Yt(),vy=(n,e,t)=>my(n,e,t)>=0;Kd.exports=vy});var mo=k((p_,Vd)=>{var yy=Yt(),Cy=(n,e,t)=>yy(n,e,t)<=0;Vd.exports=Cy});var Fs=k((h_,Bd)=>{var wy=fo(),Ry=Ns(),by=wi(),Dy=go(),Ty=ho(),Sy=mo(),_y=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return wy(n,t,r);case"!=":return Ry(n,t,r);case">":return by(n,t,r);case">=":return Dy(n,t,r);case"<":return Ty(n,t,r);case"<=":return Sy(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};Bd.exports=_y});var Xd=k((g_,Gd)=>{var Py=Ct(),Ey=mr(),{re:vo,t:yo}=gr(),xy=(n,e)=>{if(n instanceof Py)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;e=e||{};let t=null;if(!e.rtl)t=n.match(vo[yo.COERCE]);else{let r;for(;(r=vo[yo.COERCERTL].exec(n))&&(!t||t.index+t[0].length!==n.length);)(!t||r.index+r[0].length!==t.index+t[0].length)&&(t=r),vo[yo.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;vo[yo.COERCERTL].lastIndex=-1}return t===null?null:Ey(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};Gd.exports=xy});var Jd=k((m_,Qd)=>{"use strict";Qd.exports=function(n){n.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var Zd=k((v_,Yd)=>{"use strict";Yd.exports=ve;ve.Node=vr;ve.create=ve;function ve(n){var e=this;if(e instanceof ve||(e=new ve),e.tail=null,e.head=null,e.length=0,n&&typeof n.forEach=="function")n.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,r=arguments.length;t<r;t++)e.push(arguments[t]);return e}ve.prototype.removeNode=function(n){if(n.list!==this)throw new Error("removing node which does not belong to this list");var e=n.next,t=n.prev;return e&&(e.prev=t),t&&(t.next=e),n===this.head&&(this.head=e),n===this.tail&&(this.tail=t),n.list.length--,n.next=null,n.prev=null,n.list=null,e};ve.prototype.unshiftNode=function(n){if(n!==this.head){n.list&&n.list.removeNode(n);var e=this.head;n.list=this,n.next=e,e&&(e.prev=n),this.head=n,this.tail||(this.tail=n),this.length++}};ve.prototype.pushNode=function(n){if(n!==this.tail){n.list&&n.list.removeNode(n);var e=this.tail;n.list=this,n.prev=e,e&&(e.next=n),this.tail=n,this.head||(this.head=n),this.length++}};ve.prototype.push=function(){for(var n=0,e=arguments.length;n<e;n++)qy(this,arguments[n]);return this.length};ve.prototype.unshift=function(){for(var n=0,e=arguments.length;n<e;n++)Oy(this,arguments[n]);return this.length};ve.prototype.pop=function(){if(!!this.tail){var n=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,n}};ve.prototype.shift=function(){if(!!this.head){var n=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,n}};ve.prototype.forEach=function(n,e){e=e||this;for(var t=this.head,r=0;t!==null;r++)n.call(e,t.value,r,this),t=t.next};ve.prototype.forEachReverse=function(n,e){e=e||this;for(var t=this.tail,r=this.length-1;t!==null;r--)n.call(e,t.value,r,this),t=t.prev};ve.prototype.get=function(n){for(var e=0,t=this.head;t!==null&&e<n;e++)t=t.next;if(e===n&&t!==null)return t.value};ve.prototype.getReverse=function(n){for(var e=0,t=this.tail;t!==null&&e<n;e++)t=t.prev;if(e===n&&t!==null)return t.value};ve.prototype.map=function(n,e){e=e||this;for(var t=new ve,r=this.head;r!==null;)t.push(n.call(e,r.value,this)),r=r.next;return t};ve.prototype.mapReverse=function(n,e){e=e||this;for(var t=new ve,r=this.tail;r!==null;)t.push(n.call(e,r.value,this)),r=r.prev;return t};ve.prototype.reduce=function(n,e){var t,r=this.head;if(arguments.length>1)t=e;else if(this.head)r=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)t=n(t,r.value,i),r=r.next;return t};ve.prototype.reduceReverse=function(n,e){var t,r=this.tail;if(arguments.length>1)t=e;else if(this.tail)r=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)t=n(t,r.value,i),r=r.prev;return t};ve.prototype.toArray=function(){for(var n=new Array(this.length),e=0,t=this.head;t!==null;e++)n[e]=t.value,t=t.next;return n};ve.prototype.toArrayReverse=function(){for(var n=new Array(this.length),e=0,t=this.tail;t!==null;e++)n[e]=t.value,t=t.prev;return n};ve.prototype.slice=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new ve;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(;i!==null&&r<e;r++,i=i.next)t.push(i.value);return t};ve.prototype.sliceReverse=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new ve;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;i!==null&&r>e;r--)i=i.prev;for(;i!==null&&r>n;r--,i=i.prev)t.push(i.value);return t};ve.prototype.splice=function(n,e,...t){n>this.length&&(n=this.length-1),n<0&&(n=this.length+n);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(var o=[],r=0;i&&r<e;r++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<t.length;r++)i=ky(this,i,t[r]);return o};ve.prototype.reverse=function(){for(var n=this.head,e=this.tail,t=n;t!==null;t=t.prev){var r=t.prev;t.prev=t.next,t.next=r}return this.head=e,this.tail=n,this};function ky(n,e,t){var r=e===n.head?new vr(t,null,e,n):new vr(t,e,e.next,n);return r.next===null&&(n.tail=r),r.prev===null&&(n.head=r),n.length++,r}function qy(n,e){n.tail=new vr(e,n.tail,null,n),n.head||(n.head=n.tail),n.length++}function Oy(n,e){n.head=new vr(e,null,n.head,n),n.tail||(n.tail=n.head),n.length++}function vr(n,e,t,r){if(!(this instanceof vr))return new vr(n,e,t,r);this.list=r,this.value=n,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{Jd()(ve)}catch{}});var of=k((y_,rf)=>{"use strict";var Iy=Zd(),yr=Symbol("max"),Ln=Symbol("length"),zr=Symbol("lengthCalculator"),bi=Symbol("allowStale"),Cr=Symbol("maxAge"),Fn=Symbol("dispose"),ef=Symbol("noDisposeOnSet"),ot=Symbol("lruList"),an=Symbol("cache"),nf=Symbol("updateAgeOnGet"),Ls=()=>1,Ms=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let t=this[yr]=e.max||1/0,r=e.length||Ls;if(this[zr]=typeof r!="function"?Ls:r,this[bi]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Cr]=e.maxAge||0,this[Fn]=e.dispose,this[ef]=e.noDisposeOnSet||!1,this[nf]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[yr]=e||1/0,Ri(this)}get max(){return this[yr]}set allowStale(e){this[bi]=!!e}get allowStale(){return this[bi]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Cr]=e,Ri(this)}get maxAge(){return this[Cr]}set lengthCalculator(e){typeof e!="function"&&(e=Ls),e!==this[zr]&&(this[zr]=e,this[Ln]=0,this[ot].forEach(t=>{t.length=this[zr](t.value,t.key),this[Ln]+=t.length})),Ri(this)}get lengthCalculator(){return this[zr]}get length(){return this[Ln]}get itemCount(){return this[ot].length}rforEach(e,t){t=t||this;for(let r=this[ot].tail;r!==null;){let i=r.prev;tf(this,e,r,t),r=i}}forEach(e,t){t=t||this;for(let r=this[ot].head;r!==null;){let i=r.next;tf(this,e,r,t),r=i}}keys(){return this[ot].toArray().map(e=>e.key)}values(){return this[ot].toArray().map(e=>e.value)}reset(){this[Fn]&&this[ot]&&this[ot].length&&this[ot].forEach(e=>this[Fn](e.key,e.value)),this[an]=new Map,this[ot]=new Iy,this[Ln]=0}dump(){return this[ot].map(e=>Co(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[ot]}set(e,t,r){if(r=r||this[Cr],r&&typeof r!="number")throw new TypeError("maxAge must be a number");let i=r?Date.now():0,o=this[zr](t,e);if(this[an].has(e)){if(o>this[yr])return Ur(this,this[an].get(e)),!1;let c=this[an].get(e).value;return this[Fn]&&(this[ef]||this[Fn](e,c.value)),c.now=i,c.maxAge=r,c.value=t,this[Ln]+=o-c.length,c.length=o,this.get(e),Ri(this),!0}let s=new js(e,t,o,i,r);return s.length>this[yr]?(this[Fn]&&this[Fn](e,t),!1):(this[Ln]+=s.length,this[ot].unshift(s),this[an].set(e,this[ot].head),Ri(this),!0)}has(e){if(!this[an].has(e))return!1;let t=this[an].get(e).value;return!Co(this,t)}get(e){return As(this,e,!0)}peek(e){return As(this,e,!1)}pop(){let e=this[ot].tail;return e?(Ur(this,e),e.value):null}del(e){Ur(this,this[an].get(e))}load(e){this.reset();let t=Date.now();for(let r=e.length-1;r>=0;r--){let i=e[r],o=i.e||0;if(o===0)this.set(i.k,i.v);else{let s=o-t;s>0&&this.set(i.k,i.v,s)}}}prune(){this[an].forEach((e,t)=>As(this,t,!1))}},As=(n,e,t)=>{let r=n[an].get(e);if(r){let i=r.value;if(Co(n,i)){if(Ur(n,r),!n[bi])return}else t&&(n[nf]&&(r.value.now=Date.now()),n[ot].unshiftNode(r));return i.value}},Co=(n,e)=>{if(!e||!e.maxAge&&!n[Cr])return!1;let t=Date.now()-e.now;return e.maxAge?t>e.maxAge:n[Cr]&&t>n[Cr]},Ri=n=>{if(n[Ln]>n[yr])for(let e=n[ot].tail;n[Ln]>n[yr]&&e!==null;){let t=e.prev;Ur(n,e),e=t}},Ur=(n,e)=>{if(e){let t=e.value;n[Fn]&&n[Fn](t.key,t.value),n[Ln]-=t.length,n[an].delete(t.key),n[ot].removeNode(e)}},js=class{constructor(e,t,r,i,o){this.key=e,this.value=t,this.length=r,this.now=i,this.maxAge=o||0}},tf=(n,e,t,r)=>{let i=t.value;Co(n,i)&&(Ur(n,t),n[bi]||(i=void 0)),i&&e.call(r,i.value,i.key,n)};rf.exports=Ms});var Zt=k((C_,uf)=>{var wr=class{constructor(e,t){if(t=Fy(t),e instanceof wr)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new wr(e.raw,t);if(e instanceof $s)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split("||").map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!af(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&$y(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();let r=`parseRange:${Object.keys(this.options).join(",")}:${e}`,i=sf.get(r);if(i)return i;let o=this.options.loose,s=o?Lt[St.HYPHENRANGELOOSE]:Lt[St.HYPHENRANGE];e=e.replace(s,Qy(this.options.includePrerelease)),Me("hyphen replace",e),e=e.replace(Lt[St.COMPARATORTRIM],Ay),Me("comparator trim",e),e=e.replace(Lt[St.TILDETRIM],My),e=e.replace(Lt[St.CARETTRIM],jy),e=e.split(/\s+/).join(" ");let a=e.split(" ").map(m=>Hy(m,this.options)).join(" ").split(/\s+/).map(m=>Xy(m,this.options));o&&(a=a.filter(m=>(Me("loose invalid filter",m,this.options),!!m.match(Lt[St.COMPARATORLOOSE])))),Me("range list",a);let c=new Map,l=a.map(m=>new $s(m,this.options));for(let m of l){if(af(m))return[m];c.set(m.value,m)}c.size>1&&c.has("")&&c.delete("");let g=[...c.values()];return sf.set(r,g),g}intersects(e,t){if(!(e instanceof wr))throw new TypeError("a Range is required");return this.set.some(r=>cf(r,t)&&e.set.some(i=>cf(i,t)&&r.every(o=>i.every(s=>o.intersects(s,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new Ly(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(Jy(this.set[t],e,this.options))return!0;return!1}};uf.exports=wr;var Ny=of(),sf=new Ny({max:1e3}),Fy=Ci(),$s=Di(),Me=yi(),Ly=Ct(),{re:Lt,t:St,comparatorTrimReplace:Ay,tildeTrimReplace:My,caretTrimReplace:jy}=gr(),af=n=>n.value==="<0.0.0-0",$y=n=>n.value==="",cf=(n,e)=>{let t=!0,r=n.slice(),i=r.pop();for(;t&&r.length;)t=r.every(o=>i.intersects(o,e)),i=r.pop();return t},Hy=(n,e)=>(Me("comp",n,e),n=Uy(n,e),Me("caret",n),n=Wy(n,e),Me("tildes",n),n=Vy(n,e),Me("xrange",n),n=Gy(n,e),Me("stars",n),n),_t=n=>!n||n.toLowerCase()==="x"||n==="*",Wy=(n,e)=>n.trim().split(/\s+/).map(t=>zy(t,e)).join(" "),zy=(n,e)=>{let t=e.loose?Lt[St.TILDELOOSE]:Lt[St.TILDE];return n.replace(t,(r,i,o,s,a)=>{Me("tilde",n,r,i,o,s,a);let c;return _t(i)?c="":_t(o)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:_t(s)?c=`>=${i}.${o}.0 <${i}.${+o+1}.0-0`:a?(Me("replaceTilde pr",a),c=`>=${i}.${o}.${s}-${a} <${i}.${+o+1}.0-0`):c=`>=${i}.${o}.${s} <${i}.${+o+1}.0-0`,Me("tilde return",c),c})},Uy=(n,e)=>n.trim().split(/\s+/).map(t=>Ky(t,e)).join(" "),Ky=(n,e)=>{Me("caret",n,e);let t=e.loose?Lt[St.CARETLOOSE]:Lt[St.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(i,o,s,a,c)=>{Me("caret",n,i,o,s,a,c);let l;return _t(o)?l="":_t(s)?l=`>=${o}.0.0${r} <${+o+1}.0.0-0`:_t(a)?o==="0"?l=`>=${o}.${s}.0${r} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.0${r} <${+o+1}.0.0-0`:c?(Me("replaceCaret pr",c),o==="0"?s==="0"?l=`>=${o}.${s}.${a}-${c} <${o}.${s}.${+a+1}-0`:l=`>=${o}.${s}.${a}-${c} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.${a}-${c} <${+o+1}.0.0-0`):(Me("no pr"),o==="0"?s==="0"?l=`>=${o}.${s}.${a}${r} <${o}.${s}.${+a+1}-0`:l=`>=${o}.${s}.${a}${r} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.${a} <${+o+1}.0.0-0`),Me("caret return",l),l})},Vy=(n,e)=>(Me("replaceXRanges",n,e),n.split(/\s+/).map(t=>By(t,e)).join(" ")),By=(n,e)=>{n=n.trim();let t=e.loose?Lt[St.XRANGELOOSE]:Lt[St.XRANGE];return n.replace(t,(r,i,o,s,a,c)=>{Me("xRange",n,r,i,o,s,a,c);let l=_t(o),g=l||_t(s),m=g||_t(a),h=m;return i==="="&&h&&(i=""),c=e.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&h?(g&&(s=0),a=0,i===">"?(i=">=",g?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",g?o=+o+1:s=+s+1),i==="<"&&(c="-0"),r=`${i+o}.${s}.${a}${c}`):g?r=`>=${o}.0.0${c} <${+o+1}.0.0-0`:m&&(r=`>=${o}.${s}.0${c} <${o}.${+s+1}.0-0`),Me("xRange return",r),r})},Gy=(n,e)=>(Me("replaceStars",n,e),n.trim().replace(Lt[St.STAR],"")),Xy=(n,e)=>(Me("replaceGTE0",n,e),n.trim().replace(Lt[e.includePrerelease?St.GTE0PRE:St.GTE0],"")),Qy=n=>(e,t,r,i,o,s,a,c,l,g,m,h,C)=>(_t(r)?t="":_t(i)?t=`>=${r}.0.0${n?"-0":""}`:_t(o)?t=`>=${r}.${i}.0${n?"-0":""}`:s?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,_t(l)?c="":_t(g)?c=`<${+l+1}.0.0-0`:_t(m)?c=`<${l}.${+g+1}.0-0`:h?c=`<=${l}.${g}.${m}-${h}`:n?c=`<${l}.${g}.${+m+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),Jy=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(Me(n[r].semver),n[r].semver!==$s.ANY&&n[r].semver.prerelease.length>0){let i=n[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var Di=k((w_,hf)=>{var Ti=Symbol("SemVer ANY"),Kr=class{static get ANY(){return Ti}constructor(e,t){if(t=Yy(t),e instanceof Kr){if(e.loose===!!t.loose)return e;e=e.value}Ws("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Ti?this.value="":this.value=this.operator+this.semver.version,Ws("comp",this)}parse(e){let t=this.options.loose?lf[df.COMPARATORLOOSE]:lf[df.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new ff(r[2],this.options.loose):this.semver=Ti}toString(){return this.value}test(e){if(Ws("Comparator.test",e,this.options.loose),this.semver===Ti||e===Ti)return!0;if(typeof e=="string")try{e=new ff(e,this.options)}catch{return!1}return Hs(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Kr))throw new TypeError("a Comparator is required");if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new pf(e.value,t).test(this.value);if(e.operator==="")return e.value===""?!0:new pf(this.value,t).test(e.semver);let r=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),o=this.semver.version===e.semver.version,s=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),a=Hs(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),c=Hs(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return r||i||o&&s||a||c}};hf.exports=Kr;var Yy=Ci(),{re:lf,t:df}=gr(),Hs=Fs(),Ws=yi(),ff=Ct(),pf=Zt()});var Si=k((R_,gf)=>{var Zy=Zt(),eC=(n,e,t)=>{try{e=new Zy(e,t)}catch{return!1}return e.test(n)};gf.exports=eC});var vf=k((b_,mf)=>{var tC=Zt(),nC=(n,e)=>new tC(n,e).set.map(t=>t.map(r=>r.value).join(" ").trim().split(" "));mf.exports=nC});var Cf=k((D_,yf)=>{var rC=Ct(),iC=Zt(),oC=(n,e,t)=>{let r=null,i=null,o=null;try{o=new iC(e,t)}catch{return null}return n.forEach(s=>{o.test(s)&&(!r||i.compare(s)===-1)&&(r=s,i=new rC(r,t))}),r};yf.exports=oC});var Rf=k((T_,wf)=>{var sC=Ct(),aC=Zt(),cC=(n,e,t)=>{let r=null,i=null,o=null;try{o=new aC(e,t)}catch{return null}return n.forEach(s=>{o.test(s)&&(!r||i.compare(s)===1)&&(r=s,i=new sC(r,t))}),r};wf.exports=cC});var Tf=k((S_,Df)=>{var zs=Ct(),uC=Zt(),bf=wi(),lC=(n,e)=>{n=new uC(n,e);let t=new zs("0.0.0");if(n.test(t)||(t=new zs("0.0.0-0"),n.test(t)))return t;t=null;for(let r=0;r<n.set.length;++r){let i=n.set[r],o=null;i.forEach(s=>{let a=new zs(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!o||bf(a,o))&&(o=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),o&&(!t||bf(t,o))&&(t=o)}return t&&n.test(t)?t:null};Df.exports=lC});var _f=k((__,Sf)=>{var dC=Zt(),fC=(n,e)=>{try{return new dC(n,e).range||"*"}catch{return null}};Sf.exports=fC});var wo=k((P_,kf)=>{var pC=Ct(),xf=Di(),{ANY:hC}=xf,gC=Zt(),mC=Si(),Pf=wi(),Ef=ho(),vC=mo(),yC=go(),CC=(n,e,t,r)=>{n=new pC(n,r),e=new gC(e,r);let i,o,s,a,c;switch(t){case">":i=Pf,o=vC,s=Ef,a=">",c=">=";break;case"<":i=Ef,o=yC,s=Pf,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(mC(n,e,r))return!1;for(let l=0;l<e.set.length;++l){let g=e.set[l],m=null,h=null;if(g.forEach(C=>{C.semver===hC&&(C=new xf(">=0.0.0")),m=m||C,h=h||C,i(C.semver,m.semver,r)?m=C:s(C.semver,h.semver,r)&&(h=C)}),m.operator===a||m.operator===c||(!h.operator||h.operator===a)&&o(n,h.semver))return!1;if(h.operator===c&&s(n,h.semver))return!1}return!0};kf.exports=CC});var Of=k((E_,qf)=>{var wC=wo(),RC=(n,e,t)=>wC(n,e,">",t);qf.exports=RC});var Nf=k((x_,If)=>{var bC=wo(),DC=(n,e,t)=>bC(n,e,"<",t);If.exports=DC});var Af=k((k_,Lf)=>{var Ff=Zt(),TC=(n,e,t)=>(n=new Ff(n,t),e=new Ff(e,t),n.intersects(e));Lf.exports=TC});var jf=k((q_,Mf)=>{var SC=Si(),_C=Yt();Mf.exports=(n,e,t)=>{let r=[],i=null,o=null,s=n.sort((g,m)=>_C(g,m,t));for(let g of s)SC(g,e,t)?(o=g,i||(i=g)):(o&&r.push([i,o]),o=null,i=null);i&&r.push([i,null]);let a=[];for(let[g,m]of r)g===m?a.push(g):!m&&g===s[0]?a.push("*"):m?g===s[0]?a.push(`<=${m}`):a.push(`${g} - ${m}`):a.push(`>=${g}`);let c=a.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return c.length<l.length?c:e}});var Uf=k((O_,zf)=>{var $f=Zt(),Ro=Di(),{ANY:Us}=Ro,_i=Si(),Ks=Yt(),PC=(n,e,t={})=>{if(n===e)return!0;n=new $f(n,t),e=new $f(e,t);let r=!1;e:for(let i of n.set){for(let o of e.set){let s=EC(i,o,t);if(r=r||s!==null,s)continue e}if(r)return!1}return!0},EC=(n,e,t)=>{if(n===e)return!0;if(n.length===1&&n[0].semver===Us){if(e.length===1&&e[0].semver===Us)return!0;t.includePrerelease?n=[new Ro(">=0.0.0-0")]:n=[new Ro(">=0.0.0")]}if(e.length===1&&e[0].semver===Us){if(t.includePrerelease)return!0;e=[new Ro(">=0.0.0")]}let r=new Set,i,o;for(let C of n)C.operator===">"||C.operator===">="?i=Hf(i,C,t):C.operator==="<"||C.operator==="<="?o=Wf(o,C,t):r.add(C.semver);if(r.size>1)return null;let s;if(i&&o){if(s=Ks(i.semver,o.semver,t),s>0)return null;if(s===0&&(i.operator!==">="||o.operator!=="<="))return null}for(let C of r){if(i&&!_i(C,String(i),t)||o&&!_i(C,String(o),t))return null;for(let b of e)if(!_i(C,String(b),t))return!1;return!0}let a,c,l,g,m=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1,h=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;m&&m.prerelease.length===1&&o.operator==="<"&&m.prerelease[0]===0&&(m=!1);for(let C of e){if(g=g||C.operator===">"||C.operator===">=",l=l||C.operator==="<"||C.operator==="<=",i){if(h&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===h.major&&C.semver.minor===h.minor&&C.semver.patch===h.patch&&(h=!1),C.operator===">"||C.operator===">="){if(a=Hf(i,C,t),a===C&&a!==i)return!1}else if(i.operator===">="&&!_i(i.semver,String(C),t))return!1}if(o){if(m&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===m.major&&C.semver.minor===m.minor&&C.semver.patch===m.patch&&(m=!1),C.operator==="<"||C.operator==="<="){if(c=Wf(o,C,t),c===C&&c!==o)return!1}else if(o.operator==="<="&&!_i(o.semver,String(C),t))return!1}if(!C.operator&&(o||i)&&s!==0)return!1}return!(i&&l&&!o&&s!==0||o&&g&&!i&&s!==0||h||m)},Hf=(n,e,t)=>{if(!n)return e;let r=Ks(n.semver,e.semver,t);return r>0?n:r<0||e.operator===">"&&n.operator===">="?e:n},Wf=(n,e,t)=>{if(!n)return e;let r=Ks(n.semver,e.semver,t);return r<0?n:r>0||e.operator==="<"&&n.operator==="<="?e:n};zf.exports=PC});var Vf=k((I_,Kf)=>{var Vs=gr();Kf.exports={re:Vs.re,src:Vs.src,tokens:Vs.t,SEMVER_SPEC_VERSION:vi().SEMVER_SPEC_VERSION,SemVer:Ct(),compareIdentifiers:co().compareIdentifiers,rcompareIdentifiers:co().rcompareIdentifiers,parse:mr(),valid:fd(),clean:hd(),inc:vd(),diff:Dd(),major:Sd(),minor:Pd(),patch:xd(),prerelease:qd(),compare:Yt(),rcompare:Id(),compareLoose:Fd(),compareBuild:po(),sort:jd(),rsort:Hd(),gt:wi(),lt:ho(),eq:fo(),neq:Ns(),gte:go(),lte:mo(),cmp:Fs(),coerce:Xd(),Comparator:Di(),Range:Zt(),satisfies:Si(),toComparators:vf(),maxSatisfying:Cf(),minSatisfying:Rf(),minVersion:Tf(),validRange:_f(),outside:wo(),gtr:Of(),ltr:Nf(),intersects:Af(),simplifyRange:jf(),subset:Uf()}});var Rn=k(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});ze.asPromise=ze.thenable=ze.typedArray=ze.stringArray=ze.array=ze.func=ze.error=ze.number=ze.string=ze.boolean=void 0;function xC(n){return n===!0||n===!1}ze.boolean=xC;function Bf(n){return typeof n=="string"||n instanceof String}ze.string=Bf;function kC(n){return typeof n=="number"||n instanceof Number}ze.number=kC;function qC(n){return n instanceof Error}ze.error=qC;function Gf(n){return typeof n=="function"}ze.func=Gf;function Xf(n){return Array.isArray(n)}ze.array=Xf;function OC(n){return Xf(n)&&n.every(e=>Bf(e))}ze.stringArray=OC;function IC(n,e){return Array.isArray(n)&&n.every(e)}ze.typedArray=IC;function Qf(n){return n&&Gf(n.then)}ze.thenable=Qf;function NC(n){return n instanceof Promise?n:Qf(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}ze.asPromise=NC});var An=k(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});var Bs;function Gs(){if(Bs===void 0)throw new Error("No runtime abstraction layer installed");return Bs}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");Bs=t}n.install=e})(Gs||(Gs={}));Xs.default=Gs});var Qs=k(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});Pi.Disposable=void 0;var FC;(function(n){function e(t){return{dispose:t}}n.create=e})(FC=Pi.Disposable||(Pi.Disposable={}))});var Jf=k(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.AbstractMessageBuffer=void 0;var LC=13,AC=10,MC=`\r
`,Js=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(this._chunks.length===0)return;let e=0,t=0,r=0,i=0;e:for(;t<this._chunks.length;){let c=this._chunks[t];r=0;t:for(;r<c.length;){switch(c[r]){case LC:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case AC:switch(e){case 1:e=2;break;case 3:e=4,r++;break e;default:e=0}break;default:e=0}r++}i+=c.byteLength,t++}if(e!==4)return;let o=this._read(i+r),s=new Map,a=this.toString(o,"ascii").split(MC);if(a.length<2)return s;for(let c=0;c<a.length-2;c++){let l=a[c],g=l.indexOf(":");if(g===-1)throw new Error("Message header must separate key and value using :");let m=l.substr(0,g),h=l.substr(g+1).trim();s.set(m,h)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){let o=this._chunks[0],s=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,s}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let o=this._chunks[i];if(o.byteLength>e){let s=o.slice(0,e);t.set(s,r),r+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else t.set(o,r),r+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return t}};bo.AbstractMessageBuffer=Js});var ep=k(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});var jC=An(),Yf=require("util"),Rr=Qs(),$C=Jf(),Vr=class extends $C.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return Vr.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new Yf.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};Vr.emptyBuffer=Buffer.allocUnsafe(0);var Ys=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Rr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Rr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Rr.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),Rr.Disposable.create(()=>this.stream.off("data",e))}},Zs=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Rr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Rr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Rr.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{let o=s=>{s==null?r():i(s)};typeof e=="string"?this.stream.write(e,t,o):this.stream.write(e,o)})}end(){this.stream.end()}},Zf=Object.freeze({messageBuffer:Object.freeze({create:n=>new Vr(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new Yf.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new Ys(n),asWritableStream:n=>new Zs(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function ea(){return Zf}(function(n){function e(){jC.default.install(Zf)}n.install=e})(ea||(ea={}));ta.default=ea});var Br=k(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.stringArray=wt.array=wt.func=wt.error=wt.number=wt.string=wt.boolean=void 0;function HC(n){return n===!0||n===!1}wt.boolean=HC;function tp(n){return typeof n=="string"||n instanceof String}wt.string=tp;function WC(n){return typeof n=="number"||n instanceof Number}wt.number=WC;function zC(n){return n instanceof Error}wt.error=zC;function UC(n){return typeof n=="function"}wt.func=UC;function np(n){return Array.isArray(n)}wt.array=np;function KC(n){return np(n)&&n.every(e=>tp(e))}wt.stringArray=KC});var Ta=k(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.Message=Q.NotificationType9=Q.NotificationType8=Q.NotificationType7=Q.NotificationType6=Q.NotificationType5=Q.NotificationType4=Q.NotificationType3=Q.NotificationType2=Q.NotificationType1=Q.NotificationType0=Q.NotificationType=Q.RequestType9=Q.RequestType8=Q.RequestType7=Q.RequestType6=Q.RequestType5=Q.RequestType4=Q.RequestType3=Q.RequestType2=Q.RequestType1=Q.RequestType=Q.RequestType0=Q.AbstractMessageSignature=Q.ParameterStructures=Q.ResponseError=Q.ErrorCodes=void 0;var br=Br(),rp;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=n.jsonrpcReservedErrorRangeStart,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=n.jsonrpcReservedErrorRangeEnd})(rp=Q.ErrorCodes||(Q.ErrorCodes={}));var Ei=class extends Error{constructor(e,t,r){super(t),this.code=br.number(e)?e:rp.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,Ei.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};Q.ResponseError=Ei;var st=class{constructor(e){this.kind=e}static is(e){return e===st.auto||e===st.byName||e===st.byPosition}toString(){return this.kind}};Q.ParameterStructures=st;st.auto=new st("auto");st.byPosition=new st("byPosition");st.byName=new st("byName");var Ie=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return st.auto}};Q.AbstractMessageSignature=Ie;var na=class extends Ie{constructor(e){super(e,0)}};Q.RequestType0=na;var ra=class extends Ie{constructor(e,t=st.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.RequestType=ra;var ia=class extends Ie{constructor(e,t=st.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.RequestType1=ia;var oa=class extends Ie{constructor(e){super(e,2)}};Q.RequestType2=oa;var sa=class extends Ie{constructor(e){super(e,3)}};Q.RequestType3=sa;var aa=class extends Ie{constructor(e){super(e,4)}};Q.RequestType4=aa;var ca=class extends Ie{constructor(e){super(e,5)}};Q.RequestType5=ca;var ua=class extends Ie{constructor(e){super(e,6)}};Q.RequestType6=ua;var la=class extends Ie{constructor(e){super(e,7)}};Q.RequestType7=la;var da=class extends Ie{constructor(e){super(e,8)}};Q.RequestType8=da;var fa=class extends Ie{constructor(e){super(e,9)}};Q.RequestType9=fa;var pa=class extends Ie{constructor(e,t=st.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.NotificationType=pa;var ha=class extends Ie{constructor(e){super(e,0)}};Q.NotificationType0=ha;var ga=class extends Ie{constructor(e,t=st.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.NotificationType1=ga;var ma=class extends Ie{constructor(e){super(e,2)}};Q.NotificationType2=ma;var va=class extends Ie{constructor(e){super(e,3)}};Q.NotificationType3=va;var ya=class extends Ie{constructor(e){super(e,4)}};Q.NotificationType4=ya;var Ca=class extends Ie{constructor(e){super(e,5)}};Q.NotificationType5=Ca;var wa=class extends Ie{constructor(e){super(e,6)}};Q.NotificationType6=wa;var Ra=class extends Ie{constructor(e){super(e,7)}};Q.NotificationType7=Ra;var ba=class extends Ie{constructor(e){super(e,8)}};Q.NotificationType8=ba;var Da=class extends Ie{constructor(e){super(e,9)}};Q.NotificationType9=Da;var VC;(function(n){function e(i){let o=i;return o&&br.string(o.method)&&(br.string(o.id)||br.number(o.id))}n.isRequest=e;function t(i){let o=i;return o&&br.string(o.method)&&i.id===void 0}n.isNotification=t;function r(i){let o=i;return o&&(o.result!==void 0||!!o.error)&&(br.string(o.id)||br.number(o.id)||o.id===null)}n.isResponse=r})(VC=Q.Message||(Q.Message={}))});var _a=k(Mn=>{"use strict";var ip;Object.defineProperty(Mn,"__esModule",{value:!0});Mn.LRUCache=Mn.LinkedMap=Mn.Touch=void 0;var Pt;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Pt=Mn.Touch||(Mn.Touch={}));var Do=class{constructor(){this[ip]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Pt.None){let r=this._map.get(e);if(!!r)return t!==Pt.None&&this.touch(r,t),r.value}set(e,t,r=Pt.None){let i=this._map.get(e);if(i)i.value=t,r!==Pt.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case Pt.None:this.addItemLast(i);break;case Pt.First:this.addItemFirst(i);break;case Pt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(!!t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(ip=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Pt.First&&t!==Pt.Last)){if(t===Pt.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Pt.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};Mn.LinkedMap=Do;var Sa=class extends Do{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Pt.AsNew){return super.get(e,t)}peek(e){return super.get(e,Pt.None)}set(e,t){return super.set(e,t,Pt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};Mn.LRUCache=Sa});var Xr=k(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.Emitter=Dr.Event=void 0;var BC=An(),GC;(function(n){let e={dispose(){}};n.None=function(){return e}})(GC=Dr.Event||(Dr.Event={}));var Pa=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,s=r.length;o<s;o++)try{t.push(r[o].apply(i[o],e))}catch(a){(0,BC.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},Gr=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new Pa),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{!this._callbacks||(this._callbacks.remove(e,t),i.dispose=Gr._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Dr.Emitter=Gr;Gr._noop=function(){}});var qa=k(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.CancellationTokenSource=Tr.CancellationToken=void 0;var XC=An(),QC=Br(),Ea=Xr(),xa;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ea.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Ea.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||QC.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(xa=Tr.CancellationToken||(Tr.CancellationToken={}));var JC=Object.freeze(function(n,e){let t=(0,XC.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),To=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?JC:(this._emitter||(this._emitter=new Ea.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},ka=class{get token(){return this._token||(this._token=new To),this._token}cancel(){this._token?this._token.cancel():this._token=xa.Cancelled}dispose(){this._token?this._token instanceof To&&this._token.dispose():this._token=xa.None}};Tr.CancellationTokenSource=ka});var op=k(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.ReadableStreamMessageReader=jn.AbstractMessageReader=jn.MessageReader=void 0;var Ia=An(),Qr=Br(),Oa=Xr(),YC;(function(n){function e(t){let r=t;return r&&Qr.func(r.listen)&&Qr.func(r.dispose)&&Qr.func(r.onError)&&Qr.func(r.onClose)&&Qr.func(r.onPartialMessage)}n.is=e})(YC=jn.MessageReader||(jn.MessageReader={}));var So=class{constructor(){this.errorEmitter=new Oa.Emitter,this.closeEmitter=new Oa.Emitter,this.partialMessageEmitter=new Oa.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${Qr.string(e.message)?e.message:"unknown"}`)}};jn.AbstractMessageReader=So;var Na;(function(n){function e(t){let r,i,o,s=new Map,a,c=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(o=t.contentDecoder,s.set(o.name,o)),t.contentDecoders!==void 0)for(let l of t.contentDecoders)s.set(l.name,l);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,c.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let l of t.contentTypeDecoders)c.set(l.name,l)}return a===void 0&&(a=(0,Ia.default)().applicationJson.decoder,c.set(a.name,a)),{charset:r,contentDecoder:o,contentDecoders:s,contentTypeDecoder:a,contentTypeDecoders:c}}n.fromOptions=e})(Na||(Na={}));var Fa=class extends So{constructor(e,t){super(),this.readable=e,this.options=Na.fromOptions(t),this.buffer=(0,Ia.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let i=this.buffer.tryReadHeaders();if(!i)return;let o=i.get("Content-Length");if(!o)throw new Error("Header must provide a Content-Length property.");let s=parseInt(o);if(isNaN(s))throw new Error("Content-Length value must be a number.");this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1;let r;this.options.contentDecoder!==void 0?r=this.options.contentDecoder.decode(t):r=Promise.resolve(t),r.then(i=>{this.options.contentTypeDecoder.decode(i,this.options).then(o=>{this.callback(o)},o=>{this.fireError(o)})},i=>{this.fireError(i)})}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Ia.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};jn.ReadableStreamMessageReader=Fa});var sp=k(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.Semaphore=void 0;var ZC=An(),La=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,ZC.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};_o.Semaphore=La});var lp=k($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.WriteableStreamMessageWriter=$n.AbstractMessageWriter=$n.MessageWriter=void 0;var ap=An(),xi=Br(),ew=sp(),cp=Xr(),tw="Content-Length: ",up=`\r
`,nw;(function(n){function e(t){let r=t;return r&&xi.func(r.dispose)&&xi.func(r.onClose)&&xi.func(r.onError)&&xi.func(r.write)}n.is=e})(nw=$n.MessageWriter||($n.MessageWriter={}));var Po=class{constructor(){this.errorEmitter=new cp.Emitter,this.closeEmitter=new cp.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${xi.string(e.message)?e.message:"unknown"}`)}};$n.AbstractMessageWriter=Po;var Aa;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,ap.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,ap.default)().applicationJson.encoder}}n.fromOptions=e})(Aa||(Aa={}));var Ma=class extends Po{constructor(e,t){super(),this.writable=e,this.options=Aa.fromOptions(t),this.errorCount=0,this.writeSemaphore=new ew.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(tw,r.byteLength.toString(),up),i.push(up),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};$n.WriteableStreamMessageWriter=Ma});var mp=k(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.createMessageConnection=Y.ConnectionOptions=Y.CancellationStrategy=Y.CancellationSenderStrategy=Y.CancellationReceiverStrategy=Y.ConnectionStrategy=Y.ConnectionError=Y.ConnectionErrors=Y.LogTraceNotification=Y.SetTraceNotification=Y.TraceFormat=Y.Trace=Y.NullLogger=Y.ProgressType=Y.ProgressToken=void 0;var dp=An(),nt=Br(),ee=Ta(),fp=_a(),ki=Xr(),ja=qa(),Oi;(function(n){n.type=new ee.NotificationType("$/cancelRequest")})(Oi||(Oi={}));var pp;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(pp=Y.ProgressToken||(Y.ProgressToken={}));var qi;(function(n){n.type=new ee.NotificationType("$/progress")})(qi||(qi={}));var $a=class{constructor(){}};Y.ProgressType=$a;var Ha;(function(n){function e(t){return nt.func(t)}n.is=e})(Ha||(Ha={}));Y.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var be;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(be=Y.Trace||(Y.Trace={}));(function(n){function e(r){if(!nt.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})(be=Y.Trace||(Y.Trace={}));var cn;(function(n){n.Text="text",n.JSON="json"})(cn=Y.TraceFormat||(Y.TraceFormat={}));(function(n){function e(t){return nt.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(cn=Y.TraceFormat||(Y.TraceFormat={}));var hp;(function(n){n.type=new ee.NotificationType("$/setTrace")})(hp=Y.SetTraceNotification||(Y.SetTraceNotification={}));var Wa;(function(n){n.type=new ee.NotificationType("$/logTrace")})(Wa=Y.LogTraceNotification||(Y.LogTraceNotification={}));var Eo;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(Eo=Y.ConnectionErrors||(Y.ConnectionErrors={}));var er=class extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,er.prototype)}};Y.ConnectionError=er;var gp;(function(n){function e(t){let r=t;return r&&nt.func(r.cancelUndispatched)}n.is=e})(gp=Y.ConnectionStrategy||(Y.ConnectionStrategy={}));var za;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new ja.CancellationTokenSource}});function e(t){let r=t;return r&&nt.func(r.createCancellationTokenSource)}n.is=e})(za=Y.CancellationReceiverStrategy||(Y.CancellationReceiverStrategy={}));var Ua;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(Oi.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&nt.func(r.sendCancellation)&&nt.func(r.cleanup)}n.is=e})(Ua=Y.CancellationSenderStrategy||(Y.CancellationSenderStrategy={}));var Ka;(function(n){n.Message=Object.freeze({receiver:za.Message,sender:Ua.Message});function e(t){let r=t;return r&&za.is(r.receiver)&&Ua.is(r.sender)}n.is=e})(Ka=Y.CancellationStrategy||(Y.CancellationStrategy={}));var rw;(function(n){function e(t){let r=t;return r&&(Ka.is(r.cancellationStrategy)||gp.is(r.connectionStrategy))}n.is=e})(rw=Y.ConnectionOptions||(Y.ConnectionOptions={}));var un;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(un||(un={}));function iw(n,e,t,r){let i=t!==void 0?t:Y.NullLogger,o=0,s=0,a=0,c="2.0",l,g=new Map,m,h=new Map,C=new Map,b,x=new fp.LinkedMap,q=new Map,O=new Set,I=new Map,N=be.Off,$=cn.Text,K,de=un.New,se=new ki.Emitter,We=new ki.Emitter,Ge=new ki.Emitter,rt=new ki.Emitter,bt=new ki.Emitter,gt=r&&r.cancellationStrategy?r.cancellationStrategy:Ka.Message;function mt(R){if(R===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+R.toString()}function Dt(R){return R===null?"res-unknown-"+(++a).toString():"res-"+R.toString()}function ct(){return"not-"+(++s).toString()}function vt(R,F){ee.Message.isRequest(F)?R.set(mt(F.id),F):ee.Message.isResponse(F)?R.set(Dt(F.id),F):R.set(ct(),F)}function xn(R){}function Le(){return de===un.Listening}function tt(){return de===un.Closed}function ut(){return de===un.Disposed}function Nt(){(de===un.New||de===un.Listening)&&(de=un.Closed,We.fire(void 0))}function Xe(R){se.fire([R,void 0,void 0])}function dr(R){se.fire(R)}n.onClose(Nt),n.onError(Xe),e.onClose(Nt),e.onError(dr);function Bn(){b||x.size===0||(b=(0,dp.default)().timer.setImmediate(()=>{b=void 0,Gn()}))}function Gn(){if(x.size===0)return;let R=x.shift();try{ee.Message.isRequest(R)?qn(R):ee.Message.isNotification(R)?Xn(R):ee.Message.isResponse(R)?fr(R):Qn(R)}finally{Bn()}}let kn=R=>{try{if(ee.Message.isNotification(R)&&R.method===Oi.type.method){let F=R.params.id,H=mt(F),V=x.get(H);if(ee.Message.isRequest(V)){let ge=r==null?void 0:r.connectionStrategy,me=ge&&ge.cancelUndispatched?ge.cancelUndispatched(V,xn):void 0;if(me&&(me.error!==void 0||me.result!==void 0)){x.delete(H),I.delete(F),me.id=V.id,Mt(me,R.method,Date.now()),e.write(me).catch(()=>i.error("Sending response for canceled message failed."));return}}let he=I.get(F);if(he!==void 0){he.cancel(),Cn(R);return}else O.add(F)}vt(x,R)}finally{Bn()}};function qn(R){if(ut())return;function F(ue,Ce,le){let p={jsonrpc:c,id:R.id};ue instanceof ee.ResponseError?p.error=ue.toJson():p.result=ue===void 0?null:ue,Mt(p,Ce,le),e.write(p).catch(()=>i.error("Sending response failed."))}function H(ue,Ce,le){let p={jsonrpc:c,id:R.id,error:ue.toJson()};Mt(p,Ce,le),e.write(p).catch(()=>i.error("Sending response failed."))}function V(ue,Ce,le){ue===void 0&&(ue=null);let p={jsonrpc:c,id:R.id,result:ue};Mt(p,Ce,le),e.write(p).catch(()=>i.error("Sending response failed."))}On(R);let he=g.get(R.method),ge,me;he&&(ge=he.type,me=he.handler);let qe=Date.now();if(me||l){let ue=R.id??String(Date.now()),Ce=gt.receiver.createCancellationTokenSource(ue);R.id!==null&&O.has(R.id)&&Ce.cancel(),R.id!==null&&I.set(ue,Ce);try{let le;if(me)if(R.params===void 0){if(ge!==void 0&&ge.numberOfParams!==0){H(new ee.ResponseError(ee.ErrorCodes.InvalidParams,`Request ${R.method} defines ${ge.numberOfParams} params but received none.`),R.method,qe);return}le=me(Ce.token)}else if(Array.isArray(R.params)){if(ge!==void 0&&ge.parameterStructures===ee.ParameterStructures.byName){H(new ee.ResponseError(ee.ErrorCodes.InvalidParams,`Request ${R.method} defines parameters by name but received parameters by position`),R.method,qe);return}le=me(...R.params,Ce.token)}else{if(ge!==void 0&&ge.parameterStructures===ee.ParameterStructures.byPosition){H(new ee.ResponseError(ee.ErrorCodes.InvalidParams,`Request ${R.method} defines parameters by position but received parameters by name`),R.method,qe);return}le=me(R.params,Ce.token)}else l&&(le=l(R.method,R.params,Ce.token));let p=le;le?p.then?p.then(E=>{I.delete(ue),F(E,R.method,qe)},E=>{I.delete(ue),E instanceof ee.ResponseError?H(E,R.method,qe):E&&nt.string(E.message)?H(new ee.ResponseError(ee.ErrorCodes.InternalError,`Request ${R.method} failed with message: ${E.message}`),R.method,qe):H(new ee.ResponseError(ee.ErrorCodes.InternalError,`Request ${R.method} failed unexpectedly without providing any details.`),R.method,qe)}):(I.delete(ue),F(le,R.method,qe)):(I.delete(ue),V(le,R.method,qe))}catch(le){I.delete(ue),le instanceof ee.ResponseError?F(le,R.method,qe):le&&nt.string(le.message)?H(new ee.ResponseError(ee.ErrorCodes.InternalError,`Request ${R.method} failed with message: ${le.message}`),R.method,qe):H(new ee.ResponseError(ee.ErrorCodes.InternalError,`Request ${R.method} failed unexpectedly without providing any details.`),R.method,qe)}}else H(new ee.ResponseError(ee.ErrorCodes.MethodNotFound,`Unhandled method ${R.method}`),R.method,qe)}function fr(R){if(!ut())if(R.id===null)R.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(R.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let F=R.id,H=q.get(F);if(jt(R,H),H!==void 0){q.delete(F);try{if(R.error){let V=R.error;H.reject(new ee.ResponseError(V.code,V.message,V.data))}else if(R.result!==void 0)H.resolve(R.result);else throw new Error("Should never happen.")}catch(V){V.message?i.error(`Response handler '${H.method}' failed with message: ${V.message}`):i.error(`Response handler '${H.method}' failed unexpectedly.`)}}}}function Xn(R){if(ut())return;let F,H;if(R.method===Oi.type.method){let V=R.params.id;O.delete(V),Cn(R);return}else{let V=h.get(R.method);V&&(H=V.handler,F=V.type)}if(H||m)try{if(Cn(R),H)if(R.params===void 0)F!==void 0&&F.numberOfParams!==0&&F.parameterStructures!==ee.ParameterStructures.byName&&i.error(`Notification ${R.method} defines ${F.numberOfParams} params but received none.`),H();else if(Array.isArray(R.params)){let V=R.params;R.method===qi.type.method&&V.length===2&&pp.is(V[0])?H({token:V[0],value:V[1]}):(F!==void 0&&(F.parameterStructures===ee.ParameterStructures.byName&&i.error(`Notification ${R.method} defines parameters by name but received parameters by position`),F.numberOfParams!==R.params.length&&i.error(`Notification ${R.method} defines ${F.numberOfParams} params but received ${V.length} arguments`)),H(...V))}else F!==void 0&&F.parameterStructures===ee.ParameterStructures.byPosition&&i.error(`Notification ${R.method} defines parameters by position but received parameters by name`),H(R.params);else m&&m(R.method,R.params)}catch(V){V.message?i.error(`Notification handler '${R.method}' failed with message: ${V.message}`):i.error(`Notification handler '${R.method}' failed unexpectedly.`)}else Ge.fire(R)}function Qn(R){if(!R){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(R,null,4)}`);let F=R;if(nt.string(F.id)||nt.number(F.id)){let H=F.id,V=q.get(H);V&&V.reject(new Error("The received response has neither a result nor an error property."))}}function yt(R){if(R!=null)switch(N){case be.Verbose:return JSON.stringify(R,null,4);case be.Compact:return JSON.stringify(R);default:return}}function Xt(R){if(!(N===be.Off||!K))if($===cn.Text){let F;(N===be.Verbose||N===be.Compact)&&R.params&&(F=`Params: ${yt(R.params)}

`),K.log(`Sending request '${R.method} - (${R.id})'.`,F)}else Ft("send-request",R)}function Jn(R){if(!(N===be.Off||!K))if($===cn.Text){let F;(N===be.Verbose||N===be.Compact)&&(R.params?F=`Params: ${yt(R.params)}

`:F=`No parameters provided.

`),K.log(`Sending notification '${R.method}'.`,F)}else Ft("send-notification",R)}function Mt(R,F,H){if(!(N===be.Off||!K))if($===cn.Text){let V;(N===be.Verbose||N===be.Compact)&&(R.error&&R.error.data?V=`Error data: ${yt(R.error.data)}

`:R.result?V=`Result: ${yt(R.result)}

`:R.error===void 0&&(V=`No result returned.

`)),K.log(`Sending response '${F} - (${R.id})'. Processing request took ${Date.now()-H}ms`,V)}else Ft("send-response",R)}function On(R){if(!(N===be.Off||!K))if($===cn.Text){let F;(N===be.Verbose||N===be.Compact)&&R.params&&(F=`Params: ${yt(R.params)}

`),K.log(`Received request '${R.method} - (${R.id})'.`,F)}else Ft("receive-request",R)}function Cn(R){if(!(N===be.Off||!K||R.method===Wa.type.method))if($===cn.Text){let F;(N===be.Verbose||N===be.Compact)&&(R.params?F=`Params: ${yt(R.params)}

`:F=`No parameters provided.

`),K.log(`Received notification '${R.method}'.`,F)}else Ft("receive-notification",R)}function jt(R,F){if(!(N===be.Off||!K))if($===cn.Text){let H;if((N===be.Verbose||N===be.Compact)&&(R.error&&R.error.data?H=`Error data: ${yt(R.error.data)}

`:R.result?H=`Result: ${yt(R.result)}

`:R.error===void 0&&(H=`No result returned.

`)),F){let V=R.error?` Request failed: ${R.error.message} (${R.error.code}).`:"";K.log(`Received response '${F.method} - (${R.id})' in ${Date.now()-F.timerStart}ms.${V}`,H)}else K.log(`Received response ${R.id} without active response promise.`,H)}else Ft("receive-response",R)}function Ft(R,F){if(!K||N===be.Off)return;let H={isLSPMessage:!0,type:R,message:F,timestamp:Date.now()};K.log(H)}function Qe(){if(tt())throw new er(Eo.Closed,"Connection is closed.");if(ut())throw new er(Eo.Disposed,"Connection is disposed.")}function pr(){if(Le())throw new er(Eo.AlreadyListening,"Connection is already listening")}function Tt(){if(!Le())throw new Error("Call listen() first.")}function $t(R){return R===void 0?null:R}function wn(R){if(R!==null)return R}function In(R){return R!=null&&!Array.isArray(R)&&typeof R=="object"}function Nn(R,F){switch(R){case ee.ParameterStructures.auto:return In(F)?wn(F):[$t(F)];case ee.ParameterStructures.byName:if(!In(F))throw new Error("Received parameters by name but param is not an object literal.");return wn(F);case ee.ParameterStructures.byPosition:return[$t(F)];default:throw new Error(`Unknown parameter structure ${R.toString()}`)}}function Ht(R,F){let H,V=R.numberOfParams;switch(V){case 0:H=void 0;break;case 1:H=Nn(R.parameterStructures,F[0]);break;default:H=[];for(let he=0;he<F.length&&he<V;he++)H.push($t(F[he]));if(F.length<V)for(let he=F.length;he<V;he++)H.push(null);break}return H}let Qt={sendNotification:(R,...F)=>{Qe();let H,V;if(nt.string(R)){H=R;let ge=F[0],me=0,qe=ee.ParameterStructures.auto;ee.ParameterStructures.is(ge)&&(me=1,qe=ge);let ue=F.length,Ce=ue-me;switch(Ce){case 0:V=void 0;break;case 1:V=Nn(qe,F[me]);break;default:if(qe===ee.ParameterStructures.byName)throw new Error(`Received ${Ce} parameters for 'by Name' notification parameter structure.`);V=F.slice(me,ue).map(le=>$t(le));break}}else{let ge=F;H=R.method,V=Ht(R,ge)}let he={jsonrpc:c,method:H,params:V};return Jn(he),e.write(he).catch(()=>i.error("Sending notification failed."))},onNotification:(R,F)=>{Qe();let H;return nt.func(R)?m=R:F&&(nt.string(R)?(H=R,h.set(R,{type:void 0,handler:F})):(H=R.method,h.set(R.method,{type:R,handler:F}))),{dispose:()=>{H!==void 0?h.delete(H):m=void 0}}},onProgress:(R,F,H)=>{if(C.has(F))throw new Error(`Progress handler for token ${F} already registered`);return C.set(F,H),{dispose:()=>{C.delete(F)}}},sendProgress:(R,F,H)=>Qt.sendNotification(qi.type,{token:F,value:H}),onUnhandledProgress:rt.event,sendRequest:(R,...F)=>{Qe(),Tt();let H,V,he;if(nt.string(R)){H=R;let ue=F[0],Ce=F[F.length-1],le=0,p=ee.ParameterStructures.auto;ee.ParameterStructures.is(ue)&&(le=1,p=ue);let E=F.length;ja.CancellationToken.is(Ce)&&(E=E-1,he=Ce);let z=E-le;switch(z){case 0:V=void 0;break;case 1:V=Nn(p,F[le]);break;default:if(p===ee.ParameterStructures.byName)throw new Error(`Received ${z} parameters for 'by Name' request parameter structure.`);V=F.slice(le,E).map(S=>$t(S));break}}else{let ue=F;H=R.method,V=Ht(R,ue);let Ce=R.numberOfParams;he=ja.CancellationToken.is(ue[Ce])?ue[Ce]:void 0}let ge=o++,me;return he&&(me=he.onCancellationRequested(()=>{let ue=gt.sender.sendCancellation(Qt,ge);return ue===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${ge}`),Promise.resolve()):ue.catch(()=>{i.log(`Sending cancellation messages for id ${ge} failed`)})})),new Promise((ue,Ce)=>{let le={jsonrpc:c,id:ge,method:H,params:V},p=S=>{ue(S),gt.sender.cleanup(ge),me==null||me.dispose()},E=S=>{Ce(S),gt.sender.cleanup(ge),me==null||me.dispose()},z={method:H,timerStart:Date.now(),resolve:p,reject:E};Xt(le);try{e.write(le).catch(()=>i.error("Sending request failed."))}catch(S){z.reject(new ee.ResponseError(ee.ErrorCodes.MessageWriteError,S.message?S.message:"Unknown reason")),z=null}z&&q.set(ge,z)})},onRequest:(R,F)=>{Qe();let H=null;return Ha.is(R)?(H=void 0,l=R):nt.string(R)?(H=null,F!==void 0&&(H=R,g.set(R,{handler:F,type:void 0}))):F!==void 0&&(H=R.method,g.set(R.method,{type:R,handler:F})),{dispose:()=>{H!==null&&(H!==void 0?g.delete(H):l=void 0)}}},trace:(R,F,H)=>{let V=!1,he=cn.Text;H!==void 0&&(nt.boolean(H)?V=H:(V=H.sendNotification||!1,he=H.traceFormat||cn.Text)),N=R,$=he,N===be.Off?K=void 0:K=F,V&&!tt()&&!ut()&&Qt.sendNotification(hp.type,{value:be.toString(R)}).catch(()=>{i.error("Sending trace notification failed")})},onError:se.event,onClose:We.event,onUnhandledNotification:Ge.event,onDispose:bt.event,end:()=>{e.end()},dispose:()=>{if(ut())return;de=un.Disposed,bt.fire(void 0);let R=new Error("Connection got disposed.");for(let F of q.values())F.reject(R);q=new Map,I=new Map,O=new Set,x=new fp.LinkedMap,nt.func(e.dispose)&&e.dispose(),nt.func(n.dispose)&&n.dispose()},listen:()=>{Qe(),pr(),de=un.Listening,n.listen(kn)},inspect:()=>{(0,dp.default)().console.log("inspect")}};return Qt.onNotification(Wa.type,R=>{if(N===be.Off||!K)return;let F=N===be.Verbose||N===be.Compact;K.log(R.message,F?R.verbose:void 0)}),Qt.onNotification(qi.type,R=>{let F=C.get(R.token);F?F(R.value):rt.fire(R)}),Qt}Y.createMessageConnection=iw});var Xa=k(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.SetTraceNotification=A.TraceFormat=A.Trace=A.ProgressType=A.ProgressToken=A.createMessageConnection=A.NullLogger=A.ConnectionOptions=A.ConnectionStrategy=A.WriteableStreamMessageWriter=A.AbstractMessageWriter=A.MessageWriter=A.ReadableStreamMessageReader=A.AbstractMessageReader=A.MessageReader=A.CancellationToken=A.CancellationTokenSource=A.Emitter=A.Event=A.Disposable=A.LRUCache=A.Touch=A.LinkedMap=A.ParameterStructures=A.NotificationType9=A.NotificationType8=A.NotificationType7=A.NotificationType6=A.NotificationType5=A.NotificationType4=A.NotificationType3=A.NotificationType2=A.NotificationType1=A.NotificationType0=A.NotificationType=A.ErrorCodes=A.ResponseError=A.RequestType9=A.RequestType8=A.RequestType7=A.RequestType6=A.RequestType5=A.RequestType4=A.RequestType3=A.RequestType2=A.RequestType1=A.RequestType0=A.RequestType=A.Message=A.RAL=void 0;A.CancellationStrategy=A.CancellationSenderStrategy=A.CancellationReceiverStrategy=A.ConnectionError=A.ConnectionErrors=A.LogTraceNotification=void 0;var Ee=Ta();Object.defineProperty(A,"Message",{enumerable:!0,get:function(){return Ee.Message}});Object.defineProperty(A,"RequestType",{enumerable:!0,get:function(){return Ee.RequestType}});Object.defineProperty(A,"RequestType0",{enumerable:!0,get:function(){return Ee.RequestType0}});Object.defineProperty(A,"RequestType1",{enumerable:!0,get:function(){return Ee.RequestType1}});Object.defineProperty(A,"RequestType2",{enumerable:!0,get:function(){return Ee.RequestType2}});Object.defineProperty(A,"RequestType3",{enumerable:!0,get:function(){return Ee.RequestType3}});Object.defineProperty(A,"RequestType4",{enumerable:!0,get:function(){return Ee.RequestType4}});Object.defineProperty(A,"RequestType5",{enumerable:!0,get:function(){return Ee.RequestType5}});Object.defineProperty(A,"RequestType6",{enumerable:!0,get:function(){return Ee.RequestType6}});Object.defineProperty(A,"RequestType7",{enumerable:!0,get:function(){return Ee.RequestType7}});Object.defineProperty(A,"RequestType8",{enumerable:!0,get:function(){return Ee.RequestType8}});Object.defineProperty(A,"RequestType9",{enumerable:!0,get:function(){return Ee.RequestType9}});Object.defineProperty(A,"ResponseError",{enumerable:!0,get:function(){return Ee.ResponseError}});Object.defineProperty(A,"ErrorCodes",{enumerable:!0,get:function(){return Ee.ErrorCodes}});Object.defineProperty(A,"NotificationType",{enumerable:!0,get:function(){return Ee.NotificationType}});Object.defineProperty(A,"NotificationType0",{enumerable:!0,get:function(){return Ee.NotificationType0}});Object.defineProperty(A,"NotificationType1",{enumerable:!0,get:function(){return Ee.NotificationType1}});Object.defineProperty(A,"NotificationType2",{enumerable:!0,get:function(){return Ee.NotificationType2}});Object.defineProperty(A,"NotificationType3",{enumerable:!0,get:function(){return Ee.NotificationType3}});Object.defineProperty(A,"NotificationType4",{enumerable:!0,get:function(){return Ee.NotificationType4}});Object.defineProperty(A,"NotificationType5",{enumerable:!0,get:function(){return Ee.NotificationType5}});Object.defineProperty(A,"NotificationType6",{enumerable:!0,get:function(){return Ee.NotificationType6}});Object.defineProperty(A,"NotificationType7",{enumerable:!0,get:function(){return Ee.NotificationType7}});Object.defineProperty(A,"NotificationType8",{enumerable:!0,get:function(){return Ee.NotificationType8}});Object.defineProperty(A,"NotificationType9",{enumerable:!0,get:function(){return Ee.NotificationType9}});Object.defineProperty(A,"ParameterStructures",{enumerable:!0,get:function(){return Ee.ParameterStructures}});var Va=_a();Object.defineProperty(A,"LinkedMap",{enumerable:!0,get:function(){return Va.LinkedMap}});Object.defineProperty(A,"LRUCache",{enumerable:!0,get:function(){return Va.LRUCache}});Object.defineProperty(A,"Touch",{enumerable:!0,get:function(){return Va.Touch}});var ow=Qs();Object.defineProperty(A,"Disposable",{enumerable:!0,get:function(){return ow.Disposable}});var vp=Xr();Object.defineProperty(A,"Event",{enumerable:!0,get:function(){return vp.Event}});Object.defineProperty(A,"Emitter",{enumerable:!0,get:function(){return vp.Emitter}});var yp=qa();Object.defineProperty(A,"CancellationTokenSource",{enumerable:!0,get:function(){return yp.CancellationTokenSource}});Object.defineProperty(A,"CancellationToken",{enumerable:!0,get:function(){return yp.CancellationToken}});var Ba=op();Object.defineProperty(A,"MessageReader",{enumerable:!0,get:function(){return Ba.MessageReader}});Object.defineProperty(A,"AbstractMessageReader",{enumerable:!0,get:function(){return Ba.AbstractMessageReader}});Object.defineProperty(A,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Ba.ReadableStreamMessageReader}});var Ga=lp();Object.defineProperty(A,"MessageWriter",{enumerable:!0,get:function(){return Ga.MessageWriter}});Object.defineProperty(A,"AbstractMessageWriter",{enumerable:!0,get:function(){return Ga.AbstractMessageWriter}});Object.defineProperty(A,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return Ga.WriteableStreamMessageWriter}});var Et=mp();Object.defineProperty(A,"ConnectionStrategy",{enumerable:!0,get:function(){return Et.ConnectionStrategy}});Object.defineProperty(A,"ConnectionOptions",{enumerable:!0,get:function(){return Et.ConnectionOptions}});Object.defineProperty(A,"NullLogger",{enumerable:!0,get:function(){return Et.NullLogger}});Object.defineProperty(A,"createMessageConnection",{enumerable:!0,get:function(){return Et.createMessageConnection}});Object.defineProperty(A,"ProgressToken",{enumerable:!0,get:function(){return Et.ProgressToken}});Object.defineProperty(A,"ProgressType",{enumerable:!0,get:function(){return Et.ProgressType}});Object.defineProperty(A,"Trace",{enumerable:!0,get:function(){return Et.Trace}});Object.defineProperty(A,"TraceFormat",{enumerable:!0,get:function(){return Et.TraceFormat}});Object.defineProperty(A,"SetTraceNotification",{enumerable:!0,get:function(){return Et.SetTraceNotification}});Object.defineProperty(A,"LogTraceNotification",{enumerable:!0,get:function(){return Et.LogTraceNotification}});Object.defineProperty(A,"ConnectionErrors",{enumerable:!0,get:function(){return Et.ConnectionErrors}});Object.defineProperty(A,"ConnectionError",{enumerable:!0,get:function(){return Et.ConnectionError}});Object.defineProperty(A,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return Et.CancellationReceiverStrategy}});Object.defineProperty(A,"CancellationSenderStrategy",{enumerable:!0,get:function(){return Et.CancellationSenderStrategy}});Object.defineProperty(A,"CancellationStrategy",{enumerable:!0,get:function(){return Et.CancellationStrategy}});var sw=An();A.RAL=sw.default});var Pr=k(we=>{"use strict";var aw=we&&we.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),cw=we&&we.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&aw(e,n,t)};Object.defineProperty(we,"__esModule",{value:!0});we.createMessageConnection=we.createServerSocketTransport=we.createClientSocketTransport=we.createServerPipeTransport=we.createClientPipeTransport=we.generateRandomPipeName=we.StreamMessageWriter=we.StreamMessageReader=we.SocketMessageWriter=we.SocketMessageReader=we.IPCMessageWriter=we.IPCMessageReader=void 0;var Jr=ep();Jr.default.install();var bn=Xa(),Cp=require("path"),uw=require("os"),lw=require("crypto"),qo=require("net");cw(Xa(),we);var Qa=class extends bn.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),bn.Disposable.create(()=>this.process.off("message",e))}};we.IPCMessageReader=Qa;var Ja=class extends bn.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};we.IPCMessageWriter=Ja;var Sr=class extends bn.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,Jr.default)().stream.asReadableStream(e),t)}};we.SocketMessageReader=Sr;var _r=class extends bn.WriteableStreamMessageWriter{constructor(e,t){super((0,Jr.default)().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};we.SocketMessageWriter=_r;var xo=class extends bn.ReadableStreamMessageReader{constructor(e,t){super((0,Jr.default)().stream.asReadableStream(e),t)}};we.StreamMessageReader=xo;var ko=class extends bn.WriteableStreamMessageWriter{constructor(e,t){super((0,Jr.default)().stream.asWritableStream(e),t)}};we.StreamMessageWriter=ko;var wp=process.env.XDG_RUNTIME_DIR,dw=new Map([["linux",107],["darwin",103]]);function fw(){let n=(0,lw.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${n}-sock`;let e;wp?e=Cp.join(wp,`vscode-ipc-${n}.sock`):e=Cp.join(uw.tmpdir(),`vscode-${n}.sock`);let t=dw.get(process.platform);return t!==void 0&&e.length>=t&&(0,Jr.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}we.generateRandomPipeName=fw;function pw(n,e="utf-8"){let t,r=new Promise((i,o)=>{t=i});return new Promise((i,o)=>{let s=(0,qo.createServer)(a=>{s.close(),t([new Sr(a,e),new _r(a,e)])});s.on("error",o),s.listen(n,()=>{s.removeListener("error",o),i({onConnected:()=>r})})})}we.createClientPipeTransport=pw;function hw(n,e="utf-8"){let t=(0,qo.createConnection)(n);return[new Sr(t,e),new _r(t,e)]}we.createServerPipeTransport=hw;function gw(n,e="utf-8"){let t,r=new Promise((i,o)=>{t=i});return new Promise((i,o)=>{let s=(0,qo.createServer)(a=>{s.close(),t([new Sr(a,e),new _r(a,e)])});s.on("error",o),s.listen(n,"127.0.0.1",()=>{s.removeListener("error",o),i({onConnected:()=>r})})})}we.createClientSocketTransport=gw;function mw(n,e="utf-8"){let t=(0,qo.createConnection)(n,"127.0.0.1");return[new Sr(t,e),new _r(t,e)]}we.createServerSocketTransport=mw;function vw(n){let e=n;return e.read!==void 0&&e.addListener!==void 0}function yw(n){let e=n;return e.write!==void 0&&e.addListener!==void 0}function Cw(n,e,t,r){t||(t=bn.NullLogger);let i=vw(n)?new xo(n):n,o=yw(e)?new ko(e):e;return bn.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,bn.createMessageConnection)(i,o,t,r)}we.createMessageConnection=Cw});var Ya=k((Q_,Rp)=>{"use strict";Rp.exports=Pr()});var Za=k((bp,Oo)=>{(function(n){if(typeof Oo=="object"&&typeof Oo.exports=="object"){var e=n(require,bp);e!==void 0&&(Oo.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],n)})(function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(f){function D(T){return typeof T=="string"}f.is=D})(t=e.DocumentUri||(e.DocumentUri={}));var r;(function(f){function D(T){return typeof T=="string"}f.is=D})(r=e.URI||(e.URI={}));var i;(function(f){f.MIN_VALUE=-2147483648,f.MAX_VALUE=2147483647;function D(T){return typeof T=="number"&&f.MIN_VALUE<=T&&T<=f.MAX_VALUE}f.is=D})(i=e.integer||(e.integer={}));var o;(function(f){f.MIN_VALUE=0,f.MAX_VALUE=2147483647;function D(T){return typeof T=="number"&&f.MIN_VALUE<=T&&T<=f.MAX_VALUE}f.is=D})(o=e.uinteger||(e.uinteger={}));var s;(function(f){function D(v,d){return v===Number.MAX_VALUE&&(v=o.MAX_VALUE),d===Number.MAX_VALUE&&(d=o.MAX_VALUE),{line:v,character:d}}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&S.uinteger(d.line)&&S.uinteger(d.character)}f.is=T})(s=e.Position||(e.Position={}));var a;(function(f){function D(v,d,P,L){if(S.uinteger(v)&&S.uinteger(d)&&S.uinteger(P)&&S.uinteger(L))return{start:s.create(v,d),end:s.create(P,L)};if(s.is(v)&&s.is(d))return{start:v,end:d};throw new Error("Range#create called with invalid arguments[".concat(v,", ").concat(d,", ").concat(P,", ").concat(L,"]"))}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&s.is(d.start)&&s.is(d.end)}f.is=T})(a=e.Range||(e.Range={}));var c;(function(f){function D(v,d){return{uri:v,range:d}}f.create=D;function T(v){var d=v;return S.defined(d)&&a.is(d.range)&&(S.string(d.uri)||S.undefined(d.uri))}f.is=T})(c=e.Location||(e.Location={}));var l;(function(f){function D(v,d,P,L){return{targetUri:v,targetRange:d,targetSelectionRange:P,originSelectionRange:L}}f.create=D;function T(v){var d=v;return S.defined(d)&&a.is(d.targetRange)&&S.string(d.targetUri)&&a.is(d.targetSelectionRange)&&(a.is(d.originSelectionRange)||S.undefined(d.originSelectionRange))}f.is=T})(l=e.LocationLink||(e.LocationLink={}));var g;(function(f){function D(v,d,P,L){return{red:v,green:d,blue:P,alpha:L}}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&S.numberRange(d.red,0,1)&&S.numberRange(d.green,0,1)&&S.numberRange(d.blue,0,1)&&S.numberRange(d.alpha,0,1)}f.is=T})(g=e.Color||(e.Color={}));var m;(function(f){function D(v,d){return{range:v,color:d}}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&a.is(d.range)&&g.is(d.color)}f.is=T})(m=e.ColorInformation||(e.ColorInformation={}));var h;(function(f){function D(v,d,P){return{label:v,textEdit:d,additionalTextEdits:P}}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&S.string(d.label)&&(S.undefined(d.textEdit)||K.is(d))&&(S.undefined(d.additionalTextEdits)||S.typedArray(d.additionalTextEdits,K.is))}f.is=T})(h=e.ColorPresentation||(e.ColorPresentation={}));var C;(function(f){f.Comment="comment",f.Imports="imports",f.Region="region"})(C=e.FoldingRangeKind||(e.FoldingRangeKind={}));var b;(function(f){function D(v,d,P,L,te){var Pe={startLine:v,endLine:d};return S.defined(P)&&(Pe.startCharacter=P),S.defined(L)&&(Pe.endCharacter=L),S.defined(te)&&(Pe.kind=te),Pe}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&S.uinteger(d.startLine)&&S.uinteger(d.startLine)&&(S.undefined(d.startCharacter)||S.uinteger(d.startCharacter))&&(S.undefined(d.endCharacter)||S.uinteger(d.endCharacter))&&(S.undefined(d.kind)||S.string(d.kind))}f.is=T})(b=e.FoldingRange||(e.FoldingRange={}));var x;(function(f){function D(v,d){return{location:v,message:d}}f.create=D;function T(v){var d=v;return S.defined(d)&&c.is(d.location)&&S.string(d.message)}f.is=T})(x=e.DiagnosticRelatedInformation||(e.DiagnosticRelatedInformation={}));var q;(function(f){f.Error=1,f.Warning=2,f.Information=3,f.Hint=4})(q=e.DiagnosticSeverity||(e.DiagnosticSeverity={}));var O;(function(f){f.Unnecessary=1,f.Deprecated=2})(O=e.DiagnosticTag||(e.DiagnosticTag={}));var I;(function(f){function D(T){var v=T;return S.objectLiteral(v)&&S.string(v.href)}f.is=D})(I=e.CodeDescription||(e.CodeDescription={}));var N;(function(f){function D(v,d,P,L,te,Pe){var Ae={range:v,message:d};return S.defined(P)&&(Ae.severity=P),S.defined(L)&&(Ae.code=L),S.defined(te)&&(Ae.source=te),S.defined(Pe)&&(Ae.relatedInformation=Pe),Ae}f.create=D;function T(v){var d,P=v;return S.defined(P)&&a.is(P.range)&&S.string(P.message)&&(S.number(P.severity)||S.undefined(P.severity))&&(S.integer(P.code)||S.string(P.code)||S.undefined(P.code))&&(S.undefined(P.codeDescription)||S.string((d=P.codeDescription)===null||d===void 0?void 0:d.href))&&(S.string(P.source)||S.undefined(P.source))&&(S.undefined(P.relatedInformation)||S.typedArray(P.relatedInformation,x.is))}f.is=T})(N=e.Diagnostic||(e.Diagnostic={}));var $;(function(f){function D(v,d){for(var P=[],L=2;L<arguments.length;L++)P[L-2]=arguments[L];var te={title:v,command:d};return S.defined(P)&&P.length>0&&(te.arguments=P),te}f.create=D;function T(v){var d=v;return S.defined(d)&&S.string(d.title)&&S.string(d.command)}f.is=T})($=e.Command||(e.Command={}));var K;(function(f){function D(P,L){return{range:P,newText:L}}f.replace=D;function T(P,L){return{range:{start:P,end:P},newText:L}}f.insert=T;function v(P){return{range:P,newText:""}}f.del=v;function d(P){var L=P;return S.objectLiteral(L)&&S.string(L.newText)&&a.is(L.range)}f.is=d})(K=e.TextEdit||(e.TextEdit={}));var de;(function(f){function D(v,d,P){var L={label:v};return d!==void 0&&(L.needsConfirmation=d),P!==void 0&&(L.description=P),L}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&S.string(d.label)&&(S.boolean(d.needsConfirmation)||d.needsConfirmation===void 0)&&(S.string(d.description)||d.description===void 0)}f.is=T})(de=e.ChangeAnnotation||(e.ChangeAnnotation={}));var se;(function(f){function D(T){var v=T;return S.string(v)}f.is=D})(se=e.ChangeAnnotationIdentifier||(e.ChangeAnnotationIdentifier={}));var We;(function(f){function D(P,L,te){return{range:P,newText:L,annotationId:te}}f.replace=D;function T(P,L,te){return{range:{start:P,end:P},newText:L,annotationId:te}}f.insert=T;function v(P,L){return{range:P,newText:"",annotationId:L}}f.del=v;function d(P){var L=P;return K.is(L)&&(de.is(L.annotationId)||se.is(L.annotationId))}f.is=d})(We=e.AnnotatedTextEdit||(e.AnnotatedTextEdit={}));var Ge;(function(f){function D(v,d){return{textDocument:v,edits:d}}f.create=D;function T(v){var d=v;return S.defined(d)&&tt.is(d.textDocument)&&Array.isArray(d.edits)}f.is=T})(Ge=e.TextDocumentEdit||(e.TextDocumentEdit={}));var rt;(function(f){function D(v,d,P){var L={kind:"create",uri:v};return d!==void 0&&(d.overwrite!==void 0||d.ignoreIfExists!==void 0)&&(L.options=d),P!==void 0&&(L.annotationId=P),L}f.create=D;function T(v){var d=v;return d&&d.kind==="create"&&S.string(d.uri)&&(d.options===void 0||(d.options.overwrite===void 0||S.boolean(d.options.overwrite))&&(d.options.ignoreIfExists===void 0||S.boolean(d.options.ignoreIfExists)))&&(d.annotationId===void 0||se.is(d.annotationId))}f.is=T})(rt=e.CreateFile||(e.CreateFile={}));var bt;(function(f){function D(v,d,P,L){var te={kind:"rename",oldUri:v,newUri:d};return P!==void 0&&(P.overwrite!==void 0||P.ignoreIfExists!==void 0)&&(te.options=P),L!==void 0&&(te.annotationId=L),te}f.create=D;function T(v){var d=v;return d&&d.kind==="rename"&&S.string(d.oldUri)&&S.string(d.newUri)&&(d.options===void 0||(d.options.overwrite===void 0||S.boolean(d.options.overwrite))&&(d.options.ignoreIfExists===void 0||S.boolean(d.options.ignoreIfExists)))&&(d.annotationId===void 0||se.is(d.annotationId))}f.is=T})(bt=e.RenameFile||(e.RenameFile={}));var gt;(function(f){function D(v,d,P){var L={kind:"delete",uri:v};return d!==void 0&&(d.recursive!==void 0||d.ignoreIfNotExists!==void 0)&&(L.options=d),P!==void 0&&(L.annotationId=P),L}f.create=D;function T(v){var d=v;return d&&d.kind==="delete"&&S.string(d.uri)&&(d.options===void 0||(d.options.recursive===void 0||S.boolean(d.options.recursive))&&(d.options.ignoreIfNotExists===void 0||S.boolean(d.options.ignoreIfNotExists)))&&(d.annotationId===void 0||se.is(d.annotationId))}f.is=T})(gt=e.DeleteFile||(e.DeleteFile={}));var mt;(function(f){function D(T){var v=T;return v&&(v.changes!==void 0||v.documentChanges!==void 0)&&(v.documentChanges===void 0||v.documentChanges.every(function(d){return S.string(d.kind)?rt.is(d)||bt.is(d)||gt.is(d):Ge.is(d)}))}f.is=D})(mt=e.WorkspaceEdit||(e.WorkspaceEdit={}));var Dt=function(){function f(D,T){this.edits=D,this.changeAnnotations=T}return f.prototype.insert=function(D,T,v){var d,P;if(v===void 0?d=K.insert(D,T):se.is(v)?(P=v,d=We.insert(D,T,v)):(this.assertChangeAnnotations(this.changeAnnotations),P=this.changeAnnotations.manage(v),d=We.insert(D,T,P)),this.edits.push(d),P!==void 0)return P},f.prototype.replace=function(D,T,v){var d,P;if(v===void 0?d=K.replace(D,T):se.is(v)?(P=v,d=We.replace(D,T,v)):(this.assertChangeAnnotations(this.changeAnnotations),P=this.changeAnnotations.manage(v),d=We.replace(D,T,P)),this.edits.push(d),P!==void 0)return P},f.prototype.delete=function(D,T){var v,d;if(T===void 0?v=K.del(D):se.is(T)?(d=T,v=We.del(D,T)):(this.assertChangeAnnotations(this.changeAnnotations),d=this.changeAnnotations.manage(T),v=We.del(D,d)),this.edits.push(v),d!==void 0)return d},f.prototype.add=function(D){this.edits.push(D)},f.prototype.all=function(){return this.edits},f.prototype.clear=function(){this.edits.splice(0,this.edits.length)},f.prototype.assertChangeAnnotations=function(D){if(D===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},f}(),ct=function(){function f(D){this._annotations=D===void 0?Object.create(null):D,this._counter=0,this._size=0}return f.prototype.all=function(){return this._annotations},Object.defineProperty(f.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),f.prototype.manage=function(D,T){var v;if(se.is(D)?v=D:(v=this.nextId(),T=D),this._annotations[v]!==void 0)throw new Error("Id ".concat(v," is already in use."));if(T===void 0)throw new Error("No annotation provided for id ".concat(v));return this._annotations[v]=T,this._size++,v},f.prototype.nextId=function(){return this._counter++,this._counter.toString()},f}(),vt=function(){function f(D){var T=this;this._textEditChanges=Object.create(null),D!==void 0?(this._workspaceEdit=D,D.documentChanges?(this._changeAnnotations=new ct(D.changeAnnotations),D.changeAnnotations=this._changeAnnotations.all(),D.documentChanges.forEach(function(v){if(Ge.is(v)){var d=new Dt(v.edits,T._changeAnnotations);T._textEditChanges[v.textDocument.uri]=d}})):D.changes&&Object.keys(D.changes).forEach(function(v){var d=new Dt(D.changes[v]);T._textEditChanges[v]=d})):this._workspaceEdit={}}return Object.defineProperty(f.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),f.prototype.getTextEditChange=function(D){if(tt.is(D)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T={uri:D.uri,version:D.version},v=this._textEditChanges[T.uri];if(!v){var d=[],P={textDocument:T,edits:d};this._workspaceEdit.documentChanges.push(P),v=new Dt(d,this._changeAnnotations),this._textEditChanges[T.uri]=v}return v}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var v=this._textEditChanges[D];if(!v){var d=[];this._workspaceEdit.changes[D]=d,v=new Dt(d),this._textEditChanges[D]=v}return v}},f.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new ct,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},f.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},f.prototype.createFile=function(D,T,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var d;de.is(T)||se.is(T)?d=T:v=T;var P,L;if(d===void 0?P=rt.create(D,v):(L=se.is(d)?d:this._changeAnnotations.manage(d),P=rt.create(D,v,L)),this._workspaceEdit.documentChanges.push(P),L!==void 0)return L},f.prototype.renameFile=function(D,T,v,d){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var P;de.is(v)||se.is(v)?P=v:d=v;var L,te;if(P===void 0?L=bt.create(D,T,d):(te=se.is(P)?P:this._changeAnnotations.manage(P),L=bt.create(D,T,d,te)),this._workspaceEdit.documentChanges.push(L),te!==void 0)return te},f.prototype.deleteFile=function(D,T,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var d;de.is(T)||se.is(T)?d=T:v=T;var P,L;if(d===void 0?P=gt.create(D,v):(L=se.is(d)?d:this._changeAnnotations.manage(d),P=gt.create(D,v,L)),this._workspaceEdit.documentChanges.push(P),L!==void 0)return L},f}();e.WorkspaceChange=vt;var xn;(function(f){function D(v){return{uri:v}}f.create=D;function T(v){var d=v;return S.defined(d)&&S.string(d.uri)}f.is=T})(xn=e.TextDocumentIdentifier||(e.TextDocumentIdentifier={}));var Le;(function(f){function D(v,d){return{uri:v,version:d}}f.create=D;function T(v){var d=v;return S.defined(d)&&S.string(d.uri)&&S.integer(d.version)}f.is=T})(Le=e.VersionedTextDocumentIdentifier||(e.VersionedTextDocumentIdentifier={}));var tt;(function(f){function D(v,d){return{uri:v,version:d}}f.create=D;function T(v){var d=v;return S.defined(d)&&S.string(d.uri)&&(d.version===null||S.integer(d.version))}f.is=T})(tt=e.OptionalVersionedTextDocumentIdentifier||(e.OptionalVersionedTextDocumentIdentifier={}));var ut;(function(f){function D(v,d,P,L){return{uri:v,languageId:d,version:P,text:L}}f.create=D;function T(v){var d=v;return S.defined(d)&&S.string(d.uri)&&S.string(d.languageId)&&S.integer(d.version)&&S.string(d.text)}f.is=T})(ut=e.TextDocumentItem||(e.TextDocumentItem={}));var Nt;(function(f){f.PlainText="plaintext",f.Markdown="markdown"})(Nt=e.MarkupKind||(e.MarkupKind={})),function(f){function D(T){var v=T;return v===f.PlainText||v===f.Markdown}f.is=D}(Nt=e.MarkupKind||(e.MarkupKind={}));var Xe;(function(f){function D(T){var v=T;return S.objectLiteral(T)&&Nt.is(v.kind)&&S.string(v.value)}f.is=D})(Xe=e.MarkupContent||(e.MarkupContent={}));var dr;(function(f){f.Text=1,f.Method=2,f.Function=3,f.Constructor=4,f.Field=5,f.Variable=6,f.Class=7,f.Interface=8,f.Module=9,f.Property=10,f.Unit=11,f.Value=12,f.Enum=13,f.Keyword=14,f.Snippet=15,f.Color=16,f.File=17,f.Reference=18,f.Folder=19,f.EnumMember=20,f.Constant=21,f.Struct=22,f.Event=23,f.Operator=24,f.TypeParameter=25})(dr=e.CompletionItemKind||(e.CompletionItemKind={}));var Bn;(function(f){f.PlainText=1,f.Snippet=2})(Bn=e.InsertTextFormat||(e.InsertTextFormat={}));var Gn;(function(f){f.Deprecated=1})(Gn=e.CompletionItemTag||(e.CompletionItemTag={}));var kn;(function(f){function D(v,d,P){return{newText:v,insert:d,replace:P}}f.create=D;function T(v){var d=v;return d&&S.string(d.newText)&&a.is(d.insert)&&a.is(d.replace)}f.is=T})(kn=e.InsertReplaceEdit||(e.InsertReplaceEdit={}));var qn;(function(f){f.asIs=1,f.adjustIndentation=2})(qn=e.InsertTextMode||(e.InsertTextMode={}));var fr;(function(f){function D(T){var v=T;return v&&(S.string(v.detail)||v.detail===void 0)&&(S.string(v.description)||v.description===void 0)}f.is=D})(fr=e.CompletionItemLabelDetails||(e.CompletionItemLabelDetails={}));var Xn;(function(f){function D(T){return{label:T}}f.create=D})(Xn=e.CompletionItem||(e.CompletionItem={}));var Qn;(function(f){function D(T,v){return{items:T||[],isIncomplete:!!v}}f.create=D})(Qn=e.CompletionList||(e.CompletionList={}));var yt;(function(f){function D(v){return v.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}f.fromPlainText=D;function T(v){var d=v;return S.string(d)||S.objectLiteral(d)&&S.string(d.language)&&S.string(d.value)}f.is=T})(yt=e.MarkedString||(e.MarkedString={}));var Xt;(function(f){function D(T){var v=T;return!!v&&S.objectLiteral(v)&&(Xe.is(v.contents)||yt.is(v.contents)||S.typedArray(v.contents,yt.is))&&(T.range===void 0||a.is(T.range))}f.is=D})(Xt=e.Hover||(e.Hover={}));var Jn;(function(f){function D(T,v){return v?{label:T,documentation:v}:{label:T}}f.create=D})(Jn=e.ParameterInformation||(e.ParameterInformation={}));var Mt;(function(f){function D(T,v){for(var d=[],P=2;P<arguments.length;P++)d[P-2]=arguments[P];var L={label:T};return S.defined(v)&&(L.documentation=v),S.defined(d)?L.parameters=d:L.parameters=[],L}f.create=D})(Mt=e.SignatureInformation||(e.SignatureInformation={}));var On;(function(f){f.Text=1,f.Read=2,f.Write=3})(On=e.DocumentHighlightKind||(e.DocumentHighlightKind={}));var Cn;(function(f){function D(T,v){var d={range:T};return S.number(v)&&(d.kind=v),d}f.create=D})(Cn=e.DocumentHighlight||(e.DocumentHighlight={}));var jt;(function(f){f.File=1,f.Module=2,f.Namespace=3,f.Package=4,f.Class=5,f.Method=6,f.Property=7,f.Field=8,f.Constructor=9,f.Enum=10,f.Interface=11,f.Function=12,f.Variable=13,f.Constant=14,f.String=15,f.Number=16,f.Boolean=17,f.Array=18,f.Object=19,f.Key=20,f.Null=21,f.EnumMember=22,f.Struct=23,f.Event=24,f.Operator=25,f.TypeParameter=26})(jt=e.SymbolKind||(e.SymbolKind={}));var Ft;(function(f){f.Deprecated=1})(Ft=e.SymbolTag||(e.SymbolTag={}));var Qe;(function(f){function D(T,v,d,P,L){var te={name:T,kind:v,location:{uri:P,range:d}};return L&&(te.containerName=L),te}f.create=D})(Qe=e.SymbolInformation||(e.SymbolInformation={}));var pr;(function(f){function D(T,v,d,P){return P!==void 0?{name:T,kind:v,location:{uri:d,range:P}}:{name:T,kind:v,location:{uri:d}}}f.create=D})(pr=e.WorkspaceSymbol||(e.WorkspaceSymbol={}));var Tt;(function(f){function D(v,d,P,L,te,Pe){var Ae={name:v,detail:d,kind:P,range:L,selectionRange:te};return Pe!==void 0&&(Ae.children=Pe),Ae}f.create=D;function T(v){var d=v;return d&&S.string(d.name)&&S.number(d.kind)&&a.is(d.range)&&a.is(d.selectionRange)&&(d.detail===void 0||S.string(d.detail))&&(d.deprecated===void 0||S.boolean(d.deprecated))&&(d.children===void 0||Array.isArray(d.children))&&(d.tags===void 0||Array.isArray(d.tags))}f.is=T})(Tt=e.DocumentSymbol||(e.DocumentSymbol={}));var $t;(function(f){f.Empty="",f.QuickFix="quickfix",f.Refactor="refactor",f.RefactorExtract="refactor.extract",f.RefactorInline="refactor.inline",f.RefactorRewrite="refactor.rewrite",f.Source="source",f.SourceOrganizeImports="source.organizeImports",f.SourceFixAll="source.fixAll"})($t=e.CodeActionKind||(e.CodeActionKind={}));var wn;(function(f){f.Invoked=1,f.Automatic=2})(wn=e.CodeActionTriggerKind||(e.CodeActionTriggerKind={}));var In;(function(f){function D(v,d,P){var L={diagnostics:v};return d!=null&&(L.only=d),P!=null&&(L.triggerKind=P),L}f.create=D;function T(v){var d=v;return S.defined(d)&&S.typedArray(d.diagnostics,N.is)&&(d.only===void 0||S.typedArray(d.only,S.string))&&(d.triggerKind===void 0||d.triggerKind===wn.Invoked||d.triggerKind===wn.Automatic)}f.is=T})(In=e.CodeActionContext||(e.CodeActionContext={}));var Nn;(function(f){function D(v,d,P){var L={title:v},te=!0;return typeof d=="string"?(te=!1,L.kind=d):$.is(d)?L.command=d:L.edit=d,te&&P!==void 0&&(L.kind=P),L}f.create=D;function T(v){var d=v;return d&&S.string(d.title)&&(d.diagnostics===void 0||S.typedArray(d.diagnostics,N.is))&&(d.kind===void 0||S.string(d.kind))&&(d.edit!==void 0||d.command!==void 0)&&(d.command===void 0||$.is(d.command))&&(d.isPreferred===void 0||S.boolean(d.isPreferred))&&(d.edit===void 0||mt.is(d.edit))}f.is=T})(Nn=e.CodeAction||(e.CodeAction={}));var Ht;(function(f){function D(v,d){var P={range:v};return S.defined(d)&&(P.data=d),P}f.create=D;function T(v){var d=v;return S.defined(d)&&a.is(d.range)&&(S.undefined(d.command)||$.is(d.command))}f.is=T})(Ht=e.CodeLens||(e.CodeLens={}));var Qt;(function(f){function D(v,d){return{tabSize:v,insertSpaces:d}}f.create=D;function T(v){var d=v;return S.defined(d)&&S.uinteger(d.tabSize)&&S.boolean(d.insertSpaces)}f.is=T})(Qt=e.FormattingOptions||(e.FormattingOptions={}));var R;(function(f){function D(v,d,P){return{range:v,target:d,data:P}}f.create=D;function T(v){var d=v;return S.defined(d)&&a.is(d.range)&&(S.undefined(d.target)||S.string(d.target))}f.is=T})(R=e.DocumentLink||(e.DocumentLink={}));var F;(function(f){function D(v,d){return{range:v,parent:d}}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&a.is(d.range)&&(d.parent===void 0||f.is(d.parent))}f.is=T})(F=e.SelectionRange||(e.SelectionRange={}));var H;(function(f){f.namespace="namespace",f.type="type",f.class="class",f.enum="enum",f.interface="interface",f.struct="struct",f.typeParameter="typeParameter",f.parameter="parameter",f.variable="variable",f.property="property",f.enumMember="enumMember",f.event="event",f.function="function",f.method="method",f.macro="macro",f.keyword="keyword",f.modifier="modifier",f.comment="comment",f.string="string",f.number="number",f.regexp="regexp",f.operator="operator",f.decorator="decorator"})(H=e.SemanticTokenTypes||(e.SemanticTokenTypes={}));var V;(function(f){f.declaration="declaration",f.definition="definition",f.readonly="readonly",f.static="static",f.deprecated="deprecated",f.abstract="abstract",f.async="async",f.modification="modification",f.documentation="documentation",f.defaultLibrary="defaultLibrary"})(V=e.SemanticTokenModifiers||(e.SemanticTokenModifiers={}));var he;(function(f){function D(T){var v=T;return S.objectLiteral(v)&&(v.resultId===void 0||typeof v.resultId=="string")&&Array.isArray(v.data)&&(v.data.length===0||typeof v.data[0]=="number")}f.is=D})(he=e.SemanticTokens||(e.SemanticTokens={}));var ge;(function(f){function D(v,d){return{range:v,text:d}}f.create=D;function T(v){var d=v;return d!=null&&a.is(d.range)&&S.string(d.text)}f.is=T})(ge=e.InlineValueText||(e.InlineValueText={}));var me;(function(f){function D(v,d,P){return{range:v,variableName:d,caseSensitiveLookup:P}}f.create=D;function T(v){var d=v;return d!=null&&a.is(d.range)&&S.boolean(d.caseSensitiveLookup)&&(S.string(d.variableName)||d.variableName===void 0)}f.is=T})(me=e.InlineValueVariableLookup||(e.InlineValueVariableLookup={}));var qe;(function(f){function D(v,d){return{range:v,expression:d}}f.create=D;function T(v){var d=v;return d!=null&&a.is(d.range)&&(S.string(d.expression)||d.expression===void 0)}f.is=T})(qe=e.InlineValueEvaluatableExpression||(e.InlineValueEvaluatableExpression={}));var ue;(function(f){function D(v,d){return{frameId:v,stoppedLocation:d}}f.create=D;function T(v){var d=v;return S.defined(d)&&a.is(v.stoppedLocation)}f.is=T})(ue=e.InlineValueContext||(e.InlineValueContext={}));var Ce;(function(f){f.Type=1,f.Parameter=2;function D(T){return T===1||T===2}f.is=D})(Ce=e.InlayHintKind||(e.InlayHintKind={}));var le;(function(f){function D(v){return{value:v}}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&(d.tooltip===void 0||S.string(d.tooltip)||Xe.is(d.tooltip))&&(d.location===void 0||c.is(d.location))&&(d.command===void 0||$.is(d.command))}f.is=T})(le=e.InlayHintLabelPart||(e.InlayHintLabelPart={}));var p;(function(f){function D(v,d,P){var L={position:v,label:d};return P!==void 0&&(L.kind=P),L}f.create=D;function T(v){var d=v;return S.objectLiteral(d)&&s.is(d.position)&&(S.string(d.label)||S.typedArray(d.label,le.is))&&(d.kind===void 0||Ce.is(d.kind))&&d.textEdits===void 0||S.typedArray(d.textEdits,K.is)&&(d.tooltip===void 0||S.string(d.tooltip)||Xe.is(d.tooltip))&&(d.paddingLeft===void 0||S.boolean(d.paddingLeft))&&(d.paddingRight===void 0||S.boolean(d.paddingRight))}f.is=T})(p=e.InlayHint||(e.InlayHint={})),e.EOL=[`
`,`\r
`,"\r"];var E;(function(f){function D(P,L,te,Pe){return new z(P,L,te,Pe)}f.create=D;function T(P){var L=P;return!!(S.defined(L)&&S.string(L.uri)&&(S.undefined(L.languageId)||S.string(L.languageId))&&S.uinteger(L.lineCount)&&S.func(L.getText)&&S.func(L.positionAt)&&S.func(L.offsetAt))}f.is=T;function v(P,L){for(var te=P.getText(),Pe=d(L,function(Yn,$r){var so=Yn.range.start.line-$r.range.start.line;return so===0?Yn.range.start.character-$r.range.start.character:so}),Ae=te.length,Wt=Pe.length-1;Wt>=0;Wt--){var zt=Pe[Wt],Jt=P.offsetAt(zt.range.start),fe=P.offsetAt(zt.range.end);if(fe<=Ae)te=te.substring(0,Jt)+zt.newText+te.substring(fe,te.length);else throw new Error("Overlapping edit");Ae=Jt}return te}f.applyEdits=v;function d(P,L){if(P.length<=1)return P;var te=P.length/2|0,Pe=P.slice(0,te),Ae=P.slice(te);d(Pe,L),d(Ae,L);for(var Wt=0,zt=0,Jt=0;Wt<Pe.length&&zt<Ae.length;){var fe=L(Pe[Wt],Ae[zt]);fe<=0?P[Jt++]=Pe[Wt++]:P[Jt++]=Ae[zt++]}for(;Wt<Pe.length;)P[Jt++]=Pe[Wt++];for(;zt<Ae.length;)P[Jt++]=Ae[zt++];return P}})(E=e.TextDocument||(e.TextDocument={}));var z=function(){function f(D,T,v,d){this._uri=D,this._languageId=T,this._version=v,this._content=d,this._lineOffsets=void 0}return Object.defineProperty(f.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),f.prototype.getText=function(D){if(D){var T=this.offsetAt(D.start),v=this.offsetAt(D.end);return this._content.substring(T,v)}return this._content},f.prototype.update=function(D,T){this._content=D.text,this._version=T,this._lineOffsets=void 0},f.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var D=[],T=this._content,v=!0,d=0;d<T.length;d++){v&&(D.push(d),v=!1);var P=T.charAt(d);v=P==="\r"||P===`
`,P==="\r"&&d+1<T.length&&T.charAt(d+1)===`
`&&d++}v&&T.length>0&&D.push(T.length),this._lineOffsets=D}return this._lineOffsets},f.prototype.positionAt=function(D){D=Math.max(Math.min(D,this._content.length),0);var T=this.getLineOffsets(),v=0,d=T.length;if(d===0)return s.create(0,D);for(;v<d;){var P=Math.floor((v+d)/2);T[P]>D?d=P:v=P+1}var L=v-1;return s.create(L,D-T[L])},f.prototype.offsetAt=function(D){var T=this.getLineOffsets();if(D.line>=T.length)return this._content.length;if(D.line<0)return 0;var v=T[D.line],d=D.line+1<T.length?T[D.line+1]:this._content.length;return Math.max(Math.min(v+D.character,d),v)},Object.defineProperty(f.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),f}(),S;(function(f){var D=Object.prototype.toString;function T(fe){return typeof fe<"u"}f.defined=T;function v(fe){return typeof fe>"u"}f.undefined=v;function d(fe){return fe===!0||fe===!1}f.boolean=d;function P(fe){return D.call(fe)==="[object String]"}f.string=P;function L(fe){return D.call(fe)==="[object Number]"}f.number=L;function te(fe,Yn,$r){return D.call(fe)==="[object Number]"&&Yn<=fe&&fe<=$r}f.numberRange=te;function Pe(fe){return D.call(fe)==="[object Number]"&&-2147483648<=fe&&fe<=2147483647}f.integer=Pe;function Ae(fe){return D.call(fe)==="[object Number]"&&0<=fe&&fe<=2147483647}f.uinteger=Ae;function Wt(fe){return D.call(fe)==="[object Function]"}f.func=Wt;function zt(fe){return fe!==null&&typeof fe=="object"}f.objectLiteral=zt;function Jt(fe,Yn){return Array.isArray(fe)&&fe.every(Yn)}f.typedArray=Jt})(S||(S={}))})});var je=k(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.ProtocolNotificationType=en.ProtocolNotificationType0=en.ProtocolRequestType=en.ProtocolRequestType0=en.RegistrationType=void 0;var Yr=Pr(),ec=class{constructor(e){this.method=e}};en.RegistrationType=ec;var tc=class extends Yr.RequestType0{constructor(e){super(e)}};en.ProtocolRequestType0=tc;var nc=class extends Yr.RequestType{constructor(e){super(e,Yr.ParameterStructures.byName)}};en.ProtocolRequestType=nc;var rc=class extends Yr.NotificationType0{constructor(e){super(e)}};en.ProtocolNotificationType0=rc;var ic=class extends Yr.NotificationType{constructor(e){super(e,Yr.ParameterStructures.byName)}};en.ProtocolNotificationType=ic});var Io=k(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.objectLiteral=Je.typedArray=Je.stringArray=Je.array=Je.func=Je.error=Je.number=Je.string=Je.boolean=void 0;function ww(n){return n===!0||n===!1}Je.boolean=ww;function Dp(n){return typeof n=="string"||n instanceof String}Je.string=Dp;function Rw(n){return typeof n=="number"||n instanceof Number}Je.number=Rw;function bw(n){return n instanceof Error}Je.error=bw;function Dw(n){return typeof n=="function"}Je.func=Dw;function Tp(n){return Array.isArray(n)}Je.array=Tp;function Tw(n){return Tp(n)&&n.every(e=>Dp(e))}Je.stringArray=Tw;function Sw(n,e){return Array.isArray(n)&&n.every(e)}Je.typedArray=Sw;function _w(n){return n!==null&&typeof n=="object"}Je.objectLiteral=_w});var Sp=k(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0});Ii.ImplementationRequest=void 0;var Pw=je(),Ew;(function(n){n.method="textDocument/implementation",n.type=new Pw.ProtocolRequestType(n.method)})(Ew=Ii.ImplementationRequest||(Ii.ImplementationRequest={}))});var _p=k(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.TypeDefinitionRequest=void 0;var xw=je(),kw;(function(n){n.method="textDocument/typeDefinition",n.type=new xw.ProtocolRequestType(n.method)})(kw=Ni.TypeDefinitionRequest||(Ni.TypeDefinitionRequest={}))});var Ep=k(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.DidChangeWorkspaceFoldersNotification=tr.WorkspaceFoldersRequest=void 0;var Pp=je(),qw;(function(n){n.type=new Pp.ProtocolRequestType0("workspace/workspaceFolders")})(qw=tr.WorkspaceFoldersRequest||(tr.WorkspaceFoldersRequest={}));var Ow;(function(n){n.type=new Pp.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")})(Ow=tr.DidChangeWorkspaceFoldersNotification||(tr.DidChangeWorkspaceFoldersNotification={}))});var xp=k(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});Fi.ConfigurationRequest=void 0;var Iw=je(),Nw;(function(n){n.type=new Iw.ProtocolRequestType("workspace/configuration")})(Nw=Fi.ConfigurationRequest||(Fi.ConfigurationRequest={}))});var qp=k(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.ColorPresentationRequest=nr.DocumentColorRequest=void 0;var kp=je(),Fw;(function(n){n.method="textDocument/documentColor",n.type=new kp.ProtocolRequestType(n.method)})(Fw=nr.DocumentColorRequest||(nr.DocumentColorRequest={}));var Lw;(function(n){n.type=new kp.ProtocolRequestType("textDocument/colorPresentation")})(Lw=nr.ColorPresentationRequest||(nr.ColorPresentationRequest={}))});var Op=k(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.FoldingRangeRequest=rr.FoldingRangeKind=void 0;var Aw=je(),Mw;(function(n){n.Comment="comment",n.Imports="imports",n.Region="region"})(Mw=rr.FoldingRangeKind||(rr.FoldingRangeKind={}));var jw;(function(n){n.method="textDocument/foldingRange",n.type=new Aw.ProtocolRequestType(n.method)})(jw=rr.FoldingRangeRequest||(rr.FoldingRangeRequest={}))});var Ip=k(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0});Li.DeclarationRequest=void 0;var $w=je(),Hw;(function(n){n.method="textDocument/declaration",n.type=new $w.ProtocolRequestType(n.method)})(Hw=Li.DeclarationRequest||(Li.DeclarationRequest={}))});var Np=k(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.SelectionRangeRequest=void 0;var Ww=je(),zw;(function(n){n.method="textDocument/selectionRange",n.type=new Ww.ProtocolRequestType(n.method)})(zw=Ai.SelectionRangeRequest||(Ai.SelectionRangeRequest={}))});var Lp=k(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.WorkDoneProgressCancelNotification=ln.WorkDoneProgressCreateRequest=ln.WorkDoneProgress=void 0;var Uw=Pr(),Fp=je(),Kw;(function(n){n.type=new Uw.ProgressType;function e(t){return t===n.type}n.is=e})(Kw=ln.WorkDoneProgress||(ln.WorkDoneProgress={}));var Vw;(function(n){n.type=new Fp.ProtocolRequestType("window/workDoneProgress/create")})(Vw=ln.WorkDoneProgressCreateRequest||(ln.WorkDoneProgressCreateRequest={}));var Bw;(function(n){n.type=new Fp.ProtocolNotificationType("window/workDoneProgress/cancel")})(Bw=ln.WorkDoneProgressCancelNotification||(ln.WorkDoneProgressCancelNotification={}))});var Ap=k(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.CallHierarchyOutgoingCallsRequest=dn.CallHierarchyIncomingCallsRequest=dn.CallHierarchyPrepareRequest=void 0;var oc=je(),Gw;(function(n){n.method="textDocument/prepareCallHierarchy",n.type=new oc.ProtocolRequestType(n.method)})(Gw=dn.CallHierarchyPrepareRequest||(dn.CallHierarchyPrepareRequest={}));var Xw;(function(n){n.method="callHierarchy/incomingCalls",n.type=new oc.ProtocolRequestType(n.method)})(Xw=dn.CallHierarchyIncomingCallsRequest||(dn.CallHierarchyIncomingCallsRequest={}));var Qw;(function(n){n.method="callHierarchy/outgoingCalls",n.type=new oc.ProtocolRequestType(n.method)})(Qw=dn.CallHierarchyOutgoingCallsRequest||(dn.CallHierarchyOutgoingCallsRequest={}))});var Mp=k(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.SemanticTokensRefreshRequest=Ye.SemanticTokensRangeRequest=Ye.SemanticTokensDeltaRequest=Ye.SemanticTokensRequest=Ye.SemanticTokensRegistrationType=Ye.TokenFormat=void 0;var Mi=je(),Jw;(function(n){n.Relative="relative"})(Jw=Ye.TokenFormat||(Ye.TokenFormat={}));var Yw;(function(n){n.method="textDocument/semanticTokens",n.type=new Mi.RegistrationType(n.method)})(Yw=Ye.SemanticTokensRegistrationType||(Ye.SemanticTokensRegistrationType={}));var Zw;(function(n){n.method="textDocument/semanticTokens/full",n.type=new Mi.ProtocolRequestType(n.method)})(Zw=Ye.SemanticTokensRequest||(Ye.SemanticTokensRequest={}));var eR;(function(n){n.method="textDocument/semanticTokens/full/delta",n.type=new Mi.ProtocolRequestType(n.method)})(eR=Ye.SemanticTokensDeltaRequest||(Ye.SemanticTokensDeltaRequest={}));var tR;(function(n){n.method="textDocument/semanticTokens/range",n.type=new Mi.ProtocolRequestType(n.method)})(tR=Ye.SemanticTokensRangeRequest||(Ye.SemanticTokensRangeRequest={}));var nR;(function(n){n.method="workspace/semanticTokens/refresh",n.type=new Mi.ProtocolRequestType0(n.method)})(nR=Ye.SemanticTokensRefreshRequest||(Ye.SemanticTokensRefreshRequest={}))});var jp=k(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});ji.ShowDocumentRequest=void 0;var rR=je(),iR;(function(n){n.method="window/showDocument",n.type=new rR.ProtocolRequestType(n.method)})(iR=ji.ShowDocumentRequest||(ji.ShowDocumentRequest={}))});var $p=k($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});$i.LinkedEditingRangeRequest=void 0;var oR=je(),sR;(function(n){n.method="textDocument/linkedEditingRange",n.type=new oR.ProtocolRequestType(n.method)})(sR=$i.LinkedEditingRangeRequest||($i.LinkedEditingRangeRequest={}))});var Hp=k($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});$e.WillDeleteFilesRequest=$e.DidDeleteFilesNotification=$e.DidRenameFilesNotification=$e.WillRenameFilesRequest=$e.DidCreateFilesNotification=$e.WillCreateFilesRequest=$e.FileOperationPatternKind=void 0;var Zr=je(),aR;(function(n){n.file="file",n.folder="folder"})(aR=$e.FileOperationPatternKind||($e.FileOperationPatternKind={}));var cR;(function(n){n.method="workspace/willCreateFiles",n.type=new Zr.ProtocolRequestType(n.method)})(cR=$e.WillCreateFilesRequest||($e.WillCreateFilesRequest={}));var uR;(function(n){n.method="workspace/didCreateFiles",n.type=new Zr.ProtocolNotificationType(n.method)})(uR=$e.DidCreateFilesNotification||($e.DidCreateFilesNotification={}));var lR;(function(n){n.method="workspace/willRenameFiles",n.type=new Zr.ProtocolRequestType(n.method)})(lR=$e.WillRenameFilesRequest||($e.WillRenameFilesRequest={}));var dR;(function(n){n.method="workspace/didRenameFiles",n.type=new Zr.ProtocolNotificationType(n.method)})(dR=$e.DidRenameFilesNotification||($e.DidRenameFilesNotification={}));var fR;(function(n){n.method="workspace/didDeleteFiles",n.type=new Zr.ProtocolNotificationType(n.method)})(fR=$e.DidDeleteFilesNotification||($e.DidDeleteFilesNotification={}));var pR;(function(n){n.method="workspace/willDeleteFiles",n.type=new Zr.ProtocolRequestType(n.method)})(pR=$e.WillDeleteFilesRequest||($e.WillDeleteFilesRequest={}))});var Wp=k(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:!0});fn.MonikerRequest=fn.MonikerKind=fn.UniquenessLevel=void 0;var hR=je(),gR;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(gR=fn.UniquenessLevel||(fn.UniquenessLevel={}));var mR;(function(n){n.import="import",n.export="export",n.local="local"})(mR=fn.MonikerKind||(fn.MonikerKind={}));var vR;(function(n){n.method="textDocument/moniker",n.type=new hR.ProtocolRequestType(n.method)})(vR=fn.MonikerRequest||(fn.MonikerRequest={}))});var zp=k(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.TypeHierarchySubtypesRequest=pn.TypeHierarchySupertypesRequest=pn.TypeHierarchyPrepareRequest=void 0;var sc=je(),yR;(function(n){n.method="textDocument/prepareTypeHierarchy",n.type=new sc.ProtocolRequestType(n.method)})(yR=pn.TypeHierarchyPrepareRequest||(pn.TypeHierarchyPrepareRequest={}));var CR;(function(n){n.method="typeHierarchy/supertypes",n.type=new sc.ProtocolRequestType(n.method)})(CR=pn.TypeHierarchySupertypesRequest||(pn.TypeHierarchySupertypesRequest={}));var wR;(function(n){n.method="typeHierarchy/subtypes",n.type=new sc.ProtocolRequestType(n.method)})(wR=pn.TypeHierarchySubtypesRequest||(pn.TypeHierarchySubtypesRequest={}))});var Kp=k(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.InlineValueRefreshRequest=ir.InlineValueRequest=void 0;var Up=je(),RR;(function(n){n.method="textDocument/inlineValue",n.type=new Up.ProtocolRequestType(n.method)})(RR=ir.InlineValueRequest||(ir.InlineValueRequest={}));var bR;(function(n){n.method="workspace/inlineValue/refresh",n.type=new Up.ProtocolRequestType0(n.method)})(bR=ir.InlineValueRefreshRequest||(ir.InlineValueRefreshRequest={}))});var Vp=k(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.InlayHintRefreshRequest=hn.InlayHintResolveRequest=hn.InlayHintRequest=void 0;var ac=je(),DR;(function(n){n.method="textDocument/inlayHint",n.type=new ac.ProtocolRequestType(n.method)})(DR=hn.InlayHintRequest||(hn.InlayHintRequest={}));var TR;(function(n){n.method="inlayHint/resolve",n.type=new ac.ProtocolRequestType(n.method)})(TR=hn.InlayHintResolveRequest||(hn.InlayHintResolveRequest={}));var SR;(function(n){n.method="workspace/inlayHint/refresh",n.type=new ac.ProtocolRequestType0(n.method)})(SR=hn.InlayHintRefreshRequest||(hn.InlayHintRefreshRequest={}))});var eh=k(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.CodeLensRequest=y.WorkspaceSymbolResolveRequest=y.WorkspaceSymbolRequest=y.CodeActionResolveRequest=y.CodeActionRequest=y.DocumentSymbolRequest=y.DocumentHighlightRequest=y.ReferencesRequest=y.DefinitionRequest=y.SignatureHelpRequest=y.SignatureHelpTriggerKind=y.HoverRequest=y.CompletionResolveRequest=y.CompletionRequest=y.CompletionTriggerKind=y.PublishDiagnosticsNotification=y.WatchKind=y.FileChangeType=y.DidChangeWatchedFilesNotification=y.WillSaveTextDocumentWaitUntilRequest=y.WillSaveTextDocumentNotification=y.TextDocumentSaveReason=y.DidSaveTextDocumentNotification=y.DidCloseTextDocumentNotification=y.DidChangeTextDocumentNotification=y.TextDocumentContentChangeEvent=y.DidOpenTextDocumentNotification=y.TextDocumentSyncKind=y.TelemetryEventNotification=y.LogMessageNotification=y.ShowMessageRequest=y.ShowMessageNotification=y.MessageType=y.DidChangeConfigurationNotification=y.ExitNotification=y.ShutdownRequest=y.InitializedNotification=y.InitializeError=y.InitializeRequest=y.WorkDoneProgressOptions=y.TextDocumentRegistrationOptions=y.StaticRegistrationOptions=y.FailureHandlingKind=y.ResourceOperationKind=y.UnregistrationRequest=y.RegistrationRequest=y.DocumentSelector=y.NotebookCellTextDocumentFilter=y.NotebookDocumentFilter=y.TextDocumentFilter=void 0;y.InlineValueRequest=y.TypeHierarchySupertypesRequest=y.TypeHierarchySubtypesRequest=y.TypeHierarchyPrepareRequest=y.MonikerRequest=y.MonikerKind=y.UniquenessLevel=y.WillDeleteFilesRequest=y.DidDeleteFilesNotification=y.WillRenameFilesRequest=y.DidRenameFilesNotification=y.WillCreateFilesRequest=y.DidCreateFilesNotification=y.FileOperationPatternKind=y.LinkedEditingRangeRequest=y.ShowDocumentRequest=y.SemanticTokensRegistrationType=y.SemanticTokensRefreshRequest=y.SemanticTokensRangeRequest=y.SemanticTokensDeltaRequest=y.SemanticTokensRequest=y.TokenFormat=y.CallHierarchyPrepareRequest=y.CallHierarchyOutgoingCallsRequest=y.CallHierarchyIncomingCallsRequest=y.WorkDoneProgressCancelNotification=y.WorkDoneProgressCreateRequest=y.WorkDoneProgress=y.SelectionRangeRequest=y.DeclarationRequest=y.FoldingRangeRequest=y.ColorPresentationRequest=y.DocumentColorRequest=y.ConfigurationRequest=y.DidChangeWorkspaceFoldersNotification=y.WorkspaceFoldersRequest=y.TypeDefinitionRequest=y.ImplementationRequest=y.ApplyWorkspaceEditRequest=y.ExecuteCommandRequest=y.PrepareRenameRequest=y.RenameRequest=y.PrepareSupportDefaultBehavior=y.DocumentOnTypeFormattingRequest=y.DocumentRangeFormattingRequest=y.DocumentFormattingRequest=y.DocumentLinkResolveRequest=y.DocumentLinkRequest=y.CodeLensRefreshRequest=y.CodeLensResolveRequest=void 0;y.InlayHintRefreshRequest=y.InlayHintResolveRequest=y.InlayHintRequest=y.InlineValueRefreshRequest=void 0;var re=je(),xt=Io(),_R=Sp();Object.defineProperty(y,"ImplementationRequest",{enumerable:!0,get:function(){return _R.ImplementationRequest}});var PR=_p();Object.defineProperty(y,"TypeDefinitionRequest",{enumerable:!0,get:function(){return PR.TypeDefinitionRequest}});var Bp=Ep();Object.defineProperty(y,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return Bp.WorkspaceFoldersRequest}});Object.defineProperty(y,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return Bp.DidChangeWorkspaceFoldersNotification}});var ER=xp();Object.defineProperty(y,"ConfigurationRequest",{enumerable:!0,get:function(){return ER.ConfigurationRequest}});var Gp=qp();Object.defineProperty(y,"DocumentColorRequest",{enumerable:!0,get:function(){return Gp.DocumentColorRequest}});Object.defineProperty(y,"ColorPresentationRequest",{enumerable:!0,get:function(){return Gp.ColorPresentationRequest}});var xR=Op();Object.defineProperty(y,"FoldingRangeRequest",{enumerable:!0,get:function(){return xR.FoldingRangeRequest}});var kR=Ip();Object.defineProperty(y,"DeclarationRequest",{enumerable:!0,get:function(){return kR.DeclarationRequest}});var qR=Np();Object.defineProperty(y,"SelectionRangeRequest",{enumerable:!0,get:function(){return qR.SelectionRangeRequest}});var cc=Lp();Object.defineProperty(y,"WorkDoneProgress",{enumerable:!0,get:function(){return cc.WorkDoneProgress}});Object.defineProperty(y,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return cc.WorkDoneProgressCreateRequest}});Object.defineProperty(y,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return cc.WorkDoneProgressCancelNotification}});var uc=Ap();Object.defineProperty(y,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return uc.CallHierarchyIncomingCallsRequest}});Object.defineProperty(y,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return uc.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(y,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return uc.CallHierarchyPrepareRequest}});var ei=Mp();Object.defineProperty(y,"TokenFormat",{enumerable:!0,get:function(){return ei.TokenFormat}});Object.defineProperty(y,"SemanticTokensRequest",{enumerable:!0,get:function(){return ei.SemanticTokensRequest}});Object.defineProperty(y,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return ei.SemanticTokensDeltaRequest}});Object.defineProperty(y,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return ei.SemanticTokensRangeRequest}});Object.defineProperty(y,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return ei.SemanticTokensRefreshRequest}});Object.defineProperty(y,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return ei.SemanticTokensRegistrationType}});var OR=jp();Object.defineProperty(y,"ShowDocumentRequest",{enumerable:!0,get:function(){return OR.ShowDocumentRequest}});var IR=$p();Object.defineProperty(y,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return IR.LinkedEditingRangeRequest}});var Er=Hp();Object.defineProperty(y,"FileOperationPatternKind",{enumerable:!0,get:function(){return Er.FileOperationPatternKind}});Object.defineProperty(y,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Er.DidCreateFilesNotification}});Object.defineProperty(y,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Er.WillCreateFilesRequest}});Object.defineProperty(y,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Er.DidRenameFilesNotification}});Object.defineProperty(y,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Er.WillRenameFilesRequest}});Object.defineProperty(y,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Er.DidDeleteFilesNotification}});Object.defineProperty(y,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Er.WillDeleteFilesRequest}});var lc=Wp();Object.defineProperty(y,"UniquenessLevel",{enumerable:!0,get:function(){return lc.UniquenessLevel}});Object.defineProperty(y,"MonikerKind",{enumerable:!0,get:function(){return lc.MonikerKind}});Object.defineProperty(y,"MonikerRequest",{enumerable:!0,get:function(){return lc.MonikerRequest}});var dc=zp();Object.defineProperty(y,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return dc.TypeHierarchyPrepareRequest}});Object.defineProperty(y,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return dc.TypeHierarchySubtypesRequest}});Object.defineProperty(y,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return dc.TypeHierarchySupertypesRequest}});var Xp=Kp();Object.defineProperty(y,"InlineValueRequest",{enumerable:!0,get:function(){return Xp.InlineValueRequest}});Object.defineProperty(y,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Xp.InlineValueRefreshRequest}});var fc=Vp();Object.defineProperty(y,"InlayHintRequest",{enumerable:!0,get:function(){return fc.InlayHintRequest}});Object.defineProperty(y,"InlayHintResolveRequest",{enumerable:!0,get:function(){return fc.InlayHintResolveRequest}});Object.defineProperty(y,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return fc.InlayHintRefreshRequest}});var Qp;(function(n){function e(t){let r=t;return xt.string(r.language)||xt.string(r.scheme)||xt.string(r.pattern)}n.is=e})(Qp=y.TextDocumentFilter||(y.TextDocumentFilter={}));var Jp;(function(n){function e(t){let r=t;return xt.objectLiteral(r)&&(xt.string(r.notebookType)||xt.string(r.scheme)||xt.string(r.pattern))}n.is=e})(Jp=y.NotebookDocumentFilter||(y.NotebookDocumentFilter={}));var Yp;(function(n){function e(t){let r=t;return xt.objectLiteral(r)&&(xt.string(r.notebook)||Jp.is(r.notebook))&&(r.language===void 0||xt.string(r.language))}n.is=e})(Yp=y.NotebookCellTextDocumentFilter||(y.NotebookCellTextDocumentFilter={}));var Zp;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!xt.string(r)&&!Qp.is(r)&&!Yp.is(r))return!1;return!0}n.is=e})(Zp=y.DocumentSelector||(y.DocumentSelector={}));var NR;(function(n){n.type=new re.ProtocolRequestType("client/registerCapability")})(NR=y.RegistrationRequest||(y.RegistrationRequest={}));var FR;(function(n){n.type=new re.ProtocolRequestType("client/unregisterCapability")})(FR=y.UnregistrationRequest||(y.UnregistrationRequest={}));var LR;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(LR=y.ResourceOperationKind||(y.ResourceOperationKind={}));var AR;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(AR=y.FailureHandlingKind||(y.FailureHandlingKind={}));var MR;(function(n){function e(t){let r=t;return r&&xt.string(r.id)&&r.id.length>0}n.hasId=e})(MR=y.StaticRegistrationOptions||(y.StaticRegistrationOptions={}));var jR;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||Zp.is(r.documentSelector))}n.is=e})(jR=y.TextDocumentRegistrationOptions||(y.TextDocumentRegistrationOptions={}));var $R;(function(n){function e(r){let i=r;return xt.objectLiteral(i)&&(i.workDoneProgress===void 0||xt.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&xt.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})($R=y.WorkDoneProgressOptions||(y.WorkDoneProgressOptions={}));var HR;(function(n){n.type=new re.ProtocolRequestType("initialize")})(HR=y.InitializeRequest||(y.InitializeRequest={}));var WR;(function(n){n.unknownProtocolVersion=1})(WR=y.InitializeError||(y.InitializeError={}));var zR;(function(n){n.type=new re.ProtocolNotificationType("initialized")})(zR=y.InitializedNotification||(y.InitializedNotification={}));var UR;(function(n){n.type=new re.ProtocolRequestType0("shutdown")})(UR=y.ShutdownRequest||(y.ShutdownRequest={}));var KR;(function(n){n.type=new re.ProtocolNotificationType0("exit")})(KR=y.ExitNotification||(y.ExitNotification={}));var VR;(function(n){n.type=new re.ProtocolNotificationType("workspace/didChangeConfiguration")})(VR=y.DidChangeConfigurationNotification||(y.DidChangeConfigurationNotification={}));var BR;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4})(BR=y.MessageType||(y.MessageType={}));var GR;(function(n){n.type=new re.ProtocolNotificationType("window/showMessage")})(GR=y.ShowMessageNotification||(y.ShowMessageNotification={}));var XR;(function(n){n.type=new re.ProtocolRequestType("window/showMessageRequest")})(XR=y.ShowMessageRequest||(y.ShowMessageRequest={}));var QR;(function(n){n.type=new re.ProtocolNotificationType("window/logMessage")})(QR=y.LogMessageNotification||(y.LogMessageNotification={}));var JR;(function(n){n.type=new re.ProtocolNotificationType("telemetry/event")})(JR=y.TelemetryEventNotification||(y.TelemetryEventNotification={}));var YR;(function(n){n.None=0,n.Full=1,n.Incremental=2})(YR=y.TextDocumentSyncKind||(y.TextDocumentSyncKind={}));var ZR;(function(n){n.method="textDocument/didOpen",n.type=new re.ProtocolNotificationType(n.method)})(ZR=y.DidOpenTextDocumentNotification||(y.DidOpenTextDocumentNotification={}));var eb;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(eb=y.TextDocumentContentChangeEvent||(y.TextDocumentContentChangeEvent={}));var tb;(function(n){n.method="textDocument/didChange",n.type=new re.ProtocolNotificationType(n.method)})(tb=y.DidChangeTextDocumentNotification||(y.DidChangeTextDocumentNotification={}));var nb;(function(n){n.method="textDocument/didClose",n.type=new re.ProtocolNotificationType(n.method)})(nb=y.DidCloseTextDocumentNotification||(y.DidCloseTextDocumentNotification={}));var rb;(function(n){n.method="textDocument/didSave",n.type=new re.ProtocolNotificationType(n.method)})(rb=y.DidSaveTextDocumentNotification||(y.DidSaveTextDocumentNotification={}));var ib;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(ib=y.TextDocumentSaveReason||(y.TextDocumentSaveReason={}));var ob;(function(n){n.method="textDocument/willSave",n.type=new re.ProtocolNotificationType(n.method)})(ob=y.WillSaveTextDocumentNotification||(y.WillSaveTextDocumentNotification={}));var sb;(function(n){n.method="textDocument/willSaveWaitUntil",n.type=new re.ProtocolRequestType(n.method)})(sb=y.WillSaveTextDocumentWaitUntilRequest||(y.WillSaveTextDocumentWaitUntilRequest={}));var ab;(function(n){n.type=new re.ProtocolNotificationType("workspace/didChangeWatchedFiles")})(ab=y.DidChangeWatchedFilesNotification||(y.DidChangeWatchedFilesNotification={}));var cb;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(cb=y.FileChangeType||(y.FileChangeType={}));var ub;(function(n){n.Create=1,n.Change=2,n.Delete=4})(ub=y.WatchKind||(y.WatchKind={}));var lb;(function(n){n.type=new re.ProtocolNotificationType("textDocument/publishDiagnostics")})(lb=y.PublishDiagnosticsNotification||(y.PublishDiagnosticsNotification={}));var db;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(db=y.CompletionTriggerKind||(y.CompletionTriggerKind={}));var fb;(function(n){n.method="textDocument/completion",n.type=new re.ProtocolRequestType(n.method)})(fb=y.CompletionRequest||(y.CompletionRequest={}));var pb;(function(n){n.method="completionItem/resolve",n.type=new re.ProtocolRequestType(n.method)})(pb=y.CompletionResolveRequest||(y.CompletionResolveRequest={}));var hb;(function(n){n.method="textDocument/hover",n.type=new re.ProtocolRequestType(n.method)})(hb=y.HoverRequest||(y.HoverRequest={}));var gb;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(gb=y.SignatureHelpTriggerKind||(y.SignatureHelpTriggerKind={}));var mb;(function(n){n.method="textDocument/signatureHelp",n.type=new re.ProtocolRequestType(n.method)})(mb=y.SignatureHelpRequest||(y.SignatureHelpRequest={}));var vb;(function(n){n.method="textDocument/definition",n.type=new re.ProtocolRequestType(n.method)})(vb=y.DefinitionRequest||(y.DefinitionRequest={}));var yb;(function(n){n.method="textDocument/references",n.type=new re.ProtocolRequestType(n.method)})(yb=y.ReferencesRequest||(y.ReferencesRequest={}));var Cb;(function(n){n.method="textDocument/documentHighlight",n.type=new re.ProtocolRequestType(n.method)})(Cb=y.DocumentHighlightRequest||(y.DocumentHighlightRequest={}));var wb;(function(n){n.method="textDocument/documentSymbol",n.type=new re.ProtocolRequestType(n.method)})(wb=y.DocumentSymbolRequest||(y.DocumentSymbolRequest={}));var Rb;(function(n){n.method="textDocument/codeAction",n.type=new re.ProtocolRequestType(n.method)})(Rb=y.CodeActionRequest||(y.CodeActionRequest={}));var bb;(function(n){n.method="codeAction/resolve",n.type=new re.ProtocolRequestType(n.method)})(bb=y.CodeActionResolveRequest||(y.CodeActionResolveRequest={}));var Db;(function(n){n.method="workspace/symbol",n.type=new re.ProtocolRequestType(n.method)})(Db=y.WorkspaceSymbolRequest||(y.WorkspaceSymbolRequest={}));var Tb;(function(n){n.method="workspaceSymbol/resolve",n.type=new re.ProtocolRequestType(n.method)})(Tb=y.WorkspaceSymbolResolveRequest||(y.WorkspaceSymbolResolveRequest={}));var Sb;(function(n){n.method="textDocument/codeLens",n.type=new re.ProtocolRequestType(n.method)})(Sb=y.CodeLensRequest||(y.CodeLensRequest={}));var _b;(function(n){n.method="codeLens/resolve",n.type=new re.ProtocolRequestType(n.method)})(_b=y.CodeLensResolveRequest||(y.CodeLensResolveRequest={}));var Pb;(function(n){n.method="workspace/codeLens/refresh",n.type=new re.ProtocolRequestType0(n.method)})(Pb=y.CodeLensRefreshRequest||(y.CodeLensRefreshRequest={}));var Eb;(function(n){n.method="textDocument/documentLink",n.type=new re.ProtocolRequestType(n.method)})(Eb=y.DocumentLinkRequest||(y.DocumentLinkRequest={}));var xb;(function(n){n.method="documentLink/resolve",n.type=new re.ProtocolRequestType(n.method)})(xb=y.DocumentLinkResolveRequest||(y.DocumentLinkResolveRequest={}));var kb;(function(n){n.method="textDocument/formatting",n.type=new re.ProtocolRequestType(n.method)})(kb=y.DocumentFormattingRequest||(y.DocumentFormattingRequest={}));var qb;(function(n){n.method="textDocument/rangeFormatting",n.type=new re.ProtocolRequestType(n.method)})(qb=y.DocumentRangeFormattingRequest||(y.DocumentRangeFormattingRequest={}));var Ob;(function(n){n.method="textDocument/onTypeFormatting",n.type=new re.ProtocolRequestType(n.method)})(Ob=y.DocumentOnTypeFormattingRequest||(y.DocumentOnTypeFormattingRequest={}));var Ib;(function(n){n.Identifier=1})(Ib=y.PrepareSupportDefaultBehavior||(y.PrepareSupportDefaultBehavior={}));var Nb;(function(n){n.method="textDocument/rename",n.type=new re.ProtocolRequestType(n.method)})(Nb=y.RenameRequest||(y.RenameRequest={}));var Fb;(function(n){n.method="textDocument/prepareRename",n.type=new re.ProtocolRequestType(n.method)})(Fb=y.PrepareRenameRequest||(y.PrepareRenameRequest={}));var Lb;(function(n){n.type=new re.ProtocolRequestType("workspace/executeCommand")})(Lb=y.ExecuteCommandRequest||(y.ExecuteCommandRequest={}));var Ab;(function(n){n.type=new re.ProtocolRequestType("workspace/applyEdit")})(Ab=y.ApplyWorkspaceEditRequest||(y.ApplyWorkspaceEditRequest={}))});var nh=k(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.createProtocolConnection=void 0;var th=Pr();function Mb(n,e,t,r){return th.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,th.createMessageConnection)(n,e,t,r)}No.createProtocolConnection=Mb});var ih=k(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});dt.DiagnosticRefreshRequest=dt.WorkspaceDiagnosticRequest=dt.DocumentDiagnosticRequest=dt.DocumentDiagnosticReportKind=dt.DiagnosticServerCancellationData=void 0;var rh=Pr(),jb=Io(),pc=je(),$b;(function(n){function e(t){let r=t;return r&&jb.boolean(r.retriggerRequest)}n.is=e})($b=dt.DiagnosticServerCancellationData||(dt.DiagnosticServerCancellationData={}));var Hb;(function(n){n.full="full",n.unChanged="unChanged"})(Hb=dt.DocumentDiagnosticReportKind||(dt.DocumentDiagnosticReportKind={}));var Wb;(function(n){n.method="textDocument/diagnostic",n.type=new pc.ProtocolRequestType(n.method),n.partialResult=new rh.ProgressType})(Wb=dt.DocumentDiagnosticRequest||(dt.DocumentDiagnosticRequest={}));var zb;(function(n){n.method="workspace/diagnostic",n.type=new pc.ProtocolRequestType(n.method),n.partialResult=new rh.ProgressType})(zb=dt.WorkspaceDiagnosticRequest||(dt.WorkspaceDiagnosticRequest={}));var Ub;(function(n){n.method="workspace/diagnostic/refresh",n.type=new pc.ProtocolRequestType0(n.method)})(Ub=dt.DiagnosticRefreshRequest||(dt.DiagnosticRefreshRequest={}))});var ah=k(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.DidCloseNotebookDocumentNotification=ye.DidSaveNotebookDocumentNotification=ye.DidChangeNotebookDocumentNotification=ye.NotebookCellArrayChange=ye.DidOpenNotebookDocumentNotification=ye.NotebookDocumentSyncRegistrationType=ye.NotebookDocument=ye.NotebookCell=ye.ExecutionSummary=ye.NotebookCellKind=void 0;var Hi=Za(),gn=Io(),Wi=je(),oh;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(oh=ye.NotebookCellKind||(ye.NotebookCellKind={}));var sh;(function(n){function e(i,o){let s={executionOrder:i};return(o===!0||o===!1)&&(s.success=o),s}n.create=e;function t(i){let o=i;return gn.objectLiteral(o)&&Hi.uinteger.is(o.executionOrder)&&(o.success===void 0||gn.boolean(o.success))}n.is=t;function r(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}n.equals=r})(sh=ye.ExecutionSummary||(ye.ExecutionSummary={}));var hc;(function(n){function e(o,s){return{kind:o,document:s}}n.create=e;function t(o){let s=o;return gn.objectLiteral(s)&&oh.is(s.kind)&&Hi.DocumentUri.is(s.document)&&(s.metadata===void 0||gn.objectLiteral(s.metadata))}n.is=t;function r(o,s){let a=new Set;return o.document!==s.document&&a.add("document"),o.kind!==s.kind&&a.add("kind"),o.executionSummary!==s.executionSummary&&a.add("executionSummary"),(o.metadata!==void 0||s.metadata!==void 0)&&!i(o.metadata,s.metadata)&&a.add("metadata"),(o.executionSummary!==void 0||s.executionSummary!==void 0)&&!sh.equals(o.executionSummary,s.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(o,s){if(o===s)return!0;if(o==null||s===null||s===void 0||typeof o!=typeof s||typeof o!="object")return!1;let a=Array.isArray(o),c=Array.isArray(s);if(a!==c)return!1;if(a&&c){if(o.length!==s.length)return!1;for(let l=0;l<o.length;l++)if(!i(o[l],s[l]))return!1}if(gn.objectLiteral(o)&&gn.objectLiteral(s)){let l=Object.keys(o),g=Object.keys(s);if(l.length!==g.length||(l.sort(),g.sort(),!i(l,g)))return!1;for(let m=0;m<l.length;m++){let h=l[m];if(!i(o[h],s[h]))return!1}}return!0}})(hc=ye.NotebookCell||(ye.NotebookCell={}));var Kb;(function(n){function e(r,i,o,s){return{uri:r,notebookType:i,version:o,cells:s}}n.create=e;function t(r){let i=r;return gn.objectLiteral(i)&&gn.string(i.uri)&&Hi.integer.is(i.version)&&gn.typedArray(i.cells,hc.is)}n.is=t})(Kb=ye.NotebookDocument||(ye.NotebookDocument={}));var Vb;(function(n){n.method="notebookDocument/sync",n.type=new Wi.RegistrationType(n.method)})(Vb=ye.NotebookDocumentSyncRegistrationType||(ye.NotebookDocumentSyncRegistrationType={}));var Bb;(function(n){n.method="notebookDocument/didOpen",n.type=new Wi.ProtocolNotificationType(n.method)})(Bb=ye.DidOpenNotebookDocumentNotification||(ye.DidOpenNotebookDocumentNotification={}));var Gb;(function(n){function e(r){let i=r;return gn.objectLiteral(i)&&Hi.uinteger.is(i.start)&&Hi.uinteger.is(i.deleteCount)&&(i.cells===void 0||gn.typedArray(i.cells,hc.is))}n.is=e;function t(r,i,o){let s={start:r,deleteCount:i};return o!==void 0&&(s.cells=o),s}n.create=t})(Gb=ye.NotebookCellArrayChange||(ye.NotebookCellArrayChange={}));var Xb;(function(n){n.method="notebookDocument/didChange",n.type=new Wi.ProtocolNotificationType(n.method)})(Xb=ye.DidChangeNotebookDocumentNotification||(ye.DidChangeNotebookDocumentNotification={}));var Qb;(function(n){n.method="notebookDocument/didSave",n.type=new Wi.ProtocolNotificationType(n.method)})(Qb=ye.DidSaveNotebookDocumentNotification||(ye.DidSaveNotebookDocumentNotification={}));var Jb;(function(n){n.method="notebookDocument/didClose",n.type=new Wi.ProtocolNotificationType(n.method)})(Jb=ye.DidCloseNotebookDocumentNotification||(ye.DidCloseNotebookDocumentNotification={}))});var ch=k(at=>{"use strict";var Yb=at&&at.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Fo=at&&at.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Yb(e,n,t)};Object.defineProperty(at,"__esModule",{value:!0});at.Proposed=at.LSPErrorCodes=at.createProtocolConnection=void 0;Fo(Pr(),at);Fo(Za(),at);Fo(je(),at);Fo(eh(),at);var Zb=nh();Object.defineProperty(at,"createProtocolConnection",{enumerable:!0,get:function(){return Zb.createProtocolConnection}});var eD;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(eD=at.LSPErrorCodes||(at.LSPErrorCodes={}));var zi=ih(),or=ah(),tD;(function(n){n.DiagnosticServerCancellationData=zi.DiagnosticServerCancellationData,n.DocumentDiagnosticReportKind=zi.DocumentDiagnosticReportKind,n.DocumentDiagnosticRequest=zi.DocumentDiagnosticRequest,n.WorkspaceDiagnosticRequest=zi.WorkspaceDiagnosticRequest,n.DiagnosticRefreshRequest=zi.DiagnosticRefreshRequest,n.NotebookCellKind=or.NotebookCellKind,n.NotebookCell=or.NotebookCell,n.NotebookDocument=or.NotebookDocument,n.NotebookDocumentSyncRegistrationType=or.NotebookDocumentSyncRegistrationType,n.DidOpenNotebookDocumentNotification=or.DidOpenNotebookDocumentNotification,n.DidChangeNotebookDocumentNotification=or.DidChangeNotebookDocumentNotification,n.DidSaveNotebookDocumentNotification=or.DidSaveNotebookDocumentNotification,n.DidCloseNotebookDocumentNotification=or.DidCloseNotebookDocumentNotification})(tD=at.Proposed||(at.Proposed={}))});var Te=k(Dn=>{"use strict";var nD=Dn&&Dn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),uh=Dn&&Dn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&nD(e,n,t)};Object.defineProperty(Dn,"__esModule",{value:!0});Dn.createProtocolConnection=void 0;var rD=Ya();uh(Ya(),Dn);uh(ch(),Dn);function iD(n,e,t,r){return(0,rD.createMessageConnection)(n,e,t,r)}Dn.createProtocolConnection=iD});var vc=k(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.toJSONObject=ni.ConfigurationFeature=void 0;var gc=require("vscode"),oD=Te(),mc=class{constructor(e){this._client=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(oD.ConfigurationRequest.type,(t,r)=>{let i=s=>{let a=[];for(let c of s.items){let l=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(l,c.section!==null?c.section:void 0))}return a},o=e.clientOptions.middleware.workspace;return o&&o.configuration?o.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=ti(gc.workspace.getConfiguration(void 0,e).get(t));else{let o=gc.workspace.getConfiguration(t.substr(0,i),e);o&&(r=ti(o.get(t.substr(i+1))))}}else{let i=gc.workspace.getConfiguration(void 0,e);r={};for(let o of Object.keys(i))i.has(o)&&(r[o]=ti(i.get(o)))}return r===void 0&&(r=null),r}dispose(){}};ni.ConfigurationFeature=mc;function ti(n){if(n){if(Array.isArray(n))return n.map(ti);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=ti(n[t]));return e}}return n}ni.toJSONObject=ti});var Lo=k(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.forEach=tn.mapAsync=tn.map=tn.Semaphore=tn.Delayer=void 0;var Ki=Te(),yc=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,Ki.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};tn.Delayer=yc;var Cc=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Ki.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};tn.Semaphore=Cc;var lh=15,Ui=class{constructor(e=lh){this.yieldAfter=Math.max(e,lh),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function sD(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new Ui(r==null?void 0:r.yieldAfter);function s(c){o.start();for(let l=c;l<n.length;l++)if(i[l]=e(n[l]),o.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Ki.RAL)().timer.setImmediate(()=>{c(s(a))})});return i}tn.map=sD;async function aD(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new Ui(r==null?void 0:r.yieldAfter);async function s(c){o.start();for(let l=c;l<n.length;l++)if(i[l]=await e(n[l],t),o.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=await s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Ki.RAL)().timer.setImmediate(()=>{c(s(a))})});return i}tn.mapAsync=aD;async function cD(n,e,t,r){if(n.length===0)return;let i=new Ui(r==null?void 0:r.yieldAfter);function o(a){i.start();for(let c=a;c<n.length;c++)if(e(n[c]),i.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),c+1;return-1}let s=o(0);for(;s!==-1&&!(t!==void 0&&t.isCancellationRequested);)s=await new Promise(a=>{(0,Ki.RAL)().timer.setImmediate(()=>{a(o(s))})})}tn.forEach=cD});var bc=k(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});var uD=require("vscode"),wc=class extends uD.CompletionItem{constructor(e){super(e)}};Rc.default=wc});var Sc=k(Tc=>{"use strict";Object.defineProperty(Tc,"__esModule",{value:!0});var lD=require("vscode"),Dc=class extends lD.CodeLens{constructor(e){super(e)}};Tc.default=Dc});var Ec=k(Pc=>{"use strict";Object.defineProperty(Pc,"__esModule",{value:!0});var dD=require("vscode"),_c=class extends dD.DocumentLink{constructor(e,t){super(e,t)}};Pc.default=_c});var qc=k(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});var fD=require("vscode"),xc=class extends fD.CodeAction{constructor(e,t){super(e),this.data=t}};kc.default=xc});var Nc=k(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.ProtocolDiagnostic=xr.DiagnosticCode=void 0;var pD=require("vscode"),Oc=Rn(),hD;(function(n){function e(t){let r=t;return r!=null&&(Oc.number(r.value)||Oc.string(r.value))&&Oc.string(r.target)}n.is=e})(hD=xr.DiagnosticCode||(xr.DiagnosticCode={}));var Ic=class extends pD.Diagnostic{constructor(e,t,r,i){super(e,t,r),this.data=i,this.hasDiagnosticCode=!1}};xr.ProtocolDiagnostic=Ic});var Ac=k(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});var gD=require("vscode"),Fc=class extends gD.CallHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s),a!==void 0&&(this.data=a)}};Lc.default=Fc});var $c=k(jc=>{"use strict";Object.defineProperty(jc,"__esModule",{value:!0});var mD=require("vscode"),Mc=class extends mD.TypeHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s),a!==void 0&&(this.data=a)}};jc.default=Mc});var zc=k(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});var Ao=require("vscode"),Hc=class extends Ao.SymbolInformation{constructor(e,t,r,i,o){let s=!(i instanceof Ao.Uri);super(e,t,r,s?i:new Ao.Location(i,new Ao.Range(0,0,0,0))),this.hasRange=s,o!==void 0&&(this.data=o)}};Wc.default=Hc});var Vc=k(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});var vD=require("vscode"),Uc=class extends vD.InlayHint{constructor(e,t,r){super(e,t,r)}};Kc.default=Uc});var ph=k(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.createConverter=void 0;var Ze=require("vscode"),oe=Te(),ri=Rn(),dh=Lo(),yD=bc(),CD=Sc(),wD=Ec(),RD=qc(),fh=Nc(),bD=Ac(),DD=$c(),TD=zc(),SD=Vc(),Bc;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(Bc||(Bc={}));function _D(n){let t=n||(p=>p.toString());function r(p){return t(p)}function i(p){return{uri:t(p.uri)}}function o(p){return{uri:t(p.uri),languageId:p.languageId,version:p.version,text:p.getText()}}function s(p){return{uri:t(p.uri),version:p.version}}function a(p){return{textDocument:o(p)}}function c(p){let E=p;return!!E.document&&!!E.contentChanges}function l(p){let E=p;return!!E.uri&&!!E.version}function g(p){if(l(p))return{textDocument:{uri:t(p.uri),version:p.version},contentChanges:[{text:p.getText()}]};if(c(p)){let E=p.document;return{textDocument:{uri:t(E.uri),version:E.version},contentChanges:p.contentChanges.map(S=>{let f=S.range;return{range:{start:{line:f.start.line,character:f.start.character},end:{line:f.end.line,character:f.end.character}},rangeLength:S.rangeLength,text:S.text}})}}else throw Error("Unsupported text document change parameter")}function m(p){return{textDocument:i(p)}}function h(p,E=!1){let z={textDocument:i(p)};return E&&(z.text=p.getText()),z}function C(p){switch(p){case Ze.TextDocumentSaveReason.Manual:return oe.TextDocumentSaveReason.Manual;case Ze.TextDocumentSaveReason.AfterDelay:return oe.TextDocumentSaveReason.AfterDelay;case Ze.TextDocumentSaveReason.FocusOut:return oe.TextDocumentSaveReason.FocusOut}return oe.TextDocumentSaveReason.Manual}function b(p){return{textDocument:i(p.document),reason:C(p.reason)}}function x(p){return{files:p.files.map(E=>({uri:t(E)}))}}function q(p){return{files:p.files.map(E=>({oldUri:t(E.oldUri),newUri:t(E.newUri)}))}}function O(p){return{files:p.files.map(E=>({uri:t(E)}))}}function I(p){return{files:p.files.map(E=>({uri:t(E)}))}}function N(p){return{files:p.files.map(E=>({oldUri:t(E.oldUri),newUri:t(E.newUri)}))}}function $(p){return{files:p.files.map(E=>({uri:t(E)}))}}function K(p,E){return{textDocument:i(p),position:ct(E)}}function de(p){switch(p){case Ze.CompletionTriggerKind.TriggerCharacter:return oe.CompletionTriggerKind.TriggerCharacter;case Ze.CompletionTriggerKind.TriggerForIncompleteCompletions:return oe.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return oe.CompletionTriggerKind.Invoked}}function se(p,E,z){return{textDocument:i(p),position:ct(E),context:{triggerKind:de(z.triggerKind),triggerCharacter:z.triggerCharacter}}}function We(p){switch(p){case Ze.SignatureHelpTriggerKind.Invoke:return oe.SignatureHelpTriggerKind.Invoked;case Ze.SignatureHelpTriggerKind.TriggerCharacter:return oe.SignatureHelpTriggerKind.TriggerCharacter;case Ze.SignatureHelpTriggerKind.ContentChange:return oe.SignatureHelpTriggerKind.ContentChange}}function Ge(p){return{label:p.label}}function rt(p){return p.map(Ge)}function bt(p){return{label:p.label,parameters:rt(p.parameters)}}function gt(p){return p.map(bt)}function mt(p){return p===void 0?p:{signatures:gt(p.signatures),activeSignature:p.activeSignature,activeParameter:p.activeParameter}}function Dt(p,E,z){return{textDocument:i(p),position:ct(E),context:{isRetrigger:z.isRetrigger,triggerCharacter:z.triggerCharacter,triggerKind:We(z.triggerKind),activeSignatureHelp:mt(z.activeSignatureHelp)}}}function ct(p){return{line:p.line,character:p.character}}function vt(p){return p==null?p:{line:p.line>oe.uinteger.MAX_VALUE?oe.uinteger.MAX_VALUE:p.line,character:p.character>oe.uinteger.MAX_VALUE?oe.uinteger.MAX_VALUE:p.character}}function xn(p,E){return dh.map(p,vt,E)}function Le(p){return p==null?p:{start:vt(p.start),end:vt(p.end)}}function tt(p){return p==null?p:oe.Location.create(r(p.uri),Le(p.range))}function ut(p){switch(p){case Ze.DiagnosticSeverity.Error:return oe.DiagnosticSeverity.Error;case Ze.DiagnosticSeverity.Warning:return oe.DiagnosticSeverity.Warning;case Ze.DiagnosticSeverity.Information:return oe.DiagnosticSeverity.Information;case Ze.DiagnosticSeverity.Hint:return oe.DiagnosticSeverity.Hint}}function Nt(p){if(!p)return;let E=[];for(let z of p){let S=Xe(z);S!==void 0&&E.push(S)}return E.length>0?E:void 0}function Xe(p){switch(p){case Ze.DiagnosticTag.Unnecessary:return oe.DiagnosticTag.Unnecessary;case Ze.DiagnosticTag.Deprecated:return oe.DiagnosticTag.Deprecated;default:return}}function dr(p){return{message:p.message,location:tt(p.location)}}function Bn(p){return p.map(dr)}function Gn(p){if(p!=null)return ri.number(p)||ri.string(p)?p:{value:p.value,target:r(p.target)}}function kn(p){let E=oe.Diagnostic.create(Le(p.range),p.message),z=p instanceof fh.ProtocolDiagnostic?p:void 0;z!==void 0&&z.data!==void 0&&(E.data=z.data);let S=Gn(p.code);return fh.DiagnosticCode.is(S)?z!==void 0&&z.hasDiagnosticCode?E.code=S:(E.code=S.value,E.codeDescription={href:S.target}):E.code=S,ri.number(p.severity)&&(E.severity=ut(p.severity)),Array.isArray(p.tags)&&(E.tags=Nt(p.tags)),p.relatedInformation&&(E.relatedInformation=Bn(p.relatedInformation)),p.source&&(E.source=p.source),E}function qn(p,E){return p==null?p:dh.map(p,kn,E)}function fr(p,E){switch(p){case"$string":return E;case oe.MarkupKind.PlainText:return{kind:p,value:E};case oe.MarkupKind.Markdown:return{kind:p,value:E.value};default:return`Unsupported Markup content received. Kind is: ${p}`}}function Xn(p){switch(p){case Ze.CompletionItemTag.Deprecated:return oe.CompletionItemTag.Deprecated}}function Qn(p){if(p===void 0)return p;let E=[];for(let z of p){let S=Xn(z);S!==void 0&&E.push(S)}return E}function yt(p,E){return E!==void 0?E:p+1}function Xt(p,E=!1){let z,S;ri.string(p.label)?z=p.label:(z=p.label.label,E&&(p.label.detail!==void 0||p.label.description!==void 0)&&(S={detail:p.label.detail,description:p.label.description}));let f={label:z};S!==void 0&&(f.labelDetails=S);let D=p instanceof yD.default?p:void 0;p.detail&&(f.detail=p.detail),p.documentation&&(!D||D.documentationFormat==="$string"?f.documentation=p.documentation:f.documentation=fr(D.documentationFormat,p.documentation)),p.filterText&&(f.filterText=p.filterText),Jn(f,p),ri.number(p.kind)&&(f.kind=yt(p.kind,D&&D.originalItemKind)),p.sortText&&(f.sortText=p.sortText),p.additionalTextEdits&&(f.additionalTextEdits=Cn(p.additionalTextEdits)),p.commitCharacters&&(f.commitCharacters=p.commitCharacters.slice()),p.command&&(f.command=Ht(p.command)),(p.preselect===!0||p.preselect===!1)&&(f.preselect=p.preselect);let T=Qn(p.tags);if(D){if(D.data!==void 0&&(f.data=D.data),D.deprecated===!0||D.deprecated===!1){if(D.deprecated===!0&&T!==void 0&&T.length>0){let v=T.indexOf(Ze.CompletionItemTag.Deprecated);v!==-1&&T.splice(v,1)}f.deprecated=D.deprecated}D.insertTextMode!==void 0&&(f.insertTextMode=D.insertTextMode)}return T!==void 0&&T.length>0&&(f.tags=T),f.insertTextMode===void 0&&p.keepWhitespace===!0&&(f.insertTextMode=oe.InsertTextMode.adjustIndentation),f}function Jn(p,E){let z=oe.InsertTextFormat.PlainText,S,f;E.textEdit?(S=E.textEdit.newText,f=E.textEdit.range):E.insertText instanceof Ze.SnippetString?(z=oe.InsertTextFormat.Snippet,S=E.insertText.value):S=E.insertText,E.range&&(f=E.range),p.insertTextFormat=z,E.fromEdit&&S!==void 0&&f!==void 0?p.textEdit=Mt(S,f):p.insertText=S}function Mt(p,E){return Bc.is(E)?oe.InsertReplaceEdit.create(p,Le(E.inserting),Le(E.replacing)):{newText:p,range:Le(E)}}function On(p){return{range:Le(p.range),newText:p.newText}}function Cn(p){return p==null?p:p.map(On)}function jt(p){return p<=Ze.SymbolKind.TypeParameter?p+1:oe.SymbolKind.Property}function Ft(p){return p}function Qe(p){return p.map(Ft)}function pr(p,E,z){return{textDocument:i(p),position:ct(E),context:{includeDeclaration:z.includeDeclaration}}}async function Tt(p,E){let z=oe.CodeAction.create(p.title);if(p instanceof RD.default&&p.data!==void 0&&(z.data=p.data),p.kind!==void 0&&(z.kind=In(p.kind)),p.diagnostics!==void 0&&(z.diagnostics=await qn(p.diagnostics,E)),p.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return p.command!==void 0&&(z.command=Ht(p.command)),p.isPreferred!==void 0&&(z.isPreferred=p.isPreferred),p.disabled!==void 0&&(z.disabled={reason:p.disabled.reason}),z}async function $t(p,E){if(p==null)return p;let z;return p.only&&ri.string(p.only.value)&&(z=[p.only.value]),oe.CodeActionContext.create(await qn(p.diagnostics,E),z,wn(p.triggerKind))}function wn(p){switch(p){case Ze.CodeActionTriggerKind.Invoke:return oe.CodeActionTriggerKind.Invoked;case Ze.CodeActionTriggerKind.Automatic:return oe.CodeActionTriggerKind.Automatic;default:return}}function In(p){if(p!=null)return p.value}function Nn(p){return p==null?p:oe.InlineValueContext.create(p.frameId,p.stoppedLocation)}function Ht(p){let E=oe.Command.create(p.title,p.command);return p.arguments&&(E.arguments=p.arguments),E}function Qt(p){let E=oe.CodeLens.create(Le(p.range));return p.command&&(E.command=Ht(p.command)),p instanceof CD.default&&p.data&&(E.data=p.data),E}function R(p,E){let z={tabSize:p.tabSize,insertSpaces:p.insertSpaces};return E.trimTrailingWhitespace&&(z.trimTrailingWhitespace=!0),E.trimFinalNewlines&&(z.trimFinalNewlines=!0),E.insertFinalNewline&&(z.insertFinalNewline=!0),z}function F(p){return{textDocument:i(p)}}function H(p){return{textDocument:i(p)}}function V(p){let E=oe.DocumentLink.create(Le(p.range));p.target&&(E.target=r(p.target)),p.tooltip!==void 0&&(E.tooltip=p.tooltip);let z=p instanceof wD.default?p:void 0;return z&&z.data&&(E.data=z.data),E}function he(p){return{textDocument:i(p)}}function ge(p){let E={name:p.name,kind:jt(p.kind),uri:r(p.uri),range:Le(p.range),selectionRange:Le(p.selectionRange)};return p.detail!==void 0&&p.detail.length>0&&(E.detail=p.detail),p.tags!==void 0&&(E.tags=Qe(p.tags)),p instanceof bD.default&&p.data!==void 0&&(E.data=p.data),E}function me(p){let E={name:p.name,kind:jt(p.kind),uri:r(p.uri),range:Le(p.range),selectionRange:Le(p.selectionRange)};return p.detail!==void 0&&p.detail.length>0&&(E.detail=p.detail),p.tags!==void 0&&(E.tags=Qe(p.tags)),p instanceof DD.default&&p.data!==void 0&&(E.data=p.data),E}function qe(p){let E=p instanceof TD.default?{name:p.name,kind:jt(p.kind),location:p.hasRange?tt(p.location):{uri:t(p.location.uri)},data:p.data}:{name:p.name,kind:jt(p.kind),location:tt(p.location)};return p.tags!==void 0&&(E.tags=Qe(p.tags)),p.containerName!==""&&(E.containerName=p.containerName),E}function ue(p){let E=typeof p.label=="string"?p.label:p.label.map(Ce),z=oe.InlayHint.create(vt(p.position),E);return p.kind!==void 0&&(z.kind=p.kind),p.textEdits!==void 0&&(z.textEdits=Cn(p.textEdits)),p.tooltip!==void 0&&(z.tooltip=le(p.tooltip)),p.paddingLeft!==void 0&&(z.paddingLeft=p.paddingLeft),p.paddingRight!==void 0&&(z.paddingRight=p.paddingRight),p instanceof SD.default&&p.data!==void 0&&(z.data=p.data),z}function Ce(p){let E=oe.InlayHintLabelPart.create(p.value);return p.location!==void 0&&(E.location=tt(p.location)),p.command!==void 0&&(E.command=Ht(p.command)),p.tooltip!==void 0&&(E.tooltip=le(p.tooltip)),E}function le(p){return typeof p=="string"?p:{kind:oe.MarkupKind.Markdown,value:p.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:a,asChangeTextDocumentParams:g,asCloseTextDocumentParams:m,asSaveTextDocumentParams:h,asWillSaveTextDocumentParams:b,asDidCreateFilesParams:x,asDidRenameFilesParams:q,asDidDeleteFilesParams:O,asWillCreateFilesParams:I,asWillRenameFilesParams:N,asWillDeleteFilesParams:$,asTextDocumentPositionParams:K,asCompletionParams:se,asSignatureHelpParams:Dt,asWorkerPosition:ct,asRange:Le,asPosition:vt,asPositions:xn,asLocation:tt,asDiagnosticSeverity:ut,asDiagnosticTag:Xe,asDiagnostic:kn,asDiagnostics:qn,asCompletionItem:Xt,asTextEdit:On,asSymbolKind:jt,asSymbolTag:Ft,asSymbolTags:Qe,asReferenceParams:pr,asCodeAction:Tt,asCodeActionContext:$t,asInlineValueContext:Nn,asCommand:Ht,asCodeLens:Qt,asFormattingOptions:R,asDocumentSymbolParams:F,asCodeLensParams:H,asDocumentLink:V,asDocumentLinkParams:he,asCallHierarchyItem:ge,asTypeHierarchyItem:me,asInlayHint:ue,asWorkspaceSymbol:qe}}Mo.createConverter=_D});var mh=k($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.createConverter=void 0;var W=require("vscode"),ne=Te(),mn=Rn(),Re=Lo(),PD=bc(),ED=Sc(),xD=Ec(),kD=qc(),hh=Nc(),qD=Ac(),OD=$c(),ID=zc(),ND=Vc(),gh=Te(),jo;(function(n){function e(t){let r=t;return r&&mn.string(r.language)&&mn.string(r.value)}n.is=e})(jo||(jo={}));function FD(n,e,t){let i=n||(u=>W.Uri.parse(u));function o(u){return i(u)}function s(u){let _=[];for(let j of u)if(typeof j=="string")_.push(j);else if(gh.TextDocumentFilter.is(j))_.push({language:j.language,scheme:j.scheme,pattern:j.pattern});else if(gh.NotebookCellTextDocumentFilter.is(j))if(typeof j.notebook=="string")_.push({notebookType:j.notebook,language:j.language});else{let J=j.notebook.notebookType??"*";_.push({notebookType:J,scheme:j.notebook.scheme,pattern:j.notebook.pattern,language:j.language})}return _}async function a(u,_){return Re.map(u,l,_)}function c(u){let _=new Array(u.length);for(let j=0;j<u.length;j++)_[j]=l(u[j]);return _}function l(u){let _=new hh.ProtocolDiagnostic(b(u.range),u.message,q(u.severity),u.data);if(u.code!==void 0){if(typeof u.code=="string"||typeof u.code=="number")ne.CodeDescription.is(u.codeDescription)?_.code={value:u.code,target:o(u.codeDescription.href)}:_.code=u.code;else if(hh.DiagnosticCode.is(u.code)){_.hasDiagnosticCode=!0;let j=u.code;_.code={value:j.value,target:o(j.target)}}}return u.source&&(_.source=u.source),u.relatedInformation&&(_.relatedInformation=g(u.relatedInformation)),Array.isArray(u.tags)&&(_.tags=m(u.tags)),_}function g(u){let _=new Array(u.length);for(let j=0;j<u.length;j++){let J=u[j];_[j]=new W.DiagnosticRelatedInformation(Xe(J.location),J.message)}return _}function m(u){if(!u)return;let _=[];for(let j of u){let J=h(j);J!==void 0&&_.push(J)}return _.length>0?_:void 0}function h(u){switch(u){case ne.DiagnosticTag.Unnecessary:return W.DiagnosticTag.Unnecessary;case ne.DiagnosticTag.Deprecated:return W.DiagnosticTag.Deprecated;default:return}}function C(u){return u?new W.Position(u.line,u.character):void 0}function b(u){return u?new W.Range(u.start.line,u.start.character,u.end.line,u.end.character):void 0}async function x(u,_){return Re.map(u,j=>new W.Range(j.start.line,j.start.character,j.end.line,j.end.character),_)}function q(u){if(u==null)return W.DiagnosticSeverity.Error;switch(u){case ne.DiagnosticSeverity.Error:return W.DiagnosticSeverity.Error;case ne.DiagnosticSeverity.Warning:return W.DiagnosticSeverity.Warning;case ne.DiagnosticSeverity.Information:return W.DiagnosticSeverity.Information;case ne.DiagnosticSeverity.Hint:return W.DiagnosticSeverity.Hint}return W.DiagnosticSeverity.Error}function O(u){if(mn.string(u))return N(u);if(jo.is(u))return N().appendCodeblock(u.value,u.language);if(Array.isArray(u)){let _=[];for(let j of u){let J=N();jo.is(j)?J.appendCodeblock(j.value,j.language):J.appendMarkdown(j),_.push(J)}return _}else return N(u)}function I(u){if(mn.string(u))return u;switch(u.kind){case ne.MarkupKind.Markdown:return N(u.value);case ne.MarkupKind.PlainText:return u.value;default:return`Unsupported Markup content received. Kind is: ${u.kind}`}}function N(u){let _;if(u===void 0||typeof u=="string")_=new W.MarkdownString(u);else switch(u.kind){case ne.MarkupKind.Markdown:_=new W.MarkdownString(u.value);break;case ne.MarkupKind.PlainText:_=new W.MarkdownString,_.appendText(u.value);break;default:_=new W.MarkdownString,_.appendText(`Unsupported Markup content received. Kind is: ${u.kind}`);break}return _.isTrusted=e,_.supportHtml=t,_}function $(u){if(!!u)return new W.Hover(O(u.contents),b(u.range))}async function K(u,_,j){if(!u)return;if(Array.isArray(u))return Re.map(u,hr=>rt(hr,_),j);let J=u,{range:lt,inserting:it,replacing:Z,commitCharacters:on}=de(J,_),sn=await Re.map(J.items,hr=>{var mi,Gl;let Hr=rt(hr,on,(mi=J.itemDefaults)==null?void 0:mi.insertTextMode,(Gl=J.itemDefaults)==null?void 0:Gl.insertTextFormat);return Hr.range===void 0&&(lt!==void 0?Hr.range=lt:it!==void 0&&Z!==void 0&&(Hr.range={inserting:it,replacing:Z})),Hr},j);return new W.CompletionList(sn,J.isIncomplete)}function de(u,_){var lt,it;let j=(lt=u.itemDefaults)==null?void 0:lt.editRange,J=((it=u.itemDefaults)==null?void 0:it.commitCharacters)??_;return ne.Range.is(j)?{range:b(j),inserting:void 0,replacing:void 0,commitCharacters:J}:j!==void 0?{range:void 0,inserting:b(j.insert),replacing:b(j.replace),commitCharacters:J}:{range:void 0,inserting:void 0,replacing:void 0,commitCharacters:J}}function se(u){return ne.CompletionItemKind.Text<=u&&u<=ne.CompletionItemKind.TypeParameter?[u-1,void 0]:[W.CompletionItemKind.Text,u]}function We(u){switch(u){case ne.CompletionItemTag.Deprecated:return W.CompletionItemTag.Deprecated}}function Ge(u){if(u==null)return[];let _=[];for(let j of u){let J=We(j);J!==void 0&&_.push(J)}return _}function rt(u,_,j,J){let lt=Ge(u.tags),it=bt(u),Z=new PD.default(it);u.detail&&(Z.detail=u.detail),u.documentation&&(Z.documentation=I(u.documentation),Z.documentationFormat=mn.string(u.documentation)?"$string":u.documentation.kind),u.filterText&&(Z.filterText=u.filterText);let on=gt(u,J);if(on&&(Z.insertText=on.text,Z.range=on.range,Z.fromEdit=on.fromEdit),mn.number(u.kind)){let[Hr,mi]=se(u.kind);Z.kind=Hr,mi&&(Z.originalItemKind=mi)}u.sortText&&(Z.sortText=u.sortText),u.additionalTextEdits&&(Z.additionalTextEdits=vt(u.additionalTextEdits));let sn=u.commitCharacters!==void 0?mn.stringArray(u.commitCharacters)?u.commitCharacters:void 0:_;sn&&(Z.commitCharacters=sn.slice()),u.command&&(Z.command=Qe(u.command)),(u.deprecated===!0||u.deprecated===!1)&&(Z.deprecated=u.deprecated,u.deprecated===!0&&lt.push(W.CompletionItemTag.Deprecated)),(u.preselect===!0||u.preselect===!1)&&(Z.preselect=u.preselect),u.data!==void 0&&(Z.data=u.data),lt.length>0&&(Z.tags=lt);let hr=u.insertTextMode??j;return hr!==void 0&&(Z.insertTextMode=hr,hr===ne.InsertTextMode.asIs&&(Z.keepWhitespace=!0)),Z}function bt(u){return ne.CompletionItemLabelDetails.is(u.labelDetails)?{label:u.label,detail:u.labelDetails.detail,description:u.labelDetails.description}:u.label}function gt(u,_){let j=u.insertTextFormat??_;return u.textEdit?j===ne.InsertTextFormat.Snippet?{text:new W.SnippetString(u.textEdit.newText),range:mt(u.textEdit),fromEdit:!0}:{text:u.textEdit.newText,range:mt(u.textEdit),fromEdit:!0}:u.insertText?j===ne.InsertTextFormat.Snippet?{text:new W.SnippetString(u.insertText),fromEdit:!1}:{text:u.insertText,fromEdit:!1}:void 0}function mt(u){return ne.InsertReplaceEdit.is(u)?{inserting:b(u.insert),replacing:b(u.replace)}:b(u.range)}function Dt(u){if(!!u)return new W.TextEdit(b(u.range),u.newText)}async function ct(u,_){if(!!u)return Re.map(u,Dt,_)}function vt(u){if(!u)return;let _=new Array(u.length);for(let j=0;j<u.length;j++)_[j]=Dt(u[j]);return _}async function xn(u,_){if(!u)return;let j=new W.SignatureHelp;return mn.number(u.activeSignature)?j.activeSignature=u.activeSignature:j.activeSignature=0,mn.number(u.activeParameter)?j.activeParameter=u.activeParameter:j.activeParameter=0,u.signatures&&(j.signatures=await Le(u.signatures,_)),j}async function Le(u,_){return Re.mapAsync(u,tt,_)}async function tt(u,_){let j=new W.SignatureInformation(u.label);return u.documentation!==void 0&&(j.documentation=I(u.documentation)),u.parameters!==void 0&&(j.parameters=await ut(u.parameters,_)),u.activeParameter!==void 0&&(j.activeParameter=u.activeParameter),j}function ut(u,_){return Re.map(u,Nt,_)}function Nt(u){let _=new W.ParameterInformation(u.label);return u.documentation&&(_.documentation=I(u.documentation)),_}function Xe(u){return u?new W.Location(i(u.uri),b(u.range)):void 0}async function dr(u,_){if(!!u)return kn(u,_)}async function Bn(u,_){if(!!u)return kn(u,_)}function Gn(u){if(!u)return;let _={targetUri:i(u.targetUri),targetRange:b(u.targetRange),originSelectionRange:b(u.originSelectionRange),targetSelectionRange:b(u.targetSelectionRange)};if(!_.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return _}async function kn(u,_){if(!!u)if(mn.array(u)){if(u.length===0)return[];if(ne.LocationLink.is(u[0])){let j=u;return Re.map(j,Gn,_)}else{let j=u;return Re.map(j,Xe,_)}}else return ne.LocationLink.is(u)?[Gn(u)]:Xe(u)}async function qn(u,_){if(!!u)return Re.map(u,Xe,_)}async function fr(u,_){if(!!u)return Re.map(u,Xn,_)}function Xn(u){let _=new W.DocumentHighlight(b(u.range));return mn.number(u.kind)&&(_.kind=Qn(u.kind)),_}function Qn(u){switch(u){case ne.DocumentHighlightKind.Text:return W.DocumentHighlightKind.Text;case ne.DocumentHighlightKind.Read:return W.DocumentHighlightKind.Read;case ne.DocumentHighlightKind.Write:return W.DocumentHighlightKind.Write}return W.DocumentHighlightKind.Text}async function yt(u,_){if(!!u)return Re.map(u,On,_)}function Xt(u){return u<=ne.SymbolKind.TypeParameter?u-1:W.SymbolKind.Property}function Jn(u){switch(u){case ne.SymbolTag.Deprecated:return W.SymbolTag.Deprecated;default:return}}function Mt(u){if(u==null)return;let _=[];for(let j of u){let J=Jn(j);J!==void 0&&_.push(J)}return _.length===0?void 0:_}function On(u){let _=u.data,j=u.location,J=j.range===void 0||_!==void 0?new ID.default(u.name,Xt(u.kind),u.containerName??"",j.range===void 0?i(j.uri):new W.Location(i(u.location.uri),b(j.range)),_):new W.SymbolInformation(u.name,Xt(u.kind),u.containerName??"",new W.Location(i(u.location.uri),b(j.range)));return Ft(J,u),J}async function Cn(u,_){if(u!=null)return Re.map(u,jt,_)}function jt(u){let _=new W.DocumentSymbol(u.name,u.detail||"",Xt(u.kind),b(u.range),b(u.selectionRange));if(Ft(_,u),u.children!==void 0&&u.children.length>0){let j=[];for(let J of u.children)j.push(jt(J));_.children=j}return _}function Ft(u,_){u.tags=Mt(_.tags),_.deprecated&&(u.tags?u.tags.includes(W.SymbolTag.Deprecated)||(u.tags=u.tags.concat(W.SymbolTag.Deprecated)):u.tags=[W.SymbolTag.Deprecated])}function Qe(u){let _={title:u.title,command:u.command};return u.arguments&&(_.arguments=u.arguments),_}async function pr(u,_){if(!!u)return Re.map(u,Qe,_)}let Tt=new Map;Tt.set(ne.CodeActionKind.Empty,W.CodeActionKind.Empty),Tt.set(ne.CodeActionKind.QuickFix,W.CodeActionKind.QuickFix),Tt.set(ne.CodeActionKind.Refactor,W.CodeActionKind.Refactor),Tt.set(ne.CodeActionKind.RefactorExtract,W.CodeActionKind.RefactorExtract),Tt.set(ne.CodeActionKind.RefactorInline,W.CodeActionKind.RefactorInline),Tt.set(ne.CodeActionKind.RefactorRewrite,W.CodeActionKind.RefactorRewrite),Tt.set(ne.CodeActionKind.Source,W.CodeActionKind.Source),Tt.set(ne.CodeActionKind.SourceOrganizeImports,W.CodeActionKind.SourceOrganizeImports);function $t(u){if(u==null)return;let _=Tt.get(u);if(_)return _;let j=u.split(".");_=W.CodeActionKind.Empty;for(let J of j)_=_.append(J);return _}function wn(u){if(u!=null)return u.map(_=>$t(_))}async function In(u,_){if(u==null)return;let j=new kD.default(u.title,u.data);return u.kind!==void 0&&(j.kind=$t(u.kind)),u.diagnostics!==void 0&&(j.diagnostics=c(u.diagnostics)),u.edit!==void 0&&(j.edit=await R(u.edit,_)),u.command!==void 0&&(j.command=Qe(u.command)),u.isPreferred!==void 0&&(j.isPreferred=u.isPreferred),u.disabled!==void 0&&(j.disabled={reason:u.disabled.reason}),j}function Nn(u,_){return Re.mapAsync(u,async j=>ne.Command.is(j)?Qe(j):In(j,_),_)}function Ht(u){if(!u)return;let _=new ED.default(b(u.range));return u.command&&(_.command=Qe(u.command)),u.data!==void 0&&u.data!==null&&(_.data=u.data),_}async function Qt(u,_){if(!!u)return Re.map(u,Ht,_)}async function R(u,_){if(!u)return;let j=new Map;if(u.changeAnnotations!==void 0){let it=u.changeAnnotations;await Re.forEach(Object.keys(it),Z=>{let on=F(it[Z]);j.set(Z,on)},_)}let J=it=>{if(it!==void 0)return j.get(it)},lt=new W.WorkspaceEdit;if(u.documentChanges){let it=u.documentChanges;await Re.forEach(it,Z=>{if(ne.CreateFile.is(Z))lt.createFile(i(Z.uri),Z.options,J(Z.annotationId));else if(ne.RenameFile.is(Z))lt.renameFile(i(Z.oldUri),i(Z.newUri),Z.options,J(Z.annotationId));else if(ne.DeleteFile.is(Z))lt.deleteFile(i(Z.uri),Z.options,J(Z.annotationId));else if(ne.TextDocumentEdit.is(Z)){let on=i(Z.textDocument.uri);for(let sn of Z.edits)ne.AnnotatedTextEdit.is(sn)?lt.replace(on,b(sn.range),sn.newText,J(sn.annotationId)):lt.replace(on,b(sn.range),sn.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Z,void 0,4)}`)},_)}else if(u.changes){let it=u.changes;await Re.forEach(Object.keys(it),Z=>{lt.set(i(Z),vt(it[Z]))},_)}return lt}function F(u){if(u!==void 0)return{label:u.label,needsConfirmation:!!u.needsConfirmation,description:u.description}}function H(u){let _=b(u.range),j=u.target?o(u.target):void 0,J=new xD.default(_,j);return u.tooltip!==void 0&&(J.tooltip=u.tooltip),u.data!==void 0&&u.data!==null&&(J.data=u.data),J}async function V(u,_){if(!!u)return Re.map(u,H,_)}function he(u){return new W.Color(u.red,u.green,u.blue,u.alpha)}function ge(u){return new W.ColorInformation(b(u.range),he(u.color))}async function me(u,_){if(!!u)return Re.map(u,ge,_)}function qe(u){let _=new W.ColorPresentation(u.label);return _.additionalTextEdits=vt(u.additionalTextEdits),u.textEdit&&(_.textEdit=Dt(u.textEdit)),_}async function ue(u,_){if(!!u)return Re.map(u,qe,_)}function Ce(u){if(u)switch(u){case ne.FoldingRangeKind.Comment:return W.FoldingRangeKind.Comment;case ne.FoldingRangeKind.Imports:return W.FoldingRangeKind.Imports;case ne.FoldingRangeKind.Region:return W.FoldingRangeKind.Region}}function le(u){return new W.FoldingRange(u.startLine,u.endLine,Ce(u.kind))}async function p(u,_){if(!!u)return Re.map(u,le,_)}function E(u){return new W.SelectionRange(b(u.range),u.parent?E(u.parent):void 0)}async function z(u,_){return Array.isArray(u)?Re.map(u,E,_):[]}function S(u){return ne.InlineValueText.is(u)?new W.InlineValueText(b(u.range),u.text):ne.InlineValueVariableLookup.is(u)?new W.InlineValueVariableLookup(b(u.range),u.variableName,u.caseSensitiveLookup):new W.InlineValueEvaluatableExpression(b(u.range),u.expression)}async function f(u,_){return Array.isArray(u)?Re.map(u,S,_):[]}async function D(u,_){let j=typeof u.label=="string"?u.label:await Re.map(u.label,T,_),J=new ND.default(C(u.position),j);return u.kind!==void 0&&(J.kind=u.kind),u.textEdits!==void 0&&(J.textEdits=await ct(u.textEdits,_)),u.tooltip!==void 0&&(J.tooltip=v(u.tooltip)),u.paddingLeft!==void 0&&(J.paddingLeft=u.paddingLeft),u.paddingRight!==void 0&&(J.paddingRight=u.paddingRight),u.data!==void 0&&(J.data=u.data),J}function T(u){let _=new W.InlayHintLabelPart(u.value);return u.location!==void 0&&(_.location=Xe(u.location)),u.tooltip!==void 0&&(_.tooltip=v(u.tooltip)),u.command!==void 0&&(_.command=Qe(u.command)),_}function v(u){return typeof u=="string"?u:N(u)}async function d(u,_){if(!!Array.isArray(u))return Re.mapAsync(u,D,_)}function P(u){if(u===null)return;let _=new qD.default(Xt(u.kind),u.name,u.detail||"",o(u.uri),b(u.range),b(u.selectionRange),u.data);return u.tags!==void 0&&(_.tags=Mt(u.tags)),_}async function L(u,_){if(u!==null)return Re.map(u,P,_)}async function te(u,_){return new W.CallHierarchyIncomingCall(P(u.from),await x(u.fromRanges,_))}async function Pe(u,_){if(u!==null)return Re.mapAsync(u,te,_)}async function Ae(u,_){return new W.CallHierarchyOutgoingCall(P(u.to),await x(u.fromRanges,_))}async function Wt(u,_){if(u!==null)return Re.mapAsync(u,Ae,_)}async function zt(u,_){if(u!=null)return new W.SemanticTokens(new Uint32Array(u.data),u.resultId)}function Jt(u){return new W.SemanticTokensEdit(u.start,u.deleteCount,u.data!==void 0?new Uint32Array(u.data):void 0)}async function fe(u,_){if(u!=null)return new W.SemanticTokensEdits(u.edits.map(Jt),u.resultId)}function Yn(u){return u}async function $r(u,_){if(u!=null)return new W.LinkedEditingRanges(await x(u.ranges,_),so(u.wordPattern))}function so(u){if(u!=null)return new RegExp(u)}function Bl(u){if(u===null)return;let _=new OD.default(Xt(u.kind),u.name,u.detail||"",o(u.uri),b(u.range),b(u.selectionRange),u.data);return u.tags!==void 0&&(_.tags=Mt(u.tags)),_}async function gv(u,_){if(u!==null)return Re.map(u,Bl,_)}return{asUri:o,asDocumentSelector:s,asDiagnostics:a,asDiagnostic:l,asRange:b,asRanges:x,asPosition:C,asDiagnosticSeverity:q,asDiagnosticTag:h,asHover:$,asCompletionResult:K,asCompletionItem:rt,asTextEdit:Dt,asTextEdits:ct,asSignatureHelp:xn,asSignatureInformations:Le,asSignatureInformation:tt,asParameterInformations:ut,asParameterInformation:Nt,asDeclarationResult:dr,asDefinitionResult:Bn,asLocation:Xe,asReferences:qn,asDocumentHighlights:fr,asDocumentHighlight:Xn,asDocumentHighlightKind:Qn,asSymbolKind:Xt,asSymbolTag:Jn,asSymbolTags:Mt,asSymbolInformations:yt,asSymbolInformation:On,asDocumentSymbols:Cn,asDocumentSymbol:jt,asCommand:Qe,asCommands:pr,asCodeAction:In,asCodeActionKind:$t,asCodeActionKinds:wn,asCodeActionResult:Nn,asCodeLens:Ht,asCodeLenses:Qt,asWorkspaceEdit:R,asDocumentLink:H,asDocumentLinks:V,asFoldingRangeKind:Ce,asFoldingRange:le,asFoldingRanges:p,asColor:he,asColorInformation:ge,asColorInformations:me,asColorPresentation:qe,asColorPresentations:ue,asSelectionRange:E,asSelectionRanges:z,asInlineValue:S,asInlineValues:f,asInlayHint:D,asInlayHints:d,asSemanticTokensLegend:Yn,asSemanticTokens:zt,asSemanticTokensEdit:Jt,asSemanticTokensEdits:fe,asCallHierarchyItem:P,asCallHierarchyItems:L,asCallHierarchyIncomingCall:te,asCallHierarchyIncomingCalls:Pe,asCallHierarchyOutgoingCall:Ae,asCallHierarchyOutgoingCalls:Wt,asLinkedEditingRanges:$r,asTypeHierarchyItem:Bl,asTypeHierarchyItems:gv}}$o.createConverter=FD});var ii=k(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.generateUuid=nn.parse=nn.isUUID=nn.v4=nn.empty=void 0;var Vi=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},ce=class extends Vi{constructor(){super([ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),"-",ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),"-","4",ce._randomHex(),ce._randomHex(),ce._randomHex(),"-",ce._oneOf(ce._timeHighBits),ce._randomHex(),ce._randomHex(),ce._randomHex(),"-",ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex(),ce._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return ce._oneOf(ce._chars)}};ce._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];ce._timeHighBits=["8","9","a","b"];nn.empty=new Vi("00000000-0000-0000-0000-000000000000");function vh(){return new ce}nn.v4=vh;var LD=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function yh(n){return LD.test(n)}nn.isUUID=yh;function AD(n){if(!yh(n))throw new Error("invalid uuid");return new Vi(n)}nn.parse=AD;function MD(){return vh().asHex()}nn.generateUuid=MD});var Xc=k(Ho=>{"use strict";Object.defineProperty(Ho,"__esModule",{value:!0});Ho.ProgressPart=void 0;var Ch=require("vscode"),wh=Te(),Rh=Rn(),Gc=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(wh.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&Ch.window.withProgress({location:Ch.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(wh.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,o)=>{this._resolve=i,this._reject=o})})}report(e){if(this._infinite&&Rh.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(Rh.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};Ho.ProgressPart=Gc});var pt=k(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.BaseLanguageClient=xe.LSPCancellationError=xe.MessageTransports=xe.TextDocumentFeature=xe.State=xe.RevealOutputChannelOn=xe.DiagnosticPullMode=xe.CloseAction=xe.ErrorAction=void 0;var U=require("vscode"),w=Te(),jD=vc(),$D=ph(),HD=mh(),Se=Rn(),Qc=Lo(),_e=ii(),WD=Xc(),Jc=class{error(e){(0,w.RAL)().console.error(e)}warn(e){(0,w.RAL)().console.warn(e)}info(e){(0,w.RAL)().console.info(e)}log(e){(0,w.RAL)().console.log(e)}};function zD(n,e,t,r,i){let o=new Jc,s=(0,w.createProtocolConnection)(n,e,o,i);return s.onError(c=>{t(c[0],c[1],c[2])}),s.onClose(r),{listen:()=>s.listen(),sendRequest:(c,...l)=>s.sendRequest(c,...l),onRequest:(c,l)=>s.onRequest(c,l),sendNotification:(c,l)=>s.sendNotification(c,l),onNotification:(c,l)=>s.onNotification(c,l),onProgress:s.onProgress,sendProgress:s.sendProgress,trace:(c,l,g)=>{let m={sendNotification:!1,traceFormat:w.TraceFormat.Text};g===void 0?s.trace(c,l,m):(Se.boolean(g),s.trace(c,l,g))},initialize:c=>s.sendRequest(w.InitializeRequest.type,c),shutdown:()=>s.sendRequest(w.ShutdownRequest.type,void 0),exit:()=>s.sendNotification(w.ExitNotification.type),onLogMessage:c=>s.onNotification(w.LogMessageNotification.type,c),onShowMessage:c=>s.onNotification(w.ShowMessageNotification.type,c),onTelemetry:c=>s.onNotification(w.TelemetryEventNotification.type,c),didChangeConfiguration:c=>s.sendNotification(w.DidChangeConfigurationNotification.type,c),didChangeWatchedFiles:c=>s.sendNotification(w.DidChangeWatchedFilesNotification.type,c),didOpenTextDocument:c=>s.sendNotification(w.DidOpenTextDocumentNotification.type,c),didChangeTextDocument:c=>s.sendNotification(w.DidChangeTextDocumentNotification.type,c),didCloseTextDocument:c=>s.sendNotification(w.DidCloseTextDocumentNotification.type,c),didSaveTextDocument:c=>s.sendNotification(w.DidSaveTextDocumentNotification.type,c),onDiagnostics:c=>s.onNotification(w.PublishDiagnosticsNotification.type,c),end:()=>s.end(),dispose:()=>s.dispose()}}var zo;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(zo=xe.ErrorAction||(xe.ErrorAction={}));var kr;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(kr=xe.CloseAction||(xe.CloseAction={}));var Yc=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:zo.Continue}:{action:zo.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:kr.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:kr.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:kr.Restart})}},UD;(function(n){n.onType="onType",n.onSave="onSave"})(UD=xe.DiagnosticPullMode||(xe.DiagnosticPullMode={}));var Bi;(function(n){n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(Bi=xe.RevealOutputChannelOn||(xe.RevealOutputChannelOn={}));var Wo;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(Wo=xe.State||(xe.State={}));var Ne;(function(n){n[n.Initial=0]="Initial",n[n.Starting=1]="Starting",n[n.StartFailed=2]="StartFailed",n[n.Running=3]="Running",n[n.Stopping=4]="Stopping",n[n.Stopped=5]="Stopped"})(Ne||(Ne={}));var bh=[w.SymbolKind.File,w.SymbolKind.Module,w.SymbolKind.Namespace,w.SymbolKind.Package,w.SymbolKind.Class,w.SymbolKind.Method,w.SymbolKind.Property,w.SymbolKind.Field,w.SymbolKind.Constructor,w.SymbolKind.Enum,w.SymbolKind.Interface,w.SymbolKind.Function,w.SymbolKind.Variable,w.SymbolKind.Constant,w.SymbolKind.String,w.SymbolKind.Number,w.SymbolKind.Boolean,w.SymbolKind.Array,w.SymbolKind.Object,w.SymbolKind.Key,w.SymbolKind.Null,w.SymbolKind.EnumMember,w.SymbolKind.Struct,w.SymbolKind.Event,w.SymbolKind.Operator,w.SymbolKind.TypeParameter],KD=[w.CompletionItemKind.Text,w.CompletionItemKind.Method,w.CompletionItemKind.Function,w.CompletionItemKind.Constructor,w.CompletionItemKind.Field,w.CompletionItemKind.Variable,w.CompletionItemKind.Class,w.CompletionItemKind.Interface,w.CompletionItemKind.Module,w.CompletionItemKind.Property,w.CompletionItemKind.Unit,w.CompletionItemKind.Value,w.CompletionItemKind.Enum,w.CompletionItemKind.Keyword,w.CompletionItemKind.Snippet,w.CompletionItemKind.Color,w.CompletionItemKind.File,w.CompletionItemKind.Reference,w.CompletionItemKind.Folder,w.CompletionItemKind.EnumMember,w.CompletionItemKind.Constant,w.CompletionItemKind.Struct,w.CompletionItemKind.Event,w.CompletionItemKind.Operator,w.CompletionItemKind.TypeParameter],Dh=[w.SymbolTag.Deprecated];function X(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Gi;(function(n){function e(t){let r=U.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(Gi||(Gi={}));var Zc;(function(n){function e(t){let r=t;return r&&Se.func(r.register)&&Se.func(r.unregister)&&Se.func(r.dispose)&&r.registrationType!==void 0}n.is=e})(Zc||(Zc={}));var vn=class{constructor(e,t,r,i,o,s){this._client=e,this._event=t,this._type=r,this._middleware=i,this._createParams=o,this._selectorFilter=s,this._selectors=new Map,this._onNotificationSent=new U.EventEmitter}static textDocumentFilter(e,t){for(let r of e)if(U.languages.match(r,t))return!0;return!1}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i).catch(),this.notificationSent(r,this._type,i)};if(!this._selectorFilter||this._selectorFilter(this._selectors.values(),e))return this._middleware?this._middleware(e,r=>t(r)):t(e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({original:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(U.languages.match(t,e))return{send:r=>this.callback(r)}}},eu=class extends vn{constructor(e,t){super(e,U.workspace.onDidOpenTextDocument,w.DidOpenTextDocumentNotification.type,e.clientOptions.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),vn.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return w.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);U.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&U.languages.match(t,r)){let o=this._client.clientOptions.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));(o.didOpen?o.didOpen(r,s):s(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}notificationSent(e,t,r){super.notificationSent(e,t,r),this._syncedDocuments.set(e.uri.toString(),e)}},tu=class extends vn{constructor(e,t){super(e,U.workspace.onDidCloseTextDocument,w.DidCloseTextDocumentNotification.type,e.clientOptions.middleware.didClose,r=>e.code2ProtocolConverter.asCloseTextDocumentParams(r),vn.textDocumentFilter),this._syncedDocuments=t}get registrationType(){return w.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}notificationSent(e,t,r){super.notificationSent(e,t,r),this._syncedDocuments.delete(e.uri.toString())}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(U.languages.match(t,i)&&!this._selectorFilter(r,i)){let o=this._client.clientOptions.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(o.didClose?o.didClose(i,s):s(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}},nu=class{constructor(e){this._client=e,this._changeData=new Map,this._forcingDelivery=!1,this._onNotificationSent=new U.EventEmitter}get registrationType(){return w.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==w.TextDocumentSyncKind.None&&this.register({id:_e.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=U.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}))}async callback(e){if(e.contentChanges.length===0)return;let t=[];for(let r of this._changeData.values())if(U.languages.match(r.documentSelector,e.document)){let i=this._client.clientOptions.middleware;if(r.syncKind===w.TextDocumentSyncKind.Incremental){let o=async s=>{let a=this._client.code2ProtocolConverter.asChangeTextDocumentParams(s);await this._client.sendNotification(w.DidChangeTextDocumentNotification.type,a),this.notificationSent(s,w.DidChangeTextDocumentNotification.type,a)};t.push(i.didChange?i.didChange(e,s=>o(s)):o(e))}else if(r.syncKind===w.TextDocumentSyncKind.Full){let o=async s=>{let a=async c=>{let l=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c.document);await this._client.sendNotification(w.DidChangeTextDocumentNotification.type,l),this.notificationSent(c,w.DidChangeTextDocumentNotification.type,l)};return this._changeDelayer?(this._changeDelayer.uri!==s.document.uri.toString()&&(this.forceDelivery(),this._changeDelayer.uri=s.document.uri.toString()),this._changeDelayer.delayer.trigger(()=>a(s))):(this._changeDelayer={uri:s.document.uri.toString(),delayer:new Qc.Delayer(200)},this._changeDelayer.delayer.trigger(()=>a(s),-1))};t.push(i.didChange?i.didChange(e,s=>o(s)):o(e))}}return Promise.all(t).then(void 0,r=>{throw this._client.error(`Sending document notification ${w.DidChangeTextDocumentNotification.type.method} failed`,r),r})}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({original:e,type:t,params:r})}unregister(e){this._changeData.delete(e),this._changeData.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._changeDelayer!==void 0&&this._changeDelayer.delayer.cancel(),this._changeDelayer=void 0,this._forcingDelivery=!1,this._changeData.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}forceDelivery(){if(!(this._forcingDelivery||!this._changeDelayer))try{this._forcingDelivery=!0,this._changeDelayer.delayer.forceDelivery()}finally{this._forcingDelivery=!1}}getProvider(e){for(let t of this._changeData.values())if(U.languages.match(t.documentSelector,e))return{send:r=>this.callback(r)}}},ru=class extends vn{constructor(e){super(e,U.workspace.onWillSaveTextDocument,w.WillSaveTextDocumentNotification.type,e.clientOptions.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),(t,r)=>vn.textDocumentFilter(t,r.document))}get registrationType(){return w.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}},iu=class{constructor(e){this._client=e,this._selectors=new Map}get registrationType(){return w.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=U.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(vn.textDocumentFilter(this._selectors.values(),e.document)){let t=this._client.clientOptions.middleware,r=i=>this._client.sendRequest(w.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async o=>{let s=await this._client.protocol2CodeConverter.asTextEdits(o);return s===void 0?[]:s});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}},ou=class extends vn{constructor(e){super(e,U.workspace.onDidSaveTextDocument,w.DidSaveTextDocumentNotification.type,e.clientOptions.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),vn.textDocumentFilter),this._includeText=!1}get registrationType(){return w.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:_e.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}},su=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}get registrationType(){return w.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){X(X(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){if(!Se.string(r.globPattern))continue;let i=!0,o=!0,s=!0;r.kind!==void 0&&r.kind!==null&&(i=(r.kind&w.WatchKind.Create)!==0,o=(r.kind&w.WatchKind.Change)!==0,s=(r.kind&w.WatchKind.Delete)!==0);let a=U.workspace.createFileSystemWatcher(r.globPattern,!i,!o,!s);this.hookListeners(a,i,o,s),t.push(a)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,o){t&&e.onDidCreate(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:w.FileChangeType.Created}),null,o),r&&e.onDidChange(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:w.FileChangeType.Changed}),null,o),i&&e.onDidDelete(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:w.FileChangeType.Deleted}),null,o)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}},ft=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(w.TextDocumentRegistrationOptions.is(t)){let r=w.StaticRegistrationOptions.hasId(t)?t.id:_e.generateUuid(),i=t.documentSelector||e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(Se.boolean(t)&&t===!0||w.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=Se.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[_e.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return Se.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&U.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e))return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};xe.TextDocumentFeature=ft;var au=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}},cu=class extends ft{constructor(e){super(e,w.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[w.MarkupKind.Markdown,w.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[w.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[w.InsertTextMode.asIs,w.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=w.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:KD},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){var a;this.labelDetailsSupport.set(t,!!((a=e.completionItem)!=null&&a.labelDetailsSupport));let r=e.triggerCharacters??[],i=e.allCommitCharacters,o=e.documentSelector,s={provideCompletionItems:(c,l,g,m)=>{let h=this._client,C=this._client.clientOptions.middleware,b=(x,q,O,I)=>h.sendRequest(w.CompletionRequest.type,h.code2ProtocolConverter.asCompletionParams(x,q,O),I).then(N=>I.isCancellationRequested?null:h.protocol2CodeConverter.asCompletionResult(N,i,I),N=>h.handleFailedRequest(w.CompletionRequest.type,I,N,null));return C.provideCompletionItem?C.provideCompletionItem(c,l,m,g,b):b(c,l,m,g)},resolveCompletionItem:e.resolveProvider?(c,l)=>{let g=this._client,m=this._client.clientOptions.middleware,h=(C,b)=>g.sendRequest(w.CompletionResolveRequest.type,g.code2ProtocolConverter.asCompletionItem(C,!!this.labelDetailsSupport.get(t)),b).then(x=>b.isCancellationRequested?null:g.protocol2CodeConverter.asCompletionItem(x),x=>g.handleFailedRequest(w.CompletionResolveRequest.type,b,x,C));return m.resolveCompletionItem?m.resolveCompletionItem(c,l,h):h(c,l)}:void 0};return[U.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...r),s]}},uu=class extends ft{constructor(e){super(e,w.HoverRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[w.MarkupKind.Markdown,w.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,o,s)=>{let a=this._client,c=(g,m,h)=>a.sendRequest(w.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,m),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asHover(C),C=>a.handleFailedRequest(w.HoverRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideHover?l.provideHover(i,o,s,c):c(i,o,s)}};return[U.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},lu=class extends ft{constructor(e){super(e,w.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[w.MarkupKind.Markdown,w.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSignatureHelp:(s,a,c,l)=>{let g=this._client,m=(C,b,x,q)=>g.sendRequest(w.SignatureHelpRequest.type,g.code2ProtocolConverter.asSignatureHelpParams(C,b,x),q).then(O=>q.isCancellationRequested?null:g.protocol2CodeConverter.asSignatureHelp(O,q),O=>g.handleFailedRequest(w.SignatureHelpRequest.type,q,O,null)),h=g.clientOptions.middleware;return h.provideSignatureHelp?h.provideSignatureHelp(s,a,l,c,m):m(s,a,l,c)}},i,o=this._client.protocol2CodeConverter.asDocumentSelector(t);if(e.retriggerCharacters===void 0){let s=e.triggerCharacters||[];i=U.languages.registerSignatureHelpProvider(o,r,...s)}else{let s={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};i=U.languages.registerSignatureHelpProvider(o,r,s)}return[i,r]}},du=class extends ft{constructor(e){super(e,w.DefinitionRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,o,s)=>{let a=this._client,c=(g,m,h)=>a.sendRequest(w.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,m),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,h),C=>a.handleFailedRequest(w.DefinitionRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideDefinition?l.provideDefinition(i,o,s,c):c(i,o,s)}};return[U.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},fu=class extends ft{constructor(e){super(e,w.ReferencesRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,o,s,a)=>{let c=this._client,l=(m,h,C,b)=>c.sendRequest(w.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(m,h,C),b).then(x=>b.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(x,b),x=>c.handleFailedRequest(w.ReferencesRequest.type,b,x,null)),g=c.clientOptions.middleware;return g.provideReferences?g.provideReferences(i,o,s,a,l):l(i,o,s,a)}};return[U.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},pu=class extends ft{constructor(e){super(e,w.DocumentHighlightRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,o,s)=>{let a=this._client,c=(g,m,h)=>a.sendRequest(w.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,m),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(C,h),C=>a.handleFailedRequest(w.DocumentHighlightRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideDocumentHighlights?l.provideDocumentHighlights(i,o,s,c):c(i,o,s)}};return[U.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},hu=class extends ft{constructor(e){super(e,w.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:bh},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:Dh},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(o,s)=>{let a=this._client,c=(g,m)=>a.sendRequest(w.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(g),m).then(async h=>{if(m.isCancellationRequested||h===void 0||h===null)return null;if(h.length===0)return[];{let C=h[0];return w.DocumentSymbol.is(C)?await a.protocol2CodeConverter.asDocumentSymbols(h,m):await a.protocol2CodeConverter.asSymbolInformations(h,m)}},h=>a.handleFailedRequest(w.DocumentSymbolRequest.type,m,h,null)),l=a.clientOptions.middleware;return l.provideDocumentSymbols?l.provideDocumentSymbols(o,s,c):c(o,s)}},i=e.label!==void 0?{label:e.label}:void 0;return[U.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}},gu=class extends au{constructor(e){super(e,w.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=X(X(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:bh},t.tagSupport={valueSet:Dh},t.resolveSupport={properties:["location.range"]}}initialize(e){!e.workspaceSymbolProvider||this.register({id:_e.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let o=this._client,s=(c,l)=>o.sendRequest(w.WorkspaceSymbolRequest.type,{query:c},l).then(g=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformations(g,l),g=>o.handleFailedRequest(w.WorkspaceSymbolRequest.type,l,g,null)),a=o.clientOptions.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,s):s(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let o=this._client,s=(c,l)=>o.sendRequest(w.WorkspaceSymbolResolveRequest.type,o.code2ProtocolConverter.asWorkspaceSymbol(c),l).then(g=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformation(g),g=>o.handleFailedRequest(w.WorkspaceSymbolResolveRequest.type,l,g,null)),a=o.clientOptions.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,s):s(r,i)}:void 0};return[U.languages.registerWorkspaceSymbolProvider(t),t]}},mu=class extends ft{constructor(e){super(e,w.CodeActionRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[w.CodeActionKind.Empty,w.CodeActionKind.QuickFix,w.CodeActionKind.Refactor,w.CodeActionKind.RefactorExtract,w.CodeActionKind.RefactorInline,w.CodeActionKind.RefactorRewrite,w.CodeActionKind.Source,w.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!1}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,o,s,a)=>{let c=this._client,l=async(m,h,C,b)=>{let x={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),range:c.code2ProtocolConverter.asRange(h),context:await c.code2ProtocolConverter.asCodeActionContext(C,b)};return c.sendRequest(w.CodeActionRequest.type,x,b).then(q=>b.isCancellationRequested||q===null||q===void 0?null:c.protocol2CodeConverter.asCodeActionResult(q,b),q=>c.handleFailedRequest(w.CodeActionRequest.type,b,q,null))},g=c.clientOptions.middleware;return g.provideCodeActions?g.provideCodeActions(i,o,s,a,l):l(i,o,s,a)},resolveCodeAction:e.resolveProvider?(i,o)=>{let s=this._client,a=this._client.clientOptions.middleware,c=async(l,g)=>s.sendRequest(w.CodeActionResolveRequest.type,await s.code2ProtocolConverter.asCodeAction(l,g),g).then(m=>g.isCancellationRequested?l:s.protocol2CodeConverter.asCodeAction(m,g),m=>s.handleFailedRequest(w.CodeActionResolveRequest.type,g,m,l));return a.resolveCodeAction?a.resolveCodeAction(i,o,c):c(i,o)}:void 0};return[U.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}},vu=class extends ft{constructor(e){super(e,w.CodeLensRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"codeLens").dynamicRegistration=!0,X(X(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(w.CodeLensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);!i||this.register({id:_e.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new U.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(o,s)=>{let a=this._client,c=(g,m)=>a.sendRequest(w.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(g),m).then(h=>m.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(h,m),h=>a.handleFailedRequest(w.CodeLensRequest.type,m,h,null)),l=a.clientOptions.middleware;return l.provideCodeLenses?l.provideCodeLenses(o,s,c):c(o,s)},resolveCodeLens:e.resolveProvider?(o,s)=>{let a=this._client,c=(g,m)=>a.sendRequest(w.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(g),m).then(h=>m.isCancellationRequested?g:a.protocol2CodeConverter.asCodeLens(h),h=>a.handleFailedRequest(w.CodeLensResolveRequest.type,m,h,g)),l=a.clientOptions.middleware;return l.resolveCodeLens?l.resolveCodeLens(o,s,c):c(o,s)}:void 0};return[U.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}},yu=class extends ft{constructor(e){super(e,w.DocumentFormattingRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,o,s)=>{let a=this._client,c=(g,m,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g),options:a.code2ProtocolConverter.asFormattingOptions(m,Gi.fromConfiguration(g))};return a.sendRequest(w.DocumentFormattingRequest.type,C,h).then(b=>h.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(b,h),b=>a.handleFailedRequest(w.DocumentFormattingRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideDocumentFormattingEdits?l.provideDocumentFormattingEdits(i,o,s,c):c(i,o,s)}};return[U.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Cu=class extends ft{constructor(e){super(e,w.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,o,s,a)=>{let c=this._client,l=(m,h,C,b)=>{let x={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),range:c.code2ProtocolConverter.asRange(h),options:c.code2ProtocolConverter.asFormattingOptions(C,Gi.fromConfiguration(m))};return c.sendRequest(w.DocumentRangeFormattingRequest.type,x,b).then(q=>b.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(q,b),q=>c.handleFailedRequest(w.DocumentRangeFormattingRequest.type,b,q,null))},g=c.clientOptions.middleware;return g.provideDocumentRangeFormattingEdits?g.provideDocumentRangeFormattingEdits(i,o,s,a,l):l(i,o,s,a)}};return[U.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},wu=class extends ft{constructor(e){super(e,w.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(o,s,a,c,l)=>{let g=this._client,m=(C,b,x,q,O)=>{let I={textDocument:g.code2ProtocolConverter.asTextDocumentIdentifier(C),position:g.code2ProtocolConverter.asPosition(b),ch:x,options:g.code2ProtocolConverter.asFormattingOptions(q,Gi.fromConfiguration(C))};return g.sendRequest(w.DocumentOnTypeFormattingRequest.type,I,O).then(N=>O.isCancellationRequested?null:g.protocol2CodeConverter.asTextEdits(N,O),N=>g.handleFailedRequest(w.DocumentOnTypeFormattingRequest.type,O,N,null))},h=g.clientOptions.middleware;return h.provideOnTypeFormattingEdits?h.provideOnTypeFormattingEdits(o,s,a,c,l,m):m(o,s,a,c,l)}},i=e.moreTriggerCharacter||[];return[U.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}},Ru=class extends ft{constructor(e){super(e,w.RenameRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=w.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);!r||(Se.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:_e.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,o,s,a)=>{let c=this._client,l=(m,h,C,b)=>{let x={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),position:c.code2ProtocolConverter.asPosition(h),newName:C};return c.sendRequest(w.RenameRequest.type,x,b).then(q=>b.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(q,b),q=>c.handleFailedRequest(w.RenameRequest.type,b,q,null,!1))},g=c.clientOptions.middleware;return g.provideRenameEdits?g.provideRenameEdits(i,o,s,a,l):l(i,o,s,a)},prepareRename:e.prepareProvider?(i,o,s)=>{let a=this._client,c=(g,m,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g),position:a.code2ProtocolConverter.asPosition(m)};return a.sendRequest(w.PrepareRenameRequest.type,C,h).then(b=>h.isCancellationRequested?null:w.Range.is(b)?a.protocol2CodeConverter.asRange(b):this.isDefaultBehavior(b)?b.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):b&&w.Range.is(b.range)?{range:a.protocol2CodeConverter.asRange(b.range),placeholder:b.placeholder}:Promise.reject(new Error("The element can't be renamed.")),b=>{throw typeof b.message=="string"?new Error(b.message):new Error("The element can't be renamed.")})},l=a.clientOptions.middleware;return l.prepareRename?l.prepareRename(i,o,s,c):c(i,o,s)}:void 0};return[U.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}isDefaultBehavior(e){let t=e;return t&&Se.boolean(t.defaultBehavior)}},bu=class extends ft{constructor(e){super(e,w.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,o)=>{let s=this._client,a=(l,g)=>s.sendRequest(w.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(l),g).then(m=>g.isCancellationRequested?null:s.protocol2CodeConverter.asDocumentLinks(m,g),m=>s.handleFailedRequest(w.DocumentLinkRequest.type,g,m,null)),c=s.clientOptions.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(i,o,a):a(i,o)},resolveDocumentLink:e.resolveProvider?(i,o)=>{let s=this._client,a=(l,g)=>s.sendRequest(w.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(l),g).then(m=>g.isCancellationRequested?l:s.protocol2CodeConverter.asDocumentLink(m),m=>s.handleFailedRequest(w.DocumentLinkResolveRequest.type,g,m,l)),c=s.clientOptions.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(i,o,a):a(i,o)}:void 0};return[U.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Du=class{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return w.DidChangeConfigurationNotification.type}fillClientCapabilities(e){X(X(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let e=this._client.clientOptions.synchronize.configurationSection;e!==void 0&&this.register({id:_e.generateUuid(),registerOptions:{section:e}})}register(e){let t=U.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}onDidChangeConfiguration(e,t){let r;if(Se.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(a=>t.affectsConfiguration(a)))return;let i=async s=>s===void 0?this._client.sendNotification(w.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(w.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(s)}),o=this.getMiddleware();(o?o(r,i):i(r)).catch(s=>{this._client.error(`Sending notification ${w.DidChangeConfigurationNotification.type.method} failed`,s)})}extractSettingsInformation(e){function t(o,s){let a=o;for(let c=0;c<s.length-1;c++){let l=a[s[c]];l||(l=Object.create(null),a[s[c]]=l),a=l}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let o=0;o<e.length;o++){let s=e[o],a=s.indexOf("."),c=null;if(a>=0?c=U.workspace.getConfiguration(s.substr(0,a),r).get(s.substr(a+1)):c=U.workspace.getConfiguration(void 0,r).get(s),c){let l=e[o].split(".");t(i,l)[l[l.length-1]]=(0,jD.toJSONObject)(c)}}return i}getMiddleware(){let e=this._client.clientOptions.middleware;if(e.workspace&&e.workspace.didChangeConfiguration)return e.workspace.didChangeConfiguration}},Tu=class{constructor(e){this._client=e,this._commands=new Map}get registrationType(){return w.ExecuteCommandRequest.type}fillClientCapabilities(e){X(X(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){!e.executeCommandProvider||this.register({id:_e.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.clientOptions.middleware,i=(o,s)=>{let a={command:o,arguments:s};return t.sendRequest(w.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(w.ExecuteCommandRequest.type,void 0,c,void 0))};if(e.registerOptions.commands){let o=[];for(let s of e.registerOptions.commands)o.push(U.commands.registerCommand(s,(...a)=>r.executeCommand?r.executeCommand(s,a,i):i(s,a)));this._commands.set(e.id,o)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}},VD;(function(n){function e(t){return t&&w.MessageReader.is(t.reader)&&w.MessageWriter.is(t.writer)}n.is=e})(VD=xe.MessageTransports||(xe.MessageTransports={}));var Uo=class{constructor(e,t){this._resolve=e,this._reject=t,this._used=!1}get isUsed(){return this._used}resolve(){this._used=!0,this._resolve()}reject(e){this._used=!0,this._reject(e)}},Ko=class extends U.CancellationError{constructor(e){super(),this.data=e}};xe.LSPCancellationError=Ko;var qr=class{constructor(e,t,r){var o;this._traceFormat=w.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new Qc.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=r.markdown.isTrusted===!0,i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??Bi.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler((o=r.connectionOptions)==null?void 0:o.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=Ne.Initial,this._connectionPromise=void 0,this._resolvedConnection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._listeners=void 0,this._providers=void 0,this._diagnostics=void 0,this._fileEvents=[],this._fileEventDelayer=new Qc.Delayer(250),this._onReady=new Promise((s,a)=>{this._onReadyCallbacks=new Uo(s,a)}),this._onStop=void 0,this._telemetryEmitter=new w.Emitter,this._stateChangeEmitter=new w.Emitter,this._trace=w.Trace.Off,this._tracer={log:(s,a)=>{Se.string(s)?this.logTrace(s,a):this.logObjectTrace(s)}},this._c2p=$D.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=HD.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get state(){return this._state}set state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){return this.state===Ne.Running?Wo.Running:this.state===Ne.Starting?Wo.Starting:Wo.Stopped}get initializeResult(){return this._initializeResult}sendRequest(e,...t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);this.forceDocumentSync();try{return this._resolvedConnection.sendRequest(e,...t)}catch(r){throw this.error(`Sending request ${Se.string(e)?e:e.method} failed.`,r),r}}onRequest(e,t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);try{return this._resolvedConnection.onRequest(e,t)}catch(r){throw this.error(`Registering request handler ${Se.string(e)?e:e.method} failed.`,r),r}}sendNotification(e,t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);this.forceDocumentSync();try{return this._resolvedConnection.sendNotification(e,t)}catch(r){throw this.error(`Sending notification ${Se.string(e)?e:e.method} failed.`,r),r}}onNotification(e,t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);try{return this._resolvedConnection.onNotification(e,t)}catch(r){throw this.error(`Registering notification handler ${Se.string(e)?e:e.method} failed.`,r),r}}onProgress(e,t,r){if(!this.isConnectionActive())throw new Error("Language client is not ready yet when trying to send progress");try{if(w.WorkDoneProgress.is(e)){let i=this._clientOptions.middleware.handleWorkDoneProgress;if(i!==void 0)return this._resolvedConnection.onProgress(e,t,o=>{i(t,o,()=>r(o))})}return this._resolvedConnection.onProgress(e,t,r)}catch(i){throw this.error(`Registering progress handler for token ${t} failed.`,i),i}}sendProgress(e,t,r){if(!this.isConnectionActive())throw new Error("Language client is not ready yet when trying to send progress");return this.forceDocumentSync(),this._resolvedConnection.sendProgress(e,t,r).then(void 0,i=>{throw this.error(`Sending progress for token ${t} failed.`,i),i})}get name(){return this._name}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=U.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new Yc(this,e??4)}set trace(e){this._trace=e,this.onReady().then(()=>{this.resolveConnection().then(t=>{t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})},()=>this.info("Setting trace value failed",void 0,!1))},()=>{})}data2String(e){if(e instanceof w.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?Se.string(e.stack)?e.stack:e.message:Se.string(e)?e:e.toString()}info(e,t,r=!0){this.outputChannel.appendLine(`[Info  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Bi.Info&&this.showNotificationMessage(w.MessageType.Info,e)}warn(e,t,r=!0){this.outputChannel.appendLine(`[Warn  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Bi.Warn&&this.showNotificationMessage(w.MessageType.Warning,e)}error(e,t,r=!0){this.outputChannel.appendLine(`[Error - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),(r==="force"||r&&this._clientOptions.revealOutputChannelOn<=Bi.Error)&&this.showNotificationMessage(w.MessageType.Error,e)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===w.MessageType.Error?U.window.showErrorMessage:e===w.MessageType.Warning?U.window.showWarningMessage:U.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.state===Ne.Initial||this.state===Ne.Stopping||this.state===Ne.Stopped}needsStop(){return this.state===Ne.Starting||this.state===Ne.Running}onReady(){return this._onReady}isConnectionActive(){return this.state===Ne.Running&&!!this._resolvedConnection}start(){return this._onReadyCallbacks.isUsed&&(this._onReady=new Promise((e,t)=>{this._onReadyCallbacks=new Uo(e,t)})),this._listeners=[],this._providers=[],this._diagnostics||(this._diagnostics=this._clientOptions.diagnosticCollectionName?U.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):U.languages.createDiagnosticCollection()),this.state=Ne.Starting,this.resolveConnection().then(e=>(e.onLogMessage(t=>{switch(t.type){case w.MessageType.Error:this.error(t.message,void 0,!1);break;case w.MessageType.Warning:this.warn(t.message,void 0,!1);break;case w.MessageType.Info:this.info(t.message,void 0,!1);break;default:this.outputChannel.appendLine(t.message)}}),e.onShowMessage(t=>{switch(t.type){case w.MessageType.Error:U.window.showErrorMessage(t.message);break;case w.MessageType.Warning:U.window.showWarningMessage(t.message);break;case w.MessageType.Info:U.window.showInformationMessage(t.message);break;default:U.window.showInformationMessage(t.message)}}),e.onRequest(w.ShowMessageRequest.type,t=>{let r;switch(t.type){case w.MessageType.Error:r=U.window.showErrorMessage;break;case w.MessageType.Warning:r=U.window.showWarningMessage;break;case w.MessageType.Info:r=U.window.showInformationMessage;break;default:r=U.window.showInformationMessage}let i=t.actions||[];return r(t.message,...i)}),e.onTelemetry(t=>{this._telemetryEmitter.fire(t)}),e.onRequest(w.ShowDocumentRequest.type,async t=>{var o;let r=async s=>{let a=this.protocol2CodeConverter.asUri(s.uri);try{if(s.external===!0)return{success:await U.env.openExternal(a)};{let c={};return s.selection!==void 0&&(c.selection=this.protocol2CodeConverter.asRange(s.selection)),s.takeFocus===void 0||s.takeFocus===!1?c.preserveFocus=!0:s.takeFocus===!0&&(c.preserveFocus=!1),await U.window.showTextDocument(a,c),{success:!0}}}catch{return{success:!0}}},i=(o=this._clientOptions.middleware.window)==null?void 0:o.showDocument;return i!==void 0?i(t,r):r(t)}),e.listen(),this.initialize(e))).catch(e=>{this.state=Ne.StartFailed,this._onReadyCallbacks.reject(e),this.error(`${this._name} client: couldn't create connection to server`,e,"force")}),new U.Disposable(()=>{this.needsStop()&&this.stop().catch(e=>{this.error("Stopping server failed.",e,!1)})})}resolveConnection(){return this._connectionPromise||(this._connectionPromise=this.createConnection()),this._connectionPromise}initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],o={processId:null,clientInfo:{name:U.env.appName,version:U.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(U.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:Se.func(t)?t():t,trace:w.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(o),this._clientOptions.progressOnInitialization){let s=_e.generateUuid(),a=new WD.ProgressPart(e,s);return o.workDoneToken=s,this.doInitialize(e,o).then(c=>(a.done(),c),c=>{throw a.cancel(),c})}else return this.doInitialize(e,o)}doInitialize(e,t){return e.initialize(t).then(r=>{this._resolvedConnection=e,this._initializeResult=r,this.state=Ne.Running;let i;return Se.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===w.TextDocumentSyncKind.None?i={openClose:!1,change:w.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onDiagnostics(o=>this.handleDiagnostics(o)),e.onRequest(w.RegistrationRequest.type,o=>this.handleRegistrationRequest(o)),e.onRequest("client/registerFeature",o=>this.handleRegistrationRequest(o)),e.onRequest(w.UnregistrationRequest.type,o=>this.handleUnregistrationRequest(o)),e.onRequest("client/unregisterFeature",o=>this.handleUnregistrationRequest(o)),e.onRequest(w.ApplyWorkspaceEditRequest.type,o=>this.handleApplyWorkspaceEdit(o)),e.sendNotification(w.InitializedNotification.type,{}).then(()=>(this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),this._onReadyCallbacks.resolve(),r))}).then(void 0,r=>{throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(r)):r instanceof w.ResponseError&&r.data&&r.data.retry?U.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(r))}):(r&&r.message&&U.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop(),this._onReadyCallbacks.reject(r)),r})}_clientGetRootPath(){let e=U.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}async stop(e=2e3){if(await this.onReady(),this._initializeResult=void 0,!this._connectionPromise)return this.state=Ne.Stopped,Promise.resolve();if(this.state===Ne.Stopping&&this._onStop)return this._onStop;this.state=Ne.Stopping,this.cleanUp(!1);let t=new Promise(i=>{(0,w.RAL)().timer.setTimeout(i,e)}),r=this.resolveConnection().then(i=>i.shutdown().then(()=>i.exit().then(()=>i)));return this._onStop=Promise.race([t,r]).then(i=>{if(i!==void 0)i.end(),i.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},i=>{throw this.error("Stopping server failed",i,!1),i}).finally(()=>{this.state=Ne.Stopped,this.cleanUpChannel(),this._onStop=void 0,this._connectionPromise=void 0,this._resolvedConnection=void 0})}cleanUp(e=!0,t=!0){this._fileEvents=[],this._fileEventDelayer.cancel(),this._listeners&&(this._listeners.forEach(r=>r.dispose()),this._listeners=void 0),this._providers&&(this._providers.forEach(r=>r.dispose()),this._providers=void 0),this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.dispose();e&&this.cleanUpChannel(),t&&this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0)}cleanUpChannel(){this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var o;let t=this;async function r(s){return t._fileEvents.push(s),t._fileEventDelayer.trigger(async()=>{await t.onReady();let a=await t.resolveConnection(),c=Promise.resolve();return t.isConnectionActive()&&(t.forceDocumentSync(),c=a.didChangeWatchedFiles({changes:t._fileEvents})),t._fileEvents=[],c})}let i=(o=this.clientOptions.middleware)==null?void 0:o.workspace;(i!=null&&i.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(s=>{t.error("Notify file events failed.",s)})}forceDocumentSync(){this._didChangeTextDocumentFeature===void 0&&(this._didChangeTextDocumentFeature=this._dynamicFeatures.get(w.DidChangeTextDocumentNotification.type.method)),this._didChangeTextDocumentFeature.forceDelivery()}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,w.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new U.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(o=>{if(!i.token.isCancellationRequested){let s=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(s,o,(c,l)=>this.setDiagnostics(c,l)):this.setDiagnostics(s,o)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){!this._diagnostics||this._diagnostics.set(e,t)}createConnection(){let e=(r,i,o)=>{this.handleConnectionError(r,i,o)},t=()=>{this.handleConnectionClosed()};return this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8").then(r=>zD(r.reader,r.writer,e,t,this._clientOptions.connectionOptions))}handleConnectionClosed(){if(this.state===Ne.Stopped)return;try{this._resolvedConnection&&this._resolvedConnection.dispose()}catch{}let e={action:kr.DoNotRestart};if(this.state!==Ne.Stopping)try{e=this._clientOptions.errorHandler.closed()}catch{}this._connectionPromise=void 0,this._resolvedConnection=void 0,e.action===kr.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,"force"),this.state===Ne.Starting?(this._onReadyCallbacks.reject(new Error("Connection to server got closed. Server will not be restarted.")),this.state=Ne.StartFailed):this.state=Ne.Stopped,this.cleanUp(!1,!0)):e.action===kr.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart."),this.cleanUp(!1,!1),this.state=Ne.Initial,this.start())}handleConnectionError(e,t,r){let i=this._clientOptions.errorHandler.error(e,t,r);i.action===zo.Shutdown&&(this.error(i.message??`Client ${this._name}: connection to server is erroring. Shutting down server.`,void 0,"force"),this.stop().catch(o=>{this.error("Stopping server failed",o,!1)}))}hookConfigurationChanged(e){U.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)})}refreshTrace(e,t=!1){let r=U.workspace.getConfiguration(this._id),i=w.Trace.Off,o=w.TraceFormat.Text;if(r){let s=r.get("trace.server","off");typeof s=="string"?i=w.Trace.fromString(s):(i=w.Trace.fromString(r.get("trace.server.verbosity","off")),o=w.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;Se.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get(w.DidChangeWatchedFilesNotification.type.method).registerRaw(_e.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),Zc.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}registerBuiltinFeatures(){this.registerFeature(new Du(this)),this.registerFeature(new eu(this,this._syncedDocuments)),this.registerFeature(new nu(this)),this.registerFeature(new ru(this)),this.registerFeature(new iu(this)),this.registerFeature(new ou(this)),this.registerFeature(new tu(this,this._syncedDocuments)),this.registerFeature(new su(this,e=>this.notifyFileEvent(e))),this.registerFeature(new cu(this)),this.registerFeature(new uu(this)),this.registerFeature(new lu(this)),this.registerFeature(new du(this)),this.registerFeature(new fu(this)),this.registerFeature(new pu(this)),this.registerFeature(new hu(this)),this.registerFeature(new gu(this)),this.registerFeature(new mu(this)),this.registerFeature(new vu(this)),this.registerFeature(new yu(this)),this.registerFeature(new Cu(this)),this.registerFeature(new wu(this)),this.registerFeature(new Ru(this)),this.registerFeature(new bu(this)),this.registerFeature(new Tu(this))}fillInitializeParams(e){for(let t of this._features)Se.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};X(e,"workspace").applyEdit=!0;let t=X(X(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[w.ResourceOperationKind.Create,w.ResourceOperationKind.Rename,w.ResourceOperationKind.Delete],t.failureHandling=w.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=X(X(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[w.DiagnosticTag.Unnecessary,w.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=X(e,"window"),o=X(i,"showMessage");o.messageActionItem={additionalPropertiesSupport:!0};let s=X(i,"showDocument");s.support=!0;let a=X(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(qr.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)r.initialize(this._capabilities,t)}handleRegistrationRequest(e){return new Promise((t,r)=>{for(let i of e.registrations){let o=this._dynamicFeatures.get(i.method);if(o===void 0){r(new Error(`No feature implementation for ${i.method} found. Registration failed.`));return}let s=i.registerOptions??{};s.documentSelector=s.documentSelector??this._clientOptions.documentSelector;let a={id:i.id,registerOptions:s};try{o.register(a)}catch(c){r(c);return}}t()})}handleUnregistrationRequest(e){return new Promise((t,r)=>{for(let i of e.unregisterations){let o=this._dynamicFeatures.get(i.method);if(!o){r(new Error(`No feature implementation for ${i.method} found. Unregistration failed.`));return}o.unregister(i.id)}t()})}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;U.workspace.textDocuments.forEach(s=>i.set(s.uri.toString(),s));let o=!1;if(t.documentChanges){for(let s of t.documentChanges)if(w.TextDocumentEdit.is(s)&&s.textDocument.version&&s.textDocument.version>=0){let a=i.get(s.textDocument.uri);if(a&&a.version!==s.textDocument.version){o=!0;break}}}return o?Promise.resolve({applied:!1}):Se.asPromise(U.workspace.applyEdit(r).then(s=>({applied:s})))}handleFailedRequest(e,t,r,i,o=!0){if(r instanceof w.ResponseError){if(r.code===w.LSPErrorCodes.RequestCancelled||r.code===w.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new Ko(r.data):new U.CancellationError}else if(r.code===w.LSPErrorCodes.ContentModified){if(qr.RequestsToCancelOnContentModified.has(e.method))throw new U.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,o),r}};xe.BaseLanguageClient=qr;qr.RequestsToCancelOnContentModified=new Set([w.SemanticTokensRequest.method,w.SemanticTokensRangeRequest.method,w.SemanticTokensDeltaRequest.method])});var Sh=k(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.ColorProviderFeature=void 0;var BD=require("vscode"),Xi=Te(),GD=pt();function Th(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Su=class extends GD.TextDocumentFeature{constructor(e){super(e,Xi.DocumentColorRequest.type)}fillClientCapabilities(e){Th(Th(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,o,s)=>{let a=this._client,c=(g,m,h)=>{let C={color:g,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(m.document),range:a.code2ProtocolConverter.asRange(m.range)};return a.sendRequest(Xi.ColorPresentationRequest.type,C,h).then(b=>h.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(b,h),b=>a.handleFailedRequest(Xi.ColorPresentationRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideColorPresentations?l.provideColorPresentations(i,o,s,c):c(i,o,s)},provideDocumentColors:(i,o)=>{let s=this._client,a=(l,g)=>{let m={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(l)};return s.sendRequest(Xi.DocumentColorRequest.type,m,g).then(h=>g.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(h,g),h=>s.handleFailedRequest(Xi.ColorPresentationRequest.type,g,h,null))},c=s.clientOptions.middleware;return c.provideDocumentColors?c.provideDocumentColors(i,o,a):a(i,o)}};return[BD.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Vo.ColorProviderFeature=Su});var Ph=k(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.ImplementationFeature=void 0;var XD=require("vscode"),_u=Te(),QD=pt();function _h(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Pu=class extends QD.TextDocumentFeature{constructor(e){super(e,_u.ImplementationRequest.type)}fillClientCapabilities(e){let t=_h(_h(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,o,s)=>{let a=this._client,c=(g,m,h)=>a.sendRequest(_u.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,m),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,h),C=>a.handleFailedRequest(_u.ImplementationRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideImplementation?l.provideImplementation(i,o,s,c):c(i,o,s)}};return[XD.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Bo.ImplementationFeature=Pu});var Eh=k(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.TypeDefinitionFeature=void 0;var JD=require("vscode"),Eu=Te(),YD=pt();function Go(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var xu=class extends YD.TextDocumentFeature{constructor(e){super(e,Eu.TypeDefinitionRequest.type)}fillClientCapabilities(e){Go(Go(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=Go(Go(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,o,s)=>{let a=this._client,c=(g,m,h)=>a.sendRequest(Eu.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,m),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,h),C=>a.handleFailedRequest(Eu.TypeDefinitionRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideTypeDefinition?l.provideTypeDefinition(i,o,s,c):c(i,o,s)}};return[JD.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Xo.TypeDefinitionFeature=xu});var xh=k(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.WorkspaceFoldersFeature=oi.arrayDiff=void 0;var ZD=ii(),Qo=require("vscode"),Qi=Te();function ku(n,e){if(n!==void 0)return n[e]}function qu(n,e){return n.filter(t=>e.indexOf(t)<0)}oi.arrayDiff=qu;var Ou=class{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return Qi.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=Qo.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(Qi.WorkspaceFoldersRequest.type,o=>{let s=()=>{let c=Qo.workspace.workspaceFolders;return c===void 0?null:c.map(g=>this.asProtocol(g))},a=t.clientOptions.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(o,s):s(o)});let r=ku(ku(ku(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=ZD.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=qu(this._initialFolders,e),i=qu(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${Qi.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(Qi.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=Qo.workspace.onDidChangeWorkspaceFolders(o=>{let s=l=>this.doSendEvent(l.added,l.removed),a=r.clientOptions.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(o,s):s(o)).catch(l=>{this._client.error(`Sending notification ${Qi.DidChangeWorkspaceFoldersNotification.type.method} failed`,l)})});this._listeners.set(t,i),this.sendInitialEvent(Qo.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};oi.WorkspaceFoldersFeature=Ou});var qh=k(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:!0});Jo.FoldingRangeFeature=void 0;var eT=require("vscode"),Iu=Te(),tT=pt();function kh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Nu=class extends tT.TextDocumentFeature{constructor(e){super(e,Iu.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=kh(kh(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideFoldingRanges:(i,o,s)=>{let a=this._client,c=(g,m,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g)};return a.sendRequest(Iu.FoldingRangeRequest.type,C,h).then(b=>h.isCancellationRequested?null:a.protocol2CodeConverter.asFoldingRanges(b,h),b=>a.handleFailedRequest(Iu.FoldingRangeRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideFoldingRanges?l.provideFoldingRanges(i,o,s,c):c(i,o,s)}};return[eT.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Jo.FoldingRangeFeature=Nu});var Ih=k(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.DeclarationFeature=void 0;var nT=require("vscode"),Fu=Te(),rT=pt();function Oh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Lu=class extends rT.TextDocumentFeature{constructor(e){super(e,Fu.DeclarationRequest.type)}fillClientCapabilities(e){let t=Oh(Oh(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,o,s)=>{let a=this._client,c=(g,m,h)=>a.sendRequest(Fu.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,m),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(C,h),C=>a.handleFailedRequest(Fu.DeclarationRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideDeclaration?l.provideDeclaration(i,o,s,c):c(i,o,s)}};return[nT.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Yo.DeclarationFeature=Lu});var Fh=k(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.SelectionRangeFeature=void 0;var iT=require("vscode"),Au=Te(),oT=pt();function Nh(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var Mu=class extends oT.TextDocumentFeature{constructor(e){super(e,Au.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=Nh(Nh(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,o,s)=>{let a=this._client,c=async(g,m,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g),positions:await a.code2ProtocolConverter.asPositions(m,h)};return a.sendRequest(Au.SelectionRangeRequest.type,C,h).then(b=>h.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(b,h),b=>a.handleFailedRequest(Au.SelectionRangeRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideSelectionRanges?l.provideSelectionRanges(i,o,s,c):c(i,o,s)}};return[iT.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Zo.SelectionRangeFeature=Mu});var Lh=k(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.ProgressFeature=void 0;var sT=Te(),aT=Xc();function cT(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var ju=class{constructor(e){this._client=e,this.activeParts=new Set}fillClientCapabilities(e){cT(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new aT.ProgressPart(this._client,i.token,t))};e.onRequest(sT.WorkDoneProgressCreateRequest.type,r)}dispose(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};es.ProgressFeature=ju});var Mh=k(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.CallHierarchyFeature=void 0;var uT=require("vscode"),Or=Te(),lT=pt();function Ah(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var $u=class{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareCallHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,c,l)=>{let g=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Or.CallHierarchyPrepareRequest.type,g,l).then(m=>l.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(m,l),m=>i.handleFailedRequest(Or.CallHierarchyPrepareRequest.type,l,m,null))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,r,s):s(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(Or.CallHierarchyIncomingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(l,a),l=>r.handleFailedRequest(Or.CallHierarchyIncomingCallsRequest.type,a,l,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(Or.CallHierarchyOutgoingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(l,a),l=>r.handleFailedRequest(Or.CallHierarchyOutgoingCallsRequest.type,a,l,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}},Hu=class extends lT.TextDocumentFeature{constructor(e){super(e,Or.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let r=Ah(Ah(e,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new $u(t);return[uT.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};ts.CallHierarchyFeature=Hu});var jh=k(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.SemanticTokensFeature=void 0;var ns=require("vscode"),ie=Te(),dT=pt(),fT=Rn();function rs(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Wu=class extends dT.TextDocumentFeature{constructor(e){super(e,ie.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=rs(rs(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[ie.SemanticTokenTypes.namespace,ie.SemanticTokenTypes.type,ie.SemanticTokenTypes.class,ie.SemanticTokenTypes.enum,ie.SemanticTokenTypes.interface,ie.SemanticTokenTypes.struct,ie.SemanticTokenTypes.typeParameter,ie.SemanticTokenTypes.parameter,ie.SemanticTokenTypes.variable,ie.SemanticTokenTypes.property,ie.SemanticTokenTypes.enumMember,ie.SemanticTokenTypes.event,ie.SemanticTokenTypes.function,ie.SemanticTokenTypes.method,ie.SemanticTokenTypes.macro,ie.SemanticTokenTypes.keyword,ie.SemanticTokenTypes.modifier,ie.SemanticTokenTypes.comment,ie.SemanticTokenTypes.string,ie.SemanticTokenTypes.number,ie.SemanticTokenTypes.regexp,ie.SemanticTokenTypes.operator,ie.SemanticTokenTypes.decorator],t.tokenModifiers=[ie.SemanticTokenModifiers.declaration,ie.SemanticTokenModifiers.definition,ie.SemanticTokenModifiers.readonly,ie.SemanticTokenModifiers.static,ie.SemanticTokenModifiers.deprecated,ie.SemanticTokenModifiers.abstract,ie.SemanticTokenModifiers.async,ie.SemanticTokenModifiers.modification,ie.SemanticTokenModifiers.documentation,ie.SemanticTokenModifiers.defaultLibrary],t.formats=[ie.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,rs(rs(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(ie.SemanticTokensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeSemanticTokensEmitter.fire()});let[i,o]=this.getRegistration(t,e.semanticTokensProvider);!i||!o||this.register({id:i,registerOptions:o})}registerLanguageProvider(e){let t=e.documentSelector,r=fT.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,o=new ns.EventEmitter,s=r?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(C,b)=>{let x=this._client,q=x.clientOptions.middleware,O=(I,N)=>{let $={textDocument:x.code2ProtocolConverter.asTextDocumentIdentifier(I)};return x.sendRequest(ie.SemanticTokensRequest.type,$,N).then(K=>N.isCancellationRequested?null:x.protocol2CodeConverter.asSemanticTokens(K,N),K=>x.handleFailedRequest(ie.SemanticTokensRequest.type,N,K,null))};return q.provideDocumentSemanticTokens?q.provideDocumentSemanticTokens(C,b,O):O(C,b)},provideDocumentSemanticTokensEdits:i?(C,b,x)=>{let q=this._client,O=q.clientOptions.middleware,I=(N,$,K)=>{let de={textDocument:q.code2ProtocolConverter.asTextDocumentIdentifier(N),previousResultId:$};return q.sendRequest(ie.SemanticTokensDeltaRequest.type,de,K).then(async se=>K.isCancellationRequested?null:ie.SemanticTokens.is(se)?await q.protocol2CodeConverter.asSemanticTokens(se,K):await q.protocol2CodeConverter.asSemanticTokensEdits(se,K),se=>q.handleFailedRequest(ie.SemanticTokensDeltaRequest.type,K,se,null))};return O.provideDocumentSemanticTokensEdits?O.provideDocumentSemanticTokensEdits(C,b,x,I):I(C,b,x)}:void 0}:void 0,c=e.range===!0?{provideDocumentRangeSemanticTokens:(C,b,x)=>{let q=this._client,O=q.clientOptions.middleware,I=(N,$,K)=>{let de={textDocument:q.code2ProtocolConverter.asTextDocumentIdentifier(N),range:q.code2ProtocolConverter.asRange($)};return q.sendRequest(ie.SemanticTokensRangeRequest.type,de,K).then(se=>K.isCancellationRequested?null:q.protocol2CodeConverter.asSemanticTokens(se,K),se=>q.handleFailedRequest(ie.SemanticTokensRangeRequest.type,K,se,null))};return O.provideDocumentRangeSemanticTokens?O.provideDocumentRangeSemanticTokens(C,b,x,I):I(C,b,x)}}:void 0,l=[],g=this._client,m=g.protocol2CodeConverter.asSemanticTokensLegend(e.legend),h=g.protocol2CodeConverter.asDocumentSelector(t);return s!==void 0&&l.push(ns.languages.registerDocumentSemanticTokensProvider(h,s,m)),c!==void 0&&l.push(ns.languages.registerDocumentRangeSemanticTokensProvider(h,c,m)),[new ns.Disposable(()=>l.forEach(C=>C.dispose())),{range:c,full:s,onDidChangeSemanticTokensEmitter:o}]}};is.SemanticTokensFeature=Wu});var Hh=k((XP,$h)=>{$h.exports=function(n,e){for(var t=[],r=0;r<n.length;r++){var i=e(n[r],r);pT(i)?t.push.apply(t,i):t.push(i)}return t};var pT=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"}});var Vh=k((QP,Kh)=>{"use strict";Kh.exports=zh;function zh(n,e,t){n instanceof RegExp&&(n=Wh(n,t)),e instanceof RegExp&&(e=Wh(e,t));var r=Uh(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function Wh(n,e){var t=e.match(n);return t?t[0]:null}zh.range=Uh;function Uh(n,e,t){var r,i,o,s,a,c=t.indexOf(n),l=t.indexOf(e,c+1),g=c;if(c>=0&&l>0){if(n===e)return[c,l];for(r=[],o=t.length;g>=0&&!a;)g==c?(r.push(g),c=t.indexOf(n,g+1)):r.length==1?a=[r.pop(),l]:(i=r.pop(),i<o&&(o=i,s=l),l=t.indexOf(e,g+1)),g=c<l&&c>=0?c:l;r.length&&(a=[o,s])}return a}});var eg=k((JP,Zh)=>{var hT=Hh(),Bh=Vh();Zh.exports=vT;var Gh="\0SLASH"+Math.random()+"\0",Xh="\0OPEN"+Math.random()+"\0",Uu="\0CLOSE"+Math.random()+"\0",Qh="\0COMMA"+Math.random()+"\0",Jh="\0PERIOD"+Math.random()+"\0";function zu(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function gT(n){return n.split("\\\\").join(Gh).split("\\{").join(Xh).split("\\}").join(Uu).split("\\,").join(Qh).split("\\.").join(Jh)}function mT(n){return n.split(Gh).join("\\").split(Xh).join("{").split(Uu).join("}").split(Qh).join(",").split(Jh).join(".")}function Yh(n){if(!n)return[""];var e=[],t=Bh("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,o=t.post,s=r.split(",");s[s.length-1]+="{"+i+"}";var a=Yh(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function vT(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),si(gT(n),!0).map(mT)):[]}function yT(n){return"{"+n+"}"}function CT(n){return/^-?0\d/.test(n)}function wT(n,e){return n<=e}function RT(n,e){return n>=e}function si(n,e){var t=[],r=Bh("{","}",n);if(!r||/\$$/.test(r.pre))return[n];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),o=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),s=i||o,a=r.body.indexOf(",")>=0;if(!s&&!a)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+Uu+r.post,si(n)):[n];var c;if(s)c=r.body.split(/\.\./);else if(c=Yh(r.body),c.length===1&&(c=si(c[0],!1).map(yT),c.length===1)){var g=r.post.length?si(r.post,!1):[""];return g.map(function(bt){return r.pre+c[0]+bt})}var l=r.pre,g=r.post.length?si(r.post,!1):[""],m;if(s){var h=zu(c[0]),C=zu(c[1]),b=Math.max(c[0].length,c[1].length),x=c.length==3?Math.abs(zu(c[2])):1,q=wT,O=C<h;O&&(x*=-1,q=RT);var I=c.some(CT);m=[];for(var N=h;q(N,C);N+=x){var $;if(o)$=String.fromCharCode(N),$==="\\"&&($="");else if($=String(N),I){var K=b-$.length;if(K>0){var de=new Array(K+1).join("0");N<0?$="-"+de+$.slice(1):$=de+$}}m.push($)}}else m=hT(c,function(rt){return si(rt,!1)});for(var se=0;se<m.length;se++)for(var We=0;We<g.length;We++){var Ge=l+m[se]+g[We];(!e||s||Ge)&&t.push(Ge)}return t}});var Gu=k((YP,og)=>{og.exports=Kt;Kt.Minimatch=ht;var Ji=function(){try{return require("path")}catch{}}()||{sep:"/"};Kt.sep=Ji.sep;var Bu=Kt.GLOBSTAR=ht.GLOBSTAR={},bT=eg(),tg={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Ku="[^/]",Vu=Ku+"*?",DT="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",TT="(?:(?!(?:\\/|^)\\.).)*?",ng=ST("().*{}+?[]^$\\!");function ST(n){return n.split("").reduce(function(e,t){return e[t]=!0,e},{})}var rg=/\/+/;Kt.filter=_T;function _T(n,e){return e=e||{},function(t,r,i){return Kt(t,n,e)}}function sr(n,e){e=e||{};var t={};return Object.keys(n).forEach(function(r){t[r]=n[r]}),Object.keys(e).forEach(function(r){t[r]=e[r]}),t}Kt.defaults=function(n){if(!n||typeof n!="object"||!Object.keys(n).length)return Kt;var e=Kt,t=function(i,o,s){return e(i,o,sr(n,s))};return t.Minimatch=function(i,o){return new e.Minimatch(i,sr(n,o))},t.Minimatch.defaults=function(i){return e.defaults(sr(n,i)).Minimatch},t.filter=function(i,o){return e.filter(i,sr(n,o))},t.defaults=function(i){return e.defaults(sr(n,i))},t.makeRe=function(i,o){return e.makeRe(i,sr(n,o))},t.braceExpand=function(i,o){return e.braceExpand(i,sr(n,o))},t.match=function(r,i,o){return e.match(r,i,sr(n,o))},t};ht.defaults=function(n){return Kt.defaults(n).Minimatch};function Kt(n,e,t){return ss(e),t||(t={}),!t.nocomment&&e.charAt(0)==="#"?!1:new ht(e,t).match(n)}function ht(n,e){if(!(this instanceof ht))return new ht(n,e);ss(n),e||(e={}),n=n.trim(),!e.allowWindowsEscape&&Ji.sep!=="/"&&(n=n.split(Ji.sep).join("/")),this.options=e,this.set=[],this.pattern=n,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}ht.prototype.debug=function(){};ht.prototype.make=PT;function PT(){var n=this.pattern,e=this.options;if(!e.nocomment&&n.charAt(0)==="#"){this.comment=!0;return}if(!n){this.empty=!0;return}this.parseNegate();var t=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,t),t=this.globParts=t.map(function(r){return r.split(rg)}),this.debug(this.pattern,t),t=t.map(function(r,i,o){return r.map(this.parse,this)},this),this.debug(this.pattern,t),t=t.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,t),this.set=t}ht.prototype.parseNegate=ET;function ET(){var n=this.pattern,e=!1,t=this.options,r=0;if(!t.nonegate){for(var i=0,o=n.length;i<o&&n.charAt(i)==="!";i++)e=!e,r++;r&&(this.pattern=n.substr(r)),this.negate=e}}Kt.braceExpand=function(n,e){return ig(n,e)};ht.prototype.braceExpand=ig;function ig(n,e){return e||(this instanceof ht?e=this.options:e={}),n=typeof n>"u"?this.pattern:n,ss(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:bT(n)}var xT=1024*64,ss=function(n){if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>xT)throw new TypeError("pattern is too long")};ht.prototype.parse=kT;var os={};function kT(n,e){ss(n);var t=this.options;if(n==="**")if(t.noglobstar)n="*";else return Bu;if(n==="")return"";var r="",i=!!t.nocase,o=!1,s=[],a=[],c,l=!1,g=-1,m=-1,h=n.charAt(0)==="."?"":t.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",C=this;function b(){if(c){switch(c){case"*":r+=Vu,i=!0;break;case"?":r+=Ku,i=!0;break;default:r+="\\"+c;break}C.debug("clearStateChar %j %j",c,r),c=!1}}for(var x=0,q=n.length,O;x<q&&(O=n.charAt(x));x++){if(this.debug("%s	%s %s %j",n,x,r,O),o&&ng[O]){r+="\\"+O,o=!1;continue}switch(O){case"/":return!1;case"\\":b(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",n,x,r,O),l){this.debug("  in class"),O==="!"&&x===m+1&&(O="^"),r+=O;continue}C.debug("call clearStateChar %j",c),b(),c=O,t.noext&&b();continue;case"(":if(l){r+="(";continue}if(!c){r+="\\(";continue}s.push({type:c,start:x-1,reStart:r.length,open:tg[c].open,close:tg[c].close}),r+=c==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,r),c=!1;continue;case")":if(l||!s.length){r+="\\)";continue}b(),i=!0;var I=s.pop();r+=I.close,I.type==="!"&&a.push(I),I.reEnd=r.length;continue;case"|":if(l||!s.length||o){r+="\\|",o=!1;continue}b(),r+="|";continue;case"[":if(b(),l){r+="\\"+O;continue}l=!0,m=x,g=r.length,r+=O;continue;case"]":if(x===m+1||!l){r+="\\"+O,o=!1;continue}var N=n.substring(m+1,x);try{RegExp("["+N+"]")}catch{var $=this.parse(N,os);r=r.substr(0,g)+"\\["+$[0]+"\\]",i=i||$[1],l=!1;continue}i=!0,l=!1,r+=O;continue;default:b(),o?o=!1:ng[O]&&!(O==="^"&&l)&&(r+="\\"),r+=O}}for(l&&(N=n.substr(m+1),$=this.parse(N,os),r=r.substr(0,g)+"\\["+$[0],i=i||$[1]),I=s.pop();I;I=s.pop()){var K=r.slice(I.reStart+I.open.length);this.debug("setting tail",r,I),K=K.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(ut,Nt,Xe){return Xe||(Xe="\\"),Nt+Nt+Xe+"|"}),this.debug(`tail=%j
   %s`,K,K,I,r);var de=I.type==="*"?Vu:I.type==="?"?Ku:"\\"+I.type;i=!0,r=r.slice(0,I.reStart)+de+"\\("+K}b(),o&&(r+="\\\\");var se=!1;switch(r.charAt(0)){case"[":case".":case"(":se=!0}for(var We=a.length-1;We>-1;We--){var Ge=a[We],rt=r.slice(0,Ge.reStart),bt=r.slice(Ge.reStart,Ge.reEnd-8),gt=r.slice(Ge.reEnd-8,Ge.reEnd),mt=r.slice(Ge.reEnd);gt+=mt;var Dt=rt.split("(").length-1,ct=mt;for(x=0;x<Dt;x++)ct=ct.replace(/\)[+*?]?/,"");mt=ct;var vt="";mt===""&&e!==os&&(vt="$");var xn=rt+bt+mt+vt+gt;r=xn}if(r!==""&&i&&(r="(?=.)"+r),se&&(r=h+r),e===os)return[r,i];if(!i)return OT(n);var Le=t.nocase?"i":"";try{var tt=new RegExp("^"+r+"$",Le)}catch{return new RegExp("$.")}return tt._glob=n,tt._src=r,tt}Kt.makeRe=function(n,e){return new ht(n,e||{}).makeRe()};ht.prototype.makeRe=qT;function qT(){if(this.regexp||this.regexp===!1)return this.regexp;var n=this.set;if(!n.length)return this.regexp=!1,this.regexp;var e=this.options,t=e.noglobstar?Vu:e.dot?DT:TT,r=e.nocase?"i":"",i=n.map(function(o){return o.map(function(s){return s===Bu?t:typeof s=="string"?IT(s):s._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch{this.regexp=!1}return this.regexp}Kt.match=function(n,e,t){t=t||{};var r=new ht(e,t);return n=n.filter(function(i){return r.match(i)}),r.options.nonull&&!n.length&&n.push(e),n};ht.prototype.match=function(e,t){if(typeof t>"u"&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var r=this.options;Ji.sep!=="/"&&(e=e.split(Ji.sep).join("/")),e=e.split(rg),this.debug(this.pattern,"split",e);var i=this.set;this.debug(this.pattern,"set",i);var o,s;for(s=e.length-1;s>=0&&(o=e[s],!o);s--);for(s=0;s<i.length;s++){var a=i[s],c=e;r.matchBase&&a.length===1&&(c=[o]);var l=this.matchOne(c,a,t);if(l)return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate};ht.prototype.matchOne=function(n,e,t){var r=this.options;this.debug("matchOne",{this:this,file:n,pattern:e}),this.debug("matchOne",n.length,e.length);for(var i=0,o=0,s=n.length,a=e.length;i<s&&o<a;i++,o++){this.debug("matchOne loop");var c=e[o],l=n[i];if(this.debug(e,c,l),c===!1)return!1;if(c===Bu){this.debug("GLOBSTAR",[e,c,l]);var g=i,m=o+1;if(m===a){for(this.debug("** at the end");i<s;i++)if(n[i]==="."||n[i]===".."||!r.dot&&n[i].charAt(0)===".")return!1;return!0}for(;g<s;){var h=n[g];if(this.debug(`
globstar while`,n,g,e,m,h),this.matchOne(n.slice(g),e.slice(m),t))return this.debug("globstar found match!",g,s,h),!0;if(h==="."||h===".."||!r.dot&&h.charAt(0)==="."){this.debug("dot detected!",n,g,e,m);break}this.debug("globstar swallow a segment, and continue"),g++}return!!(t&&(this.debug(`
>>> no match, partial?`,n,g,e,m),g===s))}var C;if(typeof c=="string"?(C=l===c,this.debug("string match",c,l,C)):(C=l.match(c),this.debug("pattern match",c,l,C)),!C)return!1}if(i===s&&o===a)return!0;if(i===s)return t;if(o===a)return i===s-1&&n[i]==="";throw new Error("wtf?")};function OT(n){return n.replace(/\\(.)/g,"$1")}function IT(n){return n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var cg=k(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.WillDeleteFilesFeature=At.WillRenameFilesFeature=At.WillCreateFilesFeature=At.DidDeleteFilesFeature=At.DidRenameFilesFeature=At.DidCreateFilesFeature=void 0;var rn=require("vscode"),NT=Gu(),Hn=Te(),FT=ii();function sg(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function LT(n,e){return n[e]}function ag(n,e,t){n[e]=t}var Wn=class{constructor(e,t,r,i,o){this._filters=new Map,this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=o}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=sg(sg(e,"workspace"),"fileOperations");ag(t,"dynamicRegistration",!0),ag(t,this._clientCapability,!0)}initialize(e){var i;let t=(i=e.workspace)==null?void 0:i.fileOperations,r=t!==void 0?LT(t,this._serverCapability):void 0;if((r==null?void 0:r.filters)!==void 0)try{this.register({id:FT.generateUuid(),registerOptions:{filters:r.filters}})}catch(o){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${o}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new NT.Minimatch(r.pattern.glob,Wn.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return Wn.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async o=>{let s=t(o),a=s.fsPath.replace(/\\/g,"/");for(let c of this._filters.values())for(let l of c)if(!(l.scheme!==void 0&&l.scheme!==s.scheme)){if(l.matcher.match(a)){if(l.kind===void 0)return!0;let g=await this.getFileType(s);if(g===void 0)return this._client.error(`Failed to determine file type for ${s.toString()}.`),!0;if(g===rn.FileType.File&&l.kind===Hn.FileOperationPatternKind.file||g===rn.FileType.Directory&&l.kind===Hn.FileOperationPatternKind.folder)return!0}else if(l.kind===Hn.FileOperationPatternKind.folder&&await Wn.getFileType(s)===rn.FileType.Directory&&l.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((o,s)=>r[s]);return{...e,files:i}}static async getFileType(e){try{return(await rn.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){if(e!==void 0&&e.ignoreCase===!0)return{nocase:!0}}},as=class extends Wn{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o),this._notificationType=r,this._accessUri=s,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},cs=class extends as{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await Wn.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}dispose(){super.dispose(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},Xu=class extends as{constructor(e){super(e,rn.workspace.onDidCreateFiles,Hn.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.didCreateFiles?r.didCreateFiles(e,t):t(e)}};At.DidCreateFilesFeature=Xu;var Qu=class extends cs{constructor(e){super(e,rn.workspace.onDidRenameFiles,Hn.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=rn.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){var i;this.clearFileTypeCache();let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.didRenameFiles?r.didRenameFiles(e,t):t(e)}};At.DidRenameFilesFeature=Qu;var Ju=class extends cs{constructor(e){super(e,rn.workspace.onDidDeleteFiles,Hn.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=rn.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){var i;this.clearFileTypeCache();let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}};At.DidDeleteFilesFeature=Ju;var Yi=class extends Wn{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o),this._requestType=r,this._accessUri=s,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},Yu=class extends Yi{constructor(e){super(e,rn.workspace.onWillCreateFiles,Hn.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.willCreateFiles?r.willCreateFiles(e,t):t(e)}};At.WillCreateFilesFeature=Yu;var Zu=class extends Yi{constructor(e){super(e,rn.workspace.onWillRenameFiles,Hn.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.willRenameFiles?r.willRenameFiles(e,t):t(e)}};At.WillRenameFilesFeature=Zu;var el=class extends Yi{constructor(e){super(e,rn.workspace.onWillDeleteFiles,Hn.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}};At.WillDeleteFilesFeature=el});var lg=k(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.LinkedEditingFeature=void 0;var AT=require("vscode"),tl=Te(),MT=pt();function ug(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var nl=class extends MT.TextDocumentFeature{constructor(e){super(e,tl.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=ug(ug(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,o,s)=>{let a=this._client,c=(g,m,h)=>a.sendRequest(tl.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,m),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(C,h),C=>a.handleFailedRequest(tl.LinkedEditingRangeRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideLinkedEditingRange?l.provideLinkedEditingRange(i,o,s,c):c(i,o,s)}};return[AT.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};us.LinkedEditingFeature=nl});var fg=k(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.TypeHierarchyFeature=void 0;var jT=require("vscode"),Ir=Te(),$T=pt();function dg(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var rl=class{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,c,l)=>{let g=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Ir.TypeHierarchyPrepareRequest.type,g,l).then(m=>l.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(m,l),m=>i.handleFailedRequest(Ir.TypeHierarchyPrepareRequest.type,l,m,null))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,t,r,s):s(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(Ir.TypeHierarchySupertypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(Ir.TypeHierarchySupertypesRequest.type,a,l,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,o):o(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(Ir.TypeHierarchySubtypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(Ir.TypeHierarchySubtypesRequest.type,a,l,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,o):o(e,t)}},il=class extends $T.TextDocumentFeature{constructor(e){super(e,Ir.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=dg(dg(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new rl(t);return[jT.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};ls.TypeHierarchyFeature=il});var hg=k(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.InlineValueFeature=void 0;var pg=require("vscode"),ds=Te(),HT=pt();function fs(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var ol=class extends HT.TextDocumentFeature{constructor(e){super(e,ds.InlineValueRequest.type)}fillClientCapabilities(e){fs(fs(e,"textDocument"),"inlineValue").dynamicRegistration=!0,fs(fs(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(ds.InlineValueRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new pg.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(o,s,a,c)=>{let l=this._client,g=(h,C,b,x)=>{let q={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(h),range:l.code2ProtocolConverter.asRange(C),context:l.code2ProtocolConverter.asInlineValueContext(b)};return l.sendRequest(ds.InlineValueRequest.type,q,x).then(O=>x.isCancellationRequested?null:l.protocol2CodeConverter.asInlineValues(O,x),O=>l.handleFailedRequest(ds.InlineValueRequest.type,x,O,null))},m=l.clientOptions.middleware;return m.provideInlineValues?m.provideInlineValues(o,s,a,c,g):g(o,s,a,c)}};return[pg.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeInlineValues:r}]}};ps.InlineValueFeature=ol});var mg=k(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.InlayHintsFeature=void 0;var gg=require("vscode"),ai=Te(),WT=pt();function hs(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var sl=class extends WT.TextDocumentFeature{constructor(e){super(e,ai.InlayHintRequest.type)}fillClientCapabilities(e){let t=hs(hs(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},hs(hs(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(ai.InlayHintRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new gg.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(o,s,a)=>{let c=this._client,l=async(m,h,C)=>{let b={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),range:c.code2ProtocolConverter.asRange(h)};try{let x=await c.sendRequest(ai.InlayHintRequest.type,b,C);return C.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(x,C)}catch(x){return c.handleFailedRequest(ai.InlayHintRequest.type,C,x,null)}},g=c.clientOptions.middleware;return g.provideInlayHints?g.provideInlayHints(o,s,a,l):l(o,s,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(o,s)=>{let a=this._client,c=async(g,m)=>{try{let h=await a.sendRequest(ai.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(g),m);if(m.isCancellationRequested)return null;let C=a.protocol2CodeConverter.asInlayHint(h,m);return m.isCancellationRequested?null:C}catch(h){return a.handleFailedRequest(ai.InlayHintResolveRequest.type,m,h,null)}},l=a.clientOptions.middleware;return l.resolveInlayHint?l.resolveInlayHint(o,s,c):c(o,s)}:void 0,[gg.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeInlayHints:r}]}};gs.InlayHintsFeature=sl});var yg=k(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.DiagnosticFeature=Nr.vsdiag=void 0;var Ue=require("vscode"),Ve=Te(),zT=ii(),Zi=pt();function vg(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Tn;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Tn=Nr.vsdiag||(Nr.vsdiag={}));var Rt;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(Rt||(Rt={}));var al=class{constructor(){this.open=new Set;let e=()=>{if(this.open.clear(),Ue.window.tabs!==void 0)for(let t of Ue.window.tabs)t.resource!==void 0&&this.open.add(t.resource.toString());else if(Ue.window.openEditors!==void 0)for(let t of Ue.window.openEditors)t.resource!==void 0&&this.open.add(t.resource.toString())};e(),Ue.window.onDidChangeTabs!==void 0?this.disposable=Ue.window.onDidChangeTabs(e):Ue.window.onDidChangeOpenEditors!==void 0?this.disposable=Ue.window.onDidChangeOpenEditors(e):this.disposable={dispose:()=>{}}}dispose(){this.disposable.dispose()}isActive(e){var t;return((t=Ue.window.activeTextEditor)==null?void 0:t.document)===e}isVisible(e){return this.open.has(e.uri.toString())}},Vt;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(Vt||(Vt={}));var cl=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===Vt.document?this.documentPullStates:this.workspacePullStates,[o,s,a]=typeof t=="string"?[t,Ue.Uri.parse(t),r]:[t.uri.toString(),t.uri,t.version],c=i.get(o);return c===void 0&&(c={document:s,pulledVersion:a,resultId:void 0},i.set(o,c)),c}update(e,t,r,i){let o=e===Vt.document?this.documentPullStates:this.workspacePullStates,[s,a,c,l]=typeof t=="string"?[t,Ue.Uri.parse(t),r,i]:[t.uri.toString(),t.uri,t.version,r],g=o.get(s);g===void 0?(g={document:a,pulledVersion:c,resultId:l},o.set(s,g)):(g.pulledVersion=c,g.resultId=l)}unTrack(e,t){(e===Vt.document?this.documentPullStates:this.workspacePullStates).delete(t.uri.toString())}tracks(e,t){let r=typeof t=="string"?t:t.uri.toString();return(e===Vt.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){var i;return(i=(e===Vt.document?this.documentPullStates:this.workspacePullStates).get(t.uri.toString()))==null?void 0:i.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},ul=class{constructor(e,t,r){this.client=e,this.editorTracker=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new Ue.EventEmitter,this.provider=this.createProvider(),this.diagnostics=Ue.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new cl,this.workspaceErrorCounter=0}knows(e,t){return this.documentStates.tracks(e,t)}pull(e,t){this.pullAsync(e).then(()=>{t&&t()},r=>{this.client.error(`Document pull failed for text document ${e.uri.toString()}`,r,!1)})}async pullAsync(e){let t=e.uri.toString(),r=e.version,i=this.openRequests.get(t),o=this.documentStates.track(Vt.document,e);if(i===void 0){let s=new Ue.CancellationTokenSource;this.openRequests.set(t,{state:Rt.active,version:r,textDocument:e,tokenSource:s});let a,c;try{a=await this.provider.provideDiagnostics(e,o.resultId,s.token)??{kind:Tn.DocumentDiagnosticReportKind.full,items:[]}}catch(l){if(l instanceof Zi.LSPCancellationError&&Ve.Proposed.DiagnosticServerCancellationData.is(l.data)&&l.data.retriggerRequest===!1&&(c={state:Rt.outDated,textDocument:e}),c===void 0&&l instanceof Ue.CancellationError)c={state:Rt.reschedule,textDocument:e};else throw l}if(c=c??this.openRequests.get(t),c===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${t}`),this.diagnostics.delete(e.uri);return}if(this.openRequests.delete(t),!this.editorTracker.isVisible(e)){this.documentStates.unTrack(Vt.document,e);return}if(c.state===Rt.outDated)return;a!==void 0&&(a.kind===Tn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(e.uri,a.items),o.pulledVersion=r,o.resultId=a.resultId),c.state===Rt.reschedule&&this.pull(e)}else i.state===Rt.active?(i.tokenSource.cancel(),this.openRequests.set(t,{state:Rt.reschedule,textDocument:i.textDocument})):i.state===Rt.outDated&&this.openRequests.set(t,{state:Rt.reschedule,textDocument:i.textDocument})}cleanupPull(e){let t=e.uri.toString(),r=this.openRequests.get(t);this.options.workspaceDiagnostics||this.options.interFileDependencies?r!==void 0?this.openRequests.set(t,{state:Rt.reschedule,textDocument:e}):this.pull(e):(r!==void 0&&(r.state===Rt.active&&r.tokenSource.cancel(),this.openRequests.set(t,{state:Rt.outDated,textDocument:e})),this.diagnostics.delete(e.uri))}pullWorkspace(){this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Ve.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof Zi.LSPCancellationError)&&!Ve.Proposed.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Ve.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new Ue.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===Tn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Vt.document,r.uri.toString())||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(Vt.workspace,r.uri.toString(),r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let o=(a,c,l)=>{let g={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a.uri)},previousResultId:c};return this.client.sendRequest(Ve.Proposed.DocumentDiagnosticRequest.type,g,l).then(async m=>m==null||this.isDisposed||l.isCancellationRequested?{kind:Tn.DocumentDiagnosticReportKind.full,items:[]}:m.kind===Ve.Proposed.DocumentDiagnosticReportKind.full?{kind:Tn.DocumentDiagnosticReportKind.full,resultId:m.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(m.items,l)}:{kind:Tn.DocumentDiagnosticReportKind.unChanged,resultId:m.resultId},m=>this.client.handleFailedRequest(Ve.Proposed.DocumentDiagnosticRequest.type,l,m,{kind:Tn.DocumentDiagnosticReportKind.full,items:[]}))},s=this.client.clientOptions.middleware;return s.provideDiagnostics?s.provideDiagnostics(t,r,i,o):o(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let o=async l=>l.kind===Ve.Proposed.DocumentDiagnosticReportKind.full?{kind:Tn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version,items:await this.client.protocol2CodeConverter.asDiagnostics(l.items,r)}:{kind:Tn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version},s=l=>{let g=[];for(let m of l)g.push({uri:this.client.code2ProtocolConverter.asUri(m.uri),value:m.value});return g},a=(l,g)=>{let m=(0,zT.generateUuid)(),h=this.client.onProgress(Ve.Proposed.WorkspaceDiagnosticRequest.partialResult,m,async b=>{if(b==null){i(null);return}let x={items:[]};for(let q of b.items)try{x.items.push(await o(q))}catch(O){this.client.error("Converting workspace diagnostics failed.",O)}i(x)}),C={identifier:this.options.identifier,previousResultIds:s(l),partialResultToken:m};return this.client.sendRequest(Ve.Proposed.WorkspaceDiagnosticRequest.type,C,g).then(async b=>{if(g.isCancellationRequested)return{items:[]};let x={items:[]};for(let q of b.items)x.items.push(await o(q));return h.dispose(),i(x),{items:[]}},b=>(h.dispose(),this.client.handleFailedRequest(Ve.Proposed.DocumentDiagnosticRequest.type,g,b,{items:[]})))},c=this.client.clientOptions.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){var e,t;this.isDisposed=!0,(e=this.workspaceCancellation)==null||e.cancel(),(t=this.workspaceTimeout)==null||t.dispose();for(let[r,i]of this.openRequests)i.state===Rt.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:Rt.outDated,textDocument:i.textDocument})}},ll=class{constructor(e){this.diagnosticRequestor=e,this.documents=new Ve.LinkedMap}add(e){let t=e.uri.toString();this.documents.has(t)||(this.documents.set(e.uri.toString(),e,Ve.Touch.Last),this.trigger())}remove(e){let t=e.uri.toString();this.documents.has(t)&&(this.documents.delete(t),this.diagnosticRequestor.pull(e)),this.documents.size===0?this.stop():e===this.endDocument&&(this.endDocument=this.documents.last)}trigger(){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Ve.RAL)().timer.setInterval(()=>{let e=this.documents.first;e!==void 0&&(this.diagnosticRequestor.pull(e),this.documents.set(e.uri.toString(),e,Ve.Touch.Last),e===this.endDocument&&this.stop())},200)}dispose(){this.stop(),this.documents.clear()}stop(){var e;(e=this.intervalHandle)==null||e.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}},dl=class{constructor(e,t,r){var m;let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},o=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),s=[],a=h=>Ue.languages.match(o,h)>0&&t.isVisible(h);this.diagnosticRequestor=new ul(e,t,r),this.backgroundScheduler=new ll(this.diagnosticRequestor);let c=h=>{!a(h)||!r.interFileDependencies||this.activeTextDocument===h||this.backgroundScheduler.add(h)};this.activeTextDocument=(m=Ue.window.activeTextEditor)==null?void 0:m.document,Ue.window.onDidChangeActiveTextEditor(h=>{let C=this.activeTextDocument;this.activeTextDocument=h==null?void 0:h.document,C!==void 0&&c(C),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let l=e.getFeature(Ve.DidOpenTextDocumentNotification.method);s.push(l.onNotificationSent(h=>{let C=h.original;a(C)&&this.diagnosticRequestor.pull(C,()=>{c(C)})}));for(let h of Ue.workspace.textDocuments)a(h)&&this.diagnosticRequestor.pull(h,()=>{c(h)});if(i.onChange){let h=e.getFeature(Ve.DidChangeTextDocumentNotification.method);s.push(h.onNotificationSent(async C=>{let b=C.original.document;(i.filter===void 0||!i.filter(b,Zi.DiagnosticPullMode.onType))&&this.diagnosticRequestor.knows(Vt.document,b)&&C.original.contentChanges.length>0&&this.diagnosticRequestor.pull(b,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave){let h=e.getFeature(Ve.DidSaveTextDocumentNotification.method);s.push(h.onNotificationSent(C=>{let b=C.original;(i.filter===void 0||!i.filter(b,Zi.DiagnosticPullMode.onSave))&&this.diagnosticRequestor.knows(Vt.document,b)&&this.diagnosticRequestor.pull(C.original,()=>{this.backgroundScheduler.trigger()})}))}let g=e.getFeature(Ve.DidCloseTextDocumentNotification.method);s.push(g.onNotificationSent(h=>{let C=h.original;this.diagnosticRequestor.cleanupPull(C),this.backgroundScheduler.remove(C)})),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let h of Ue.workspace.textDocuments)a(h)&&this.diagnosticRequestor.pull(h)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=Ue.Disposable.from(...s,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}},fl=class extends Zi.TextDocumentFeature{constructor(e){super(e,Ve.Proposed.DocumentDiagnosticRequest.type),this.editorTracker=new al}fillClientCapabilities(e){let t=vg(vg(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1}initialize(e,t){this._client.onRequest(Ve.Proposed.DiagnosticRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeDiagnosticsEmitter.fire()});let[i,o]=this.getRegistration(t,e.diagnosticProvider);!i||!o||this.register({id:i,registerOptions:o})}dispose(){this.editorTracker.dispose(),super.dispose()}registerLanguageProvider(e){let t=new dl(this._client,this.editorTracker,e);return[t.disposable,t]}};Nr.DiagnosticFeature=fl});var Rg=k(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.NotebookDocumentSyncFeature=void 0;var kt=require("vscode"),UT=Gu(),zn=Te(),Sn=Te(),ms=ii(),Cg=Rn();function wg(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var ci;(function(n){let e;(function(t){function r(h,C){return{version:h.version,uri:C.asUri(h.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(h,C,b){let x=zn.Proposed.NotebookDocument.create(b.asUri(h.uri),h.notebookType,h.version,o(C,b));return Object.keys(h.metadata).length>0&&(x.metadata=s(h.metadata)),x}t.asNotebookDocument=i;function o(h,C){return h.map(b=>a(b,C))}t.asNotebookCells=o;function s(h){return l(new Set,h)}t.asMetadata=s;function a(h,C){let b=zn.Proposed.NotebookCell.create(c(h.kind),C.asUri(h.document.uri));return Object.keys(h.metadata).length>0&&(b.metadata=s(h.metadata)),h.executionSummary!==void 0&&Cg.number(h.executionSummary.executionOrder)&&Cg.boolean(h.executionSummary.success)&&(b.executionSummary={executionOrder:h.executionSummary.executionOrder,success:h.executionSummary.success}),b}t.asNotebookCell=a;function c(h){switch(h){case kt.NotebookCellKind.Markup:return zn.Proposed.NotebookCellKind.Markup;case kt.NotebookCellKind.Code:return zn.Proposed.NotebookCellKind.Code}}function l(h,C){if(h.has(C))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(C)){let b=[];for(let x of C)if(x!==null&&typeof x=="object"||Array.isArray(x))b.push(l(h,x));else{if(x instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");b.push(x)}return b}else{let b=Object.keys(C),x=Object.create(null);for(let q of b){let O=C[q];if(O!==null&&typeof O=="object"||Array.isArray(O))x[q]=l(h,O);else{if(O instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");x[q]=O}}return x}}function g(h,C){let b=C.asChangeTextDocumentParams(h);return{document:b.textDocument,changes:b.contentChanges}}t.asTextContentChange=g;function m(h,C){let b=Object.create(null);if(h.metadata&&(b.metadata=n.c2p.asMetadata(h.metadata)),h.cells!==void 0){let x=Object.create(null),q=h.cells;q.structure&&(x.structure={array:{start:q.structure.array.start,deleteCount:q.structure.array.deleteCount,cells:q.structure.array.cells!==void 0?q.structure.array.cells.map(O=>n.c2p.asNotebookCell(O,C)):void 0},didOpen:q.structure.didOpen!==void 0?q.structure.didOpen.map(O=>C.asOpenTextDocumentParams(O.document).textDocument):void 0,didClose:q.structure.didClose!==void 0?q.structure.didClose.map(O=>C.asCloseTextDocumentParams(O.document).textDocument):void 0}),q.data!==void 0&&(x.data=q.data.map(O=>n.c2p.asNotebookCell(O,C))),q.textContent!==void 0&&(x.textContent=q.textContent.map(O=>n.c2p.asTextContentChange(O,C))),Object.keys(x).length>0&&(b.cells=x)}return b}t.asNotebookDocumentChangeEvent=m})(e=n.c2p||(n.c2p={}))})(ci||(ci={}));var pl;(function(n){function e(a,c,l){let g=a.length,m=c.length,h=0;for(;h<m&&h<g&&t(a[h],c[h],l);)h++;if(h<m&&h<g){let C=g-1,b=m-1;for(;C>=0&&b>=0&&t(a[C],c[b],l);)C--,b--;let x=C+1-h,q=h===b+1?void 0:c.slice(h,b+1);return q!==void 0?{start:h,deleteCount:x,cells:q}:{start:h,deleteCount:x}}else return h<m?{start:h,deleteCount:0,cells:c.slice(h)}:h<g?{start:h,deleteCount:g-h}:void 0}n.computeDiff=e;function t(a,c,l=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!r(a.executionSummary,c.executionSummary)?!1:!l||l&&o(a.metadata,c.metadata)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&i(a.timing,c.timing)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function o(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;let l=Array.isArray(a),g=Array.isArray(c);if(l!==g)return!1;if(l&&g){if(a.length!==c.length)return!1;for(let m=0;m<a.length;m++)if(!o(a[m],c[m]))return!1}if(s(a)&&s(c)){let m=Object.keys(a),h=Object.keys(c);if(m.length!==h.length||(m.sort(),h.sort(),!o(m,h)))return!1;for(let C=0;C<m.length;C++){let b=m[C];if(!o(a[b],c[b]))return!1}return!0}return!1}function s(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=s})(pl||(pl={}));var hl;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let o=new UT.Minimatch(t.pattern,{noext:!0});if(!o.makeRe()||!o.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(hl||(hl={}));var vs;(function(n){function e(r){var s,a,c;let i=r.notebookSelector,o=[];for(let l of i){let g=(typeof l.notebook=="string"?l.notebook:(s=l.notebook)==null?void 0:s.notebookType)??"*",m=typeof l.notebook=="string"||(a=l.notebook)==null?void 0:a.scheme,h=typeof l.notebook=="string"||(c=l.notebook)==null?void 0:c.pattern;if(l.cells!==void 0)for(let C of l.cells)o.push(t(g,m,h,C.language));else o.push(t(g,m,h,void 0))}return o}n.asDocumentSelector=e;function t(r,i,o,s){return i===void 0&&o===void 0?{notebook:r,language:s}:{notebook:{notebookType:r,scheme:i,pattern:o},language:s}}})(vs||(vs={}));var ys;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(ys||(ys={}));var ui=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(vs.asDocumentSelector(t)),kt.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of kt.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);kt.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&kt.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),kt.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}get mode(){return"notebook"}handles(e){return kt.languages.match(this.selector,e.document)>0}didOpenNotebookCellTextDocument(e,t){if(kt.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let o=r.uris.has(t.document.uri.toString());if(i&&o||!i&&!o)return;if(i){let s=this.getMatchingCells(e);if(s!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,s);a!==void 0&&this.doSendChange(a,s).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){kt.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,o=r.cells.findIndex(s=>s.document.uri.toString()===i.toString());if(o!==-1)if(o===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let s=r.cells.slice(),a=s.splice(o,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:o,deleteCount:1},didClose:a}}},s).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let o=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);o!==void 0&&this.doSendChange(o,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){var o;let r=async(s,a)=>{let c=ci.c2p.asNotebookDocument(s,a,this.client.code2ProtocolConverter),l=a.map(g=>this.client.code2ProtocolConverter.asTextDocumentItem(g.document));try{await this.client.sendNotification(zn.Proposed.DidOpenNotebookDocumentNotification.type,{notebookDocument:c,cellTextDocuments:l})}catch(g){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",g),g}},i=(o=this.client.clientOptions.middleware)==null?void 0:o.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),ys.create(t)),(i==null?void 0:i.didOpen)!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){var o,s;let r=async a=>{try{await this.client.sendNotification(zn.Proposed.DidChangeNotebookDocumentNotification.type,{notebookDocument:ci.c2p.asVersionedNotebookDocumentIdentifier(a.notebook,this.client.code2ProtocolConverter),change:ci.c2p.asNotebookDocumentChangeEvent(a,this.client.code2ProtocolConverter)})}catch(c){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",c),c}},i=(o=this.client.clientOptions.middleware)==null?void 0:o.notebooks;return((s=e.cells)==null?void 0:s.structure)!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),ys.create(t??[])),(i==null?void 0:i.didChange)!==void 0?i==null?void 0:i.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){var i;let t=async o=>{try{await this.client.sendNotification(zn.Proposed.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)}})}catch(s){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",s),s}},r=(i=this.client.clientOptions.middleware)==null?void 0:i.notebooks;return(r==null?void 0:r.didSave)!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){var o;let r=async(s,a)=>{try{await this.client.sendNotification(zn.Proposed.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)},cellTextDocuments:a.map(c=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(c.document))})}catch(c){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",c),c}},i=(o=this.client.clientOptions.middleware)==null?void 0:o.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),(i==null?void 0:i.didClose)!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let o={notebook:e};(t==null?void 0:t.metadata)!==void 0&&(o.metadata=ci.c2p.asMetadata(t.metadata));let s;if((t==null?void 0:t.cellChanges)!==void 0&&t.cellChanges.length>0){let a=[];s=new Set(i.map(c=>c.document.uri.toString()));for(let c of t.cellChanges)s.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(o.cells=o.cells??{},o.cells.data=a)}if(((t==null?void 0:t.contentChanges)!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,c=i,l=pl.computeDiff(a,c,!1),g,m;if(l!==void 0){g=l.cells===void 0?new Map:new Map(l.cells.map(b=>[b.document.uri.toString(),b])),m=l.deleteCount===0?new Map:new Map(a.slice(l.start,l.start+l.deleteCount).map(b=>[b.document.uri.toString(),b]));for(let b of Array.from(m.keys()))g.has(b)&&(m.delete(b),g.delete(b));o.cells=o.cells??{};let h=[],C=[];if(g.size>0||m.size>0){for(let b of g.values())h.push(b);for(let b of m.values())C.push(b)}o.cells.structure={array:l,didOpen:h,didClose:C}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0){if(r.cells===void 0)return;let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}else if(hl.matchNotebook(r.notebook,e))return r.cells===void 0?t:this.filterCells(e,t,r.cells)}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){var o;let i=t.filter(s=>{let a=s.document.languageId;return r.some(c=>c.language==="*"||a===c.language)});return typeof((o=this.client.clientOptions.notebookDocumentOptions)==null?void 0:o.filterCells)=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,t):i}},gl=class{constructor(e,t){this.client=e,this.documentSelector=vs.asDocumentSelector(t);let r=ms.generateUuid();this.client.getFeature(Sn.DidOpenTextDocumentNotification.method).register({id:r,registerOptions:{documentSelector:this.documentSelector}});let i=ms.generateUuid();this.client.getFeature(Sn.DidChangeTextDocumentNotification.method).register({id:i,registerOptions:{documentSelector:this.documentSelector,syncKind:Sn.TextDocumentSyncKind.Incremental}});let o=ms.generateUuid();this.client.getFeature(Sn.DidCloseTextDocumentNotification.method).register({id:o,registerOptions:{documentSelector:this.documentSelector}}),this.registrations={open:r,change:i,close:o}}get mode(){return"cellContent"}handles(e){return kt.languages.match(this.client.protocol2CodeConverter.asDocumentSelector(this.documentSelector),e.document)>0}dispose(){this.registrations!==void 0&&(this.client.getFeature(Sn.DidOpenTextDocumentNotification.method).unregister(this.registrations.open),this.client.getFeature(Sn.DidChangeTextDocumentNotification.method).unregister(this.registrations.change),this.client.getFeature(Sn.DidCloseTextDocumentNotification.method).unregister(this.registrations.close))}async sendDidOpenTextDocument(e){let t=this.client.getFeature(Sn.DidOpenTextDocumentNotification.method).getProvider(e);return t!==void 0?t.send(e):Promise.reject(new Error(`No open provider found for notebook cell document ${e.uri.toString()}`))}async sendDidChangeTextDocument(e){let t=this.client.getFeature(Sn.DidChangeTextDocumentNotification.method).getProvider(e.document);return t!==void 0?t.send(e):Promise.reject(new Error(`No change provider found for notebook cell document ${e.document.uri.toString()}`))}async sendDidCloseTextDocument(e){let t=this.client.getFeature(Sn.DidCloseTextDocumentNotification.method).getProvider(e);return t!==void 0?t.send(e):Promise.reject(new Error(`No close provider found for notebook cell document ${e.uri.toString()}`))}},ar=class{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=zn.Proposed.NotebookDocumentSyncRegistrationType.type,kt.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==ar.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof ui&&o.didOpenNotebookCellTextDocument(r,i)}),kt.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==ar.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let o of this.registrations.values())o instanceof ui&&o.didChangeNotebookCellTextDocument(i,t)}),kt.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==ar.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof ui&&o.didCloseNotebookCellTextDocument(r,i)})}fillClientCapabilities(e){let t=wg(wg(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??ms.generateUuid();this.register({id:r,registerOptions:t})}register(e){if(e.registerOptions.mode==="cellContent"){let t=new gl(this.client,e.registerOptions);this.registrations.set(e.id,t)}else{let t=new ui(this.client,e.registerOptions);this.registrations.set(e.id,t)}}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}dispose(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}getProvider(e){for(let t of this.registrations.values())if(t.handles(e))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of kt.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};Cs.NotebookDocumentSyncFeature=ar;ar.CellScheme="vscode-notebook-cell"});var vl=k(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.ProposedFeatures=Fr.CommonLanguageClient=void 0;var KT=pt(),VT=Sh(),BT=vc(),GT=Ph(),XT=Eh(),QT=xh(),JT=qh(),YT=Ih(),ZT=Fh(),eS=Lh(),tS=Mh(),nS=jh(),li=cg(),rS=lg(),iS=fg(),oS=hg(),sS=mg(),ml=class extends KT.BaseLanguageClient{constructor(e,t,r){super(e,t,r)}registerProposedFeatures(){this.registerFeatures(Tg.createAll(this))}registerBuiltinFeatures(){super.registerBuiltinFeatures(),this.registerFeature(new BT.ConfigurationFeature(this)),this.registerFeature(new XT.TypeDefinitionFeature(this)),this.registerFeature(new GT.ImplementationFeature(this)),this.registerFeature(new VT.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new QT.WorkspaceFoldersFeature(this)),this.registerFeature(new JT.FoldingRangeFeature(this)),this.registerFeature(new YT.DeclarationFeature(this)),this.registerFeature(new ZT.SelectionRangeFeature(this)),this.registerFeature(new eS.ProgressFeature(this)),this.registerFeature(new tS.CallHierarchyFeature(this)),this.registerFeature(new nS.SemanticTokensFeature(this)),this.registerFeature(new rS.LinkedEditingFeature(this)),this.registerFeature(new li.DidCreateFilesFeature(this)),this.registerFeature(new li.DidRenameFilesFeature(this)),this.registerFeature(new li.DidDeleteFilesFeature(this)),this.registerFeature(new li.WillCreateFilesFeature(this)),this.registerFeature(new li.WillRenameFilesFeature(this)),this.registerFeature(new li.WillDeleteFilesFeature(this)),this.registerFeature(new iS.TypeHierarchyFeature(this)),this.registerFeature(new oS.InlineValueFeature(this)),this.registerFeature(new sS.InlayHintsFeature(this))}};Fr.CommonLanguageClient=ml;var bg=yg(),Dg=Rg(),Tg;(function(n){function e(i){return[new bg.DiagnosticFeature(i),new Dg.NotebookDocumentSyncFeature(i)]}n.createAll=e;function t(i){return new bg.DiagnosticFeature(i)}n.createDiagnosticFeature=t;function r(i){return new Dg.NotebookDocumentSyncFeature(i)}n.createNotebookDocumentSyncFeature=r})(Tg=Fr.ProposedFeatures||(Fr.ProposedFeatures={}))});var _g=k(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});ws.terminate=void 0;var Sg=require("child_process"),aS=require("path"),cS=process.platform==="win32",uS=process.platform==="darwin",lS=process.platform==="linux";function dS(n,e){if(cS)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),Sg.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(lS||uS)try{var t=(0,aS.join)(__dirname,"terminateProcess.sh"),r=Sg.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}ws.terminate=dS});var yl=k((cE,Pg)=>{"use strict";Pg.exports=Te()});var Eg=k(Un=>{"use strict";var fS=Un&&Un.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Cl=Un&&Un.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&fS(e,n,t)};Object.defineProperty(Un,"__esModule",{value:!0});Cl(Te(),Un);Cl(pt(),Un);Cl(vl(),Un)});var Rs=k(qt=>{"use strict";var pS=qt&&qt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),qg=qt&&qt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pS(e,n,t)};Object.defineProperty(qt,"__esModule",{value:!0});qt.SettingMonitor=qt.LanguageClient=qt.TransportKind=void 0;var Kn=require("child_process"),wl=require("fs"),Rl=require("path"),xg=Vf(),ur=require("vscode"),Fe=Rn(),hS=vl(),gS=pt(),mS=_g(),He=yl();qg(yl(),qt);qg(Eg(),qt);var kg="^1.66.0",Ke;(function(n){n[n.stdio=0]="stdio",n[n.ipc=1]="ipc",n[n.pipe=2]="pipe",n[n.socket=3]="socket"})(Ke=qt.TransportKind||(qt.TransportKind={}));var cr;(function(n){function e(t){let r=t;return r&&r.kind===Ke.socket&&Fe.number(r.port)}n.isSocket=e})(cr||(cr={}));var bl;(function(n){function e(t){return Fe.string(t.command)}n.is=e})(bl||(bl={}));var Dl;(function(n){function e(t){return Fe.string(t.module)}n.is=e})(Dl||(Dl={}));var Tl;(function(n){function e(t){let r=t;return r&&r.writer!==void 0&&r.reader!==void 0}n.is=e})(Tl||(Tl={}));var Sl;(function(n){function e(t){let r=t;return r&&r.process!==void 0&&typeof r.detached=="boolean"}n.is=e})(Sl||(Sl={}));var _l=class extends hS.CommonLanguageClient{constructor(e,t,r,i,o){let s,a,c,l,g;Fe.string(t)?(s=e,a=t,c=r,l=i,g=!!o):(s=e.toLowerCase(),a=e,c=t,l=r,g=i),g===void 0&&(g=!1),super(s,a,l),this._serverOptions=c,this._forceDebug=g,this._isInDebugMode=g;try{this.checkVersion()}catch(m){throw Fe.string(m.message)&&this.outputChannel.appendLine(m.message),m}}checkVersion(){let e=xg.parse(ur.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${ur.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!xg.satisfies(e,kg))throw new Error(`The language client requires VS Code version ${kg} but received version ${ur.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),this.start()):this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||setTimeout(()=>{try{process.kill(e.pid,0),(0,mS.terminate)(e)}catch{}},2e3)}handleConnectionClosed(){this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(g,m){if(!g&&!m)return;let h=Object.create(null);return Object.keys(process.env).forEach(C=>h[C]=process.env[C]),m&&(h.ELECTRON_RUN_AS_NODE="1",h.ELECTRON_NO_ASAR="1"),g&&Object.keys(g).forEach(C=>h[C]=g[C]),h}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function o(){let g=process.execArgv;return g?g.some(m=>r.some(h=>m.startsWith(h))||i.some(h=>m===h)):!1}function s(g){if(g.stdin===null||g.stdout===null||g.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(Fe.func(a))return a().then(g=>{if(gS.MessageTransports.is(g))return this._isDetached=!!g.detached,g;if(Tl.is(g))return this._isDetached=!!g.detached,{reader:new He.StreamMessageReader(g.reader),writer:new He.StreamMessageWriter(g.writer)};{let m;return Sl.is(g)?(m=g.process,this._isDetached=g.detached):(m=g,this._isDetached=!1),m.stderr.on("data",h=>this.outputChannel.append(Fe.string(h)?h:h.toString(e))),{reader:new He.StreamMessageReader(m.stdout),writer:new He.StreamMessageWriter(m.stdin)}}});let c,l=a;return l.run||l.debug?this._forceDebug||o()?(c=l.debug,this._isInDebugMode=!0):(c=l.run,this._isInDebugMode=!1):c=a,this._getServerWorkingDir(c.options).then(g=>{if(Dl.is(c)&&c.module){let m=c,h=m.transport||Ke.stdio;if(m.runtime){let C=[],b=m.options??Object.create(null);b.execArgv&&b.execArgv.forEach(I=>C.push(I)),C.push(m.module),m.args&&m.args.forEach(I=>C.push(I));let x=Object.create(null);x.cwd=g,x.env=t(b.env,!1);let q=this._getRuntimePath(m.runtime,g),O;if(h===Ke.ipc?(x.stdio=[null,null,null,"ipc"],C.push("--node-ipc")):h===Ke.stdio?C.push("--stdio"):h===Ke.pipe?(O=(0,He.generateRandomPipeName)(),C.push(`--pipe=${O}`)):cr.isSocket(h)&&C.push(`--socket=${h.port}`),C.push(`--clientProcessId=${process.pid.toString()}`),h===Ke.ipc||h===Ke.stdio){let I=Kn.spawn(q,C,x);return!I||!I.pid?di(I,`Launching server using runtime ${q} failed.`):(this._serverProcess=I,I.stderr.on("data",N=>this.outputChannel.append(Fe.string(N)?N:N.toString(e))),h===Ke.ipc?(I.stdout.on("data",N=>this.outputChannel.append(Fe.string(N)?N:N.toString(e))),Promise.resolve({reader:new He.IPCMessageReader(I),writer:new He.IPCMessageWriter(I)})):Promise.resolve({reader:new He.StreamMessageReader(I.stdout),writer:new He.StreamMessageWriter(I.stdin)}))}else{if(h===Ke.pipe)return(0,He.createClientPipeTransport)(O).then(I=>{let N=Kn.spawn(q,C,x);return!N||!N.pid?di(N,`Launching server using runtime ${q} failed.`):(this._serverProcess=N,N.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),N.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),I.onConnected().then($=>({reader:$[0],writer:$[1]})))});if(cr.isSocket(h))return(0,He.createClientSocketTransport)(h.port).then(I=>{let N=Kn.spawn(q,C,x);return!N||!N.pid?di(N,`Launching server using runtime ${q} failed.`):(this._serverProcess=N,N.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),N.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),I.onConnected().then($=>({reader:$[0],writer:$[1]})))})}}else{let C;return new Promise((b,x)=>{let q=(m.args&&m.args.slice())??[];h===Ke.ipc?q.push("--node-ipc"):h===Ke.stdio?q.push("--stdio"):h===Ke.pipe?(C=(0,He.generateRandomPipeName)(),q.push(`--pipe=${C}`)):cr.isSocket(h)&&q.push(`--socket=${h.port}`),q.push(`--clientProcessId=${process.pid.toString()}`);let O=m.options??Object.create(null);if(O.env=t(O.env,!0),O.execArgv=O.execArgv||[],O.cwd=g,O.silent=!0,h===Ke.ipc||h===Ke.stdio){let I=Kn.fork(m.module,q||[],O);s(I),this._serverProcess=I,I.stderr.on("data",N=>this.outputChannel.append(Fe.string(N)?N:N.toString(e))),h===Ke.ipc?(I.stdout.on("data",N=>this.outputChannel.append(Fe.string(N)?N:N.toString(e))),b({reader:new He.IPCMessageReader(this._serverProcess),writer:new He.IPCMessageWriter(this._serverProcess)})):b({reader:new He.StreamMessageReader(I.stdout),writer:new He.StreamMessageWriter(I.stdin)})}else h===Ke.pipe?(0,He.createClientPipeTransport)(C).then(I=>{let N=Kn.fork(m.module,q||[],O);s(N),this._serverProcess=N,N.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),N.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),I.onConnected().then($=>{b({reader:$[0],writer:$[1]})},x)},x):cr.isSocket(h)&&(0,He.createClientSocketTransport)(h.port).then(I=>{let N=Kn.fork(m.module,q||[],O);s(N),this._serverProcess=N,N.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),N.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),I.onConnected().then($=>{b({reader:$[0],writer:$[1]})},x)},x)})}}else if(bl.is(c)&&c.command){let m=c,h=c.args!==void 0?c.args.slice(0):[],C,b=c.transport;if(b===Ke.stdio)h.push("--stdio");else if(b===Ke.pipe)C=(0,He.generateRandomPipeName)(),h.push(`--pipe=${C}`);else if(cr.isSocket(b))h.push(`--socket=${b.port}`);else if(b===Ke.ipc)throw new Error("Transport kind ipc is not support for command executable");let x=Object.assign({},m.options);if(x.cwd=x.cwd||g,b===void 0||b===Ke.stdio){let q=Kn.spawn(m.command,h,x);return!q||!q.pid?di(q,`Launching server using command ${m.command} failed.`):(q.stderr.on("data",O=>this.outputChannel.append(Fe.string(O)?O:O.toString(e))),this._serverProcess=q,this._isDetached=!!x.detached,Promise.resolve({reader:new He.StreamMessageReader(q.stdout),writer:new He.StreamMessageWriter(q.stdin)}))}else{if(b===Ke.pipe)return(0,He.createClientPipeTransport)(C).then(q=>{let O=Kn.spawn(m.command,h,x);return!O||!O.pid?di(O,`Launching server using command ${m.command} failed.`):(this._serverProcess=O,this._isDetached=!!x.detached,O.stderr.on("data",I=>this.outputChannel.append(Fe.string(I)?I:I.toString(e))),O.stdout.on("data",I=>this.outputChannel.append(Fe.string(I)?I:I.toString(e))),q.onConnected().then(I=>({reader:I[0],writer:I[1]})))});if(cr.isSocket(b))return(0,He.createClientSocketTransport)(b.port).then(q=>{let O=Kn.spawn(m.command,h,x);return!O||!O.pid?di(O,`Launching server using command ${m.command} failed.`):(this._serverProcess=O,this._isDetached=!!x.detached,O.stderr.on("data",I=>this.outputChannel.append(Fe.string(I)?I:I.toString(e))),O.stdout.on("data",I=>this.outputChannel.append(Fe.string(I)?I:I.toString(e))),q.onConnected().then(I=>({reader:I[0],writer:I[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))})}_getRuntimePath(e,t){if(Rl.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let i=Rl.join(r,e);if(wl.existsSync(i))return i}if(t!==void 0){let i=Rl.join(t,e);if(wl.existsSync(i))return i}return e}_mainGetRootPath(){let e=ur.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(r=>{wl.lstat(t,(i,o)=>{r(!i&&o.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}getLocale(){let e=process.env.VSCODE_NLS_CONFIG;if(e===void 0)return"en";let t;try{t=JSON.parse(e)}catch{}return t===void 0||typeof t.locale!="string"?"en":t.locale}};qt.LanguageClient=_l;var Pl=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return ur.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new ur.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,i=r?ur.workspace.getConfiguration(t).get(r,!1):ur.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start():!i&&this._client.needsStop()&&this._client.stop()}};qt.SettingMonitor=Pl;function di(n,e){return n===null?Promise.reject(e):new Promise((t,r)=>{n.on("error",i=>{r(`${e} ${i}`)}),setImmediate(()=>r(e))})}});var xl=k((dE,em)=>{"use strict";em.exports=Rs()});var $S={};Rv($S,{activate:()=>pv,deactivate:()=>OS,outputChannel:()=>Kl,traceOutputChannel:()=>Ul});module.exports=bv($S);var pe=Oe(require("vscode")),lv=Oe(require("os"));var M=Oe(require("vscode")),oo=Oe(Rs());var ke=Oe(Rs()),Og=new ke.RequestType("rust-analyzer/analyzerStatus"),Ig=new ke.RequestType0("rust-analyzer/memoryUsage"),Ng=new ke.RequestType0("rust-analyzer/shuffleCrateGraph"),Fg=new ke.NotificationType("experimental/serverStatus"),Lg=new ke.RequestType0("rust-analyzer/reloadWorkspace"),Ag=new ke.RequestType("textDocument/hover"),Mg=new ke.RequestType("rust-analyzer/syntaxTree"),jg=new ke.RequestType("rust-analyzer/viewHir"),$g=new ke.RequestType("rust-analyzer/viewFileText"),Hg=new ke.RequestType("rust-analyzer/viewItemTree"),Wg=new ke.RequestType("rust-analyzer/viewCrateGraph"),zg=new ke.RequestType("rust-analyzer/expandMacro"),Ug=new ke.RequestType("rust-analyzer/relatedTests"),Kg=new ke.RequestType0("rust-analyzer/cancelFlycheck"),El=new ke.RequestType("experimental/ssr"),Vg=new ke.RequestType("experimental/matchingBrace"),Bg=new ke.RequestType("experimental/parentModule"),Gg=new ke.RequestType("experimental/joinLines"),Xg=new ke.RequestType("experimental/onEnter"),Qg=new ke.RequestType("experimental/runnables"),Jg=new ke.RequestType("experimental/externalDocs"),Yg=new ke.RequestType("experimental/openCargoToml"),Zg=new ke.RequestType("experimental/moveItem");var Tm=Oe(require("path"));var yn=Oe(require("vscode"));var vS=Oe(xl()),Ds=Oe(require("vscode")),tm=require("assert"),Ts=require("child_process"),nm=require("util");function eo(n,e){try{(0,tm.strict)(n,e)}catch(t){throw De.error("Assertion failed:",e),t}}var De=new class{constructor(){this.enabled=!0;this.output=Ds.window.createOutputChannel("Rust Analyzer Client")}setEnabled(n){De.enabled=n}debug(...n){!De.enabled||De.write("DEBUG",...n)}info(...n){De.write("INFO",...n)}warn(...n){debugger;De.write("WARN",...n)}error(...n){debugger;De.write("ERROR",...n),De.output.show(!0)}write(n,...e){let t=e.map(De.stringify).join(" "),r=new Date().toLocaleString();De.output.appendLine(`${n} [${r}]: ${t}`)}stringify(n){return typeof n=="string"?n:(0,nm.inspect)(n,{colors:!1,depth:6})}};function to(n){return new Promise(e=>setTimeout(e,n))}function Vn(n){return n.languageId==="rust"&&n.uri.scheme==="file"}function rm(n){return n.uri.scheme==="file"&&n.fileName.endsWith("Cargo.toml")}function _n(n){return Vn(n.document)}function im(n){De.debug("Checking availability of a binary at",n);let e=(0,Ts.spawnSync)(n,["--version"],{encoding:"utf8"});return(e.error&&e.error.code!=="ENOENT"?De.warn:De.debug)(n,"--version:",e),e.status===0}function kl(n,e){return Ds.commands.executeCommand("setContext",n,e)}function om(n){let e=new Map;return async function(t){let r=e.get(t);if(r)return r;let i=await n.call(this,t);return e.set(t,i),i}}function ql(n,e){return new Promise((t,r)=>{(0,Ts.exec)(n,e,(i,o,s)=>{if(i){r(i);return}if(s){r(new Error(s));return}t(o.trimEnd())})})}async function Ol(n){if(n.entries().length===1){let[e,t]=n.entries()[0],r=await sm(e);r&&await Ss(r,t);return}for(let[e,t]of n.entries()){let r=await sm(e);r&&await r.edit(i=>{for(let o of t)eo(!cm(o.newText),`bad ws edit: snippet received with multiple edits: ${JSON.stringify(n)}`),i.replace(o.range,o.newText)})}}async function sm(n){var e;return((e=yn.window.activeTextEditor)==null?void 0:e.document.uri)!==n&&await yn.window.showTextDocument(n,{}),yn.window.visibleTextEditors.find(t=>t.document.uri.toString()===n.toString())}async function Ss(n,e){let t=[],r=0;await n.edit(i=>{for(let o of e){let s=cm(o.newText);if(s){let[a,[c,l]]=s,g=a.substr(0,c),m=g.lastIndexOf(`
`),h=o.range.start.line+r+am(g),C=m===-1?o.range.start.character+c:g.length-m-1,b=C+l;t.push(new yn.Selection(new yn.Position(h,C),new yn.Position(h,b))),i.replace(o.range,a)}else i.replace(o.range,o.newText);r+=am(o.newText)-(o.range.end.line-o.range.start.line)}}),t.length>0&&(n.selections=t),t.length===1&&n.revealRange(t[0],yn.TextEditorRevealType.InCenterIfOutsideViewport)}function cm(n){let e=n.match(/\$(0|\{0:([^}]*)\})/);if(!e)return;let t=e[2]??"";if(e.index==null)return;let r=[e.index,t.length];return[n.replace(e[0],t),r]}function am(n){return(n.match(/\n/g)||[]).length}var Sm=require("child_process");var Lr=Oe(require("vscode"));var et=Oe(require("vscode"));var um=Oe(require("child_process")),_s=Oe(require("os")),Ps=Oe(require("path")),lm=Oe(require("readline")),lr=Oe(require("vscode"));var fi=class{constructor(e,t){this.rootFolder=e;this.output=t}static artifactSpec(e){let t=[...e,"--message-format=json"];switch(t[0]){case"run":t[0]="build";break;case"test":{t.includes("--no-run")||t.push("--no-run");break}}let r={cargoArgs:t};return(t[0]==="test"||t[0]==="bench")&&(r.filter=i=>i.filter(o=>o.isTest)),r}async getArtifacts(e){var r;let t=[];try{await this.runCargo(e.cargoArgs,i=>{if(i.reason==="compiler-artifact"&&i.executable){let o=i.target.crate_types.includes("bin"),s=i.target.kind.includes("custom-build");(o&&!s||i.profile.test)&&t.push({fileName:i.executable,name:i.target.name,kind:i.target.kind[0],isTest:i.profile.test})}else i.reason==="compiler-message"&&this.output.append(i.message.rendered)},i=>this.output.append(i))}catch(i){throw this.output.show(!0),new Error(`Cargo invocation has failed: ${i}`)}return((r=e.filter)==null?void 0:r.call(e,t))??t}async executableFromArgs(e){let t=await this.getArtifacts(fi.artifactSpec(e));if(t.length===0)throw new Error("No compilation artifacts");if(t.length>1)throw new Error("Multiple compilation artifacts are not supported.");return t[0].fileName}async runCargo(e,t,r){let i=await Il();return await new Promise((o,s)=>{let a=um.spawn(i,e,{stdio:["ignore","pipe","pipe"],cwd:this.rootFolder});a.on("error",l=>s(new Error(`could not launch cargo: ${l}`))),a.stderr.on("data",l=>r(l.toString())),lm.createInterface({input:a.stdout}).on("line",l=>{let g=JSON.parse(l);t(g)}),a.on("exit",(l,g)=>{l===0?o(l):s(new Error(`exit code: ${l}.`))})})}};async function dm(n){let e=await Nl("rustc");return await ql(`${e} --print sysroot`,{cwd:n})}async function fm(n){let e=await Nl("rustc"),t=await ql(`${e} -V -v`,{cwd:n});return/commit-hash:\s(.*)$/m.exec(t)[1]}function Il(){return Nl("cargo")}var Nl=om(async n=>{{let e=process.env[n.toUpperCase()];if(e)return e}if(await yS(n))return n;try{let e=lr.Uri.joinPath(lr.Uri.file(_s.homedir()),".cargo","bin",n);if(await pm(e))return e.fsPath}catch(e){De.error("Failed to read the fs info",e)}return n});async function yS(n){let t=(process.env.PATH??"").split(Ps.delimiter).flatMap(r=>{let i=Ps.join(r,n);return _s.type()==="Windows_NT"?[i,`${i}.exe`]:[i]});for await(let r of t.map(CS))if(r)return!0;return!1}async function CS(n){return pm(lr.Uri.file(n))}async function pm(n){try{return((await lr.workspace.fs.stat(n)).type&lr.FileType.File)!==0}catch{return!1}}var pi="cargo",RS="rust",Fl=class{constructor(e){this.config=e}async provideTasks(){let e=[{command:"build",group:et.TaskGroup.Build},{command:"check",group:et.TaskGroup.Build},{command:"clippy",group:et.TaskGroup.Build},{command:"test",group:et.TaskGroup.Test},{command:"clean",group:et.TaskGroup.Clean},{command:"run",group:void 0}],t=[];for(let r of et.workspace.workspaceFolders||[])for(let i of e){let o=await Es(r,{type:pi,command:i.command},`cargo ${i.command}`,[i.command],this.config.cargoRunner);o.group=i.group,t.push(o)}return t}async resolveTask(e){let t=e.definition;if(t.type===pi&&t.command){let r=[t.command].concat(t.args??[]);return await Es(e.scope,t,e.name,r,this.config.cargoRunner)}}};async function Es(n,e,t,r,i,o=!1){let s;if(i){let a=`${i}.buildShellExecution`;try{let c={kind:pi,args:r,cwd:e.cwd,env:e.env},l=await et.commands.executeCommand(a,c);if(l)if(l instanceof et.ShellExecution)s=l;else throw De.debug("Invalid cargo ShellExecution",l),"Invalid cargo ShellExecution."}catch(c){if(o)throw`Cargo runner '${i}' failed! ${c}`}}if(!s){let a=e.overrideCargo??e.overrideCargo,c=await Il(),g=[...(a==null?void 0:a.split(" "))??[c],...r];s=new et.ProcessExecution(g[0],g.slice(1),e)}return new et.Task(e,n??et.TaskScope.Workspace,t,RS,s,["$rustc"])}function hm(n){let e=new Fl(n);return et.tasks.registerTaskProvider(pi,e)}var gm=Oe(require("os")),Bt=Oe(require("vscode")),hi=Oe(require("path"));var gi=Bt.window.createOutputChannel("Debug");async function xs(n,e){var a;let t=(a=n.activeRustEditor)==null?void 0:a.document.uri;if(!t)return;let r=await mm(n,e);if(!r)return;let i=Bt.workspace.getConfiguration("launch",t),o=i.get("configurations")||[],s=o.findIndex(c=>c.name===r.name);if(s!==-1){if(await Bt.window.showErrorMessage(`Launch configuration '${r.name}' already exists!`,"Cancel","Update")==="Cancel")return;o[s]=r}else o.push(r);await i.update("configurations",o)}async function Ll(n,e){let t,r="",o=Bt.workspace.getConfiguration("launch").get("configurations")||[],s=o.findIndex(a=>a.name===e.label);return s!==-1?(t=o[s],r=" (from launch.json)",gi.clear()):t=await mm(n,e),t?(gi.appendLine(`Launching debug configuration${r}:`),gi.appendLine(JSON.stringify(t,null,2)),Bt.debug.startDebugging(void 0,t)):!1}async function mm(n,e){if(!n.activeRustEditor)return;let r={"vadimcn.vscode-lldb":TS,"ms-vscode.cpptools":SS},i=n.config.debug,o=null;if(i.engine==="auto"){for(var s in r)if(o=Bt.extensions.getExtension(s),o)break}else o=Bt.extensions.getExtension(i.engine);if(!o){await Bt.window.showErrorMessage("Install [CodeLLDB](https://marketplace.visualstudio.com/items?itemName=vadimcn.vscode-lldb) or [MS C++ tools](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools) extension for debugging.");return}gi.clear(),n.config.debug.openDebugPane&&gi.show(!0);let a=Bt.workspace.workspaceFolders,c=a.length>1,l=a[0],g=!c||!e.args.workspaceRoot?l:a.find(N=>{var $;return($=e.args.workspaceRoot)==null?void 0:$.includes(N.uri.fsPath)})||l,m=hi.normalize(g.uri.fsPath),h=c?`:${g.name}`:"";function C(N){return hi.normalize(N).replace(m,"${workspaceFolder"+h+"}")}let b=await DS(e),x=Al(e,n.config.runnableEnv),q=i.sourceFileMap;if(q==="auto"){let N=await fm(m),$=await dm(m),K=hi.normalize($+"/lib/rustlib/src/rust");q={},q[`/rustc/${N}/`]=K}let O=r[o.id](e,C(b),x,q);if(O.type in i.engineSettings){let N=i.engineSettings[O.type];for(var I in N)O[I]=N[I]}return O.name==="run binary"&&(O.name=`run ${hi.basename(b)}`),O.cwd&&(O.cwd=C(O.cwd)),O}async function DS(n){return await new fi(n.args.workspaceRoot||".",gi).executableFromArgs(n.args.cargoArgs)}function TS(n,e,t,r){return{type:"lldb",request:"launch",name:n.label,program:e,args:n.args.executableArgs,cwd:n.args.workspaceRoot,sourceMap:r,sourceLanguages:["rust"],env:t}}function SS(n,e,t,r){return{type:gm.platform()==="win32"?"cppvsdbg":"cppdbg",request:"launch",name:n.label,program:e,args:n.args.executableArgs,cwd:n.args.workspaceRoot,sourceFileMap:r,env:t}}var vm=[{iconPath:new Lr.ThemeIcon("save"),tooltip:"Save as a launch.json configuration."}];async function no(n,e,t=!1,r=!0){let i=n.activeRustEditor,o=n.client;if(!i||!o)return;let s={uri:i.document.uri.toString()},a=await o.sendRequest(Qg,{textDocument:s,position:o.code2ProtocolConverter.asPosition(i.selection.active)}),c=[];e&&c.push(e);for(let l of a)e&&JSON.stringify(e.runnable)===JSON.stringify(l)||t&&(l.label.startsWith("doctest")||l.label.startsWith("cargo"))||c.push(new Ml(l));if(c.length===0){await Lr.window.showErrorMessage("There's no debug target!");return}return await new Promise(l=>{let g=[],m=C=>{l(C),g.forEach(b=>b.dispose())},h=Lr.window.createQuickPick();h.items=c,h.title="Select Runnable",r&&(h.buttons=vm),g.push(h.onDidHide(()=>m()),h.onDidAccept(()=>m(h.selectedItems[0])),h.onDidTriggerButton(async C=>{await xs(n,h.activeItems[0].runnable),m()}),h.onDidChangeActive(C=>{r&&C.length>0&&(C[0].label.startsWith("cargo")?h.buttons=[]:h.buttons.length===0&&(h.buttons=vm))}),h),h.show()})}var Ml=class{constructor(e){this.runnable=e;this.label=e.label}};function Al(n,e){let t={RUST_BACKTRACE:"short"};if(n.args.expectTest&&(t.UPDATE_EXPECT="1"),Object.assign(t,process.env),e)if(Array.isArray(e))for(let r of e)(!r.mask||new RegExp(r.mask).test(n.label))&&Object.assign(t,r.env);else Object.assign(t,e);return t}async function jl(n,e){if(n.kind!=="cargo")throw`Unexpected runnable kind: ${n.kind}`;let t=$l(n),r={type:pi,command:t[0],args:t.slice(1),cwd:n.args.workspaceRoot||".",env:Al(n,e.runnableEnv),overrideCargo:n.args.overrideCargo},i=Lr.workspace.workspaceFolders[0],o=await Es(i,r,n.label,t,e.cargoRunner,!0);return o.presentationOptions.clear=!0,o.presentationOptions.focus=!1,o}function $l(n){let e=[...n.args.cargoArgs];return n.args.cargoExtraArgs&&e.push(...n.args.cargoExtraArgs),n.args.executableArgs.length>0&&e.push("--",...n.args.executableArgs),e}var Be=Oe(require("vscode"));var ks=class{constructor(e){this.astDecorationType=Be.window.createTextEditorDecorationType({borderColor:new Be.ThemeColor("rust_analyzer.syntaxTreeBorder"),borderStyle:"solid",borderWidth:"2px"});this.rust2Ast=new Hl(()=>{let e=this.findAstTextEditor();if(!this.rustEditor||!e)return;let t=[];for(let r=0;r<e.document.lineCount;++r){let i=e.document.lineAt(r);if(!(i.text.lastIndexOf('"')>=0))continue;let s=this.parseRustTextRange(this.rustEditor.document,i.text);!s||t.push([s,this.findAstNodeRange(i)])}return t});e.pushCleanup(Be.languages.registerHoverProvider({scheme:"rust-analyzer"},this)),e.pushCleanup(Be.languages.registerDefinitionProvider({language:"rust"},this)),Be.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument,this,e.subscriptions),Be.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,e.subscriptions),Be.window.onDidChangeVisibleTextEditors(this.onDidChangeVisibleTextEditors,this,e.subscriptions),e.pushCleanup(this)}dispose(){this.setRustEditor(void 0)}onDidChangeTextDocument(e){this.rustEditor&&e.document.uri.toString()===this.rustEditor.document.uri.toString()&&this.rust2Ast.reset()}onDidCloseTextDocument(e){this.rustEditor&&e.uri.toString()===this.rustEditor.document.uri.toString()&&this.setRustEditor(void 0)}onDidChangeVisibleTextEditors(e){if(!this.findAstTextEditor()){this.setRustEditor(void 0);return}this.setRustEditor(e.find(_n))}findAstTextEditor(){return Be.window.visibleTextEditors.find(e=>e.document.uri.scheme==="rust-analyzer")}setRustEditor(e){this.rustEditor&&this.rustEditor!==e&&(this.rustEditor.setDecorations(this.astDecorationType,[]),this.rust2Ast.reset()),this.rustEditor=e}provideDefinition(e,t){var a;if(!this.rustEditor||e.uri.toString()!==this.rustEditor.document.uri.toString())return;let r=this.findAstTextEditor();if(!r)return;let i=(a=this.rust2Ast.get())==null?void 0:a.find(([c,l])=>c.contains(t));if(!i)return;let[o,s]=i;return r.revealRange(s),r.selection=new Be.Selection(s.start,s.end),[{targetRange:s,targetUri:r.document.uri,originSelectionRange:o,targetSelectionRange:s}]}provideHover(e,t){if(!this.rustEditor)return;let r=e.lineAt(t.line),i=this.parseRustTextRange(this.rustEditor.document,r.text);if(!i)return;this.rustEditor.setDecorations(this.astDecorationType,[i]),this.rustEditor.revealRange(i);let o=this.rustEditor.document.getText(i),s=this.findAstNodeRange(r);return new Be.Hover(["```rust\n"+o+"\n```"],s)}findAstNodeRange(e){let t=e.range.start,r=t.translate(void 0,e.firstNonWhitespaceCharacterIndex),i=t.translate(void 0,e.text.trimEnd().length);return new Be.Range(r,i)}parseRustTextRange(e,t){let r=/(\d+)\.\.(\d+)/.exec(t);if(!r)return;let[i,o]=r.slice(1).map(s=>this.positionAt(e,+s));return new Be.Range(i,o)}positionAt(e,t){if(e.eol===Be.EndOfLine.LF)return e.positionAt(t);let r=0,i=0,o=this.cache;for((o==null?void 0:o.doc)===e&&o.offset<=t&&({line:r,offset:i}=o);;){let s=e.lineAt(r).text.length+1;if(i+s>t)return this.cache={doc:e,offset:i,line:r},e.positionAt(t+r);i+=s,r+=1}}},Hl=class{constructor(e){this.compute=e}get(){return this.val??(this.val=this.compute())}reset(){this.val=void 0}};var En=Oe(xl()),Pn=Oe(require("vscode"));var ro=Oe(Rn());var Wl=require("vscode");var Ot=Oe(require("vscode"));var ym=require("path"),qs=class{constructor(e){this.extensionId="rust-lang.rust-analyzer";this.rootSection="rust-analyzer";this.requiresWorkspaceReloadOpts=["serverPath","server","typing"].map(e=>`${this.rootSection}.${e}`);this.requiresReloadOpts=["cargo","procMacro","files","lens"].map(e=>`${this.rootSection}.${e}`).concat(this.requiresWorkspaceReloadOpts);this.package=Ot.extensions.getExtension(this.extensionId).packageJSON;this.globalStorageUri=e.globalStorageUri,Ot.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,e.subscriptions),this.refreshLogging()}refreshLogging(){De.setEnabled(this.traceExtension),De.info("Extension version:",this.package.version);let e=Object.entries(this.cfg).filter(([t,r])=>!(r instanceof Function));De.info("Using configuration",Object.fromEntries(e))}async onDidChangeConfiguration(e){this.refreshLogging();let t=this.requiresReloadOpts.find(s=>e.affectsConfiguration(s));if(!t)return;let r=this.requiresWorkspaceReloadOpts.find(s=>e.affectsConfiguration(s));if(!r&&this.restartServerOnConfigChange){await Ot.commands.executeCommand("rust-analyzer.reload");return}let i=r?`Changing "${r}" requires a window reload`:`Changing "${t}" requires a reload`,o=await Ot.window.showInformationMessage(i,"Reload now");if(o==="Reload now"){let s=r?"workbench.action.reloadWindow":"rust-analyzer.reload";o==="Reload now"&&await Ot.commands.executeCommand(s)}}get cfg(){return Ot.workspace.getConfiguration(this.rootSection)}get(e){return this.cfg.get(e)}get serverPath(){return this.get("server.path")??this.get("serverPath")}get serverExtraEnv(){let e=this.get("server.extraEnv")??{};return Object.fromEntries(Object.entries(e).map(([t,r])=>[t,typeof r!="string"?r.toString():r]))}get traceExtension(){return this.get("trace.extension")}get cargoRunner(){return this.get("cargoRunner")}get runnableEnv(){return this.get("runnableEnv")}get restartServerOnConfigChange(){return this.get("restartServerOnConfigChange")}get typingContinueCommentsOnNewline(){return this.get("typing.continueCommentsOnNewline")}get debug(){let e=this.get("debug.sourceFileMap");if(e!=="auto"){let{["/rustc/<id>"]:t,...r}=this.get("debug.sourceFileMap");e=r}return{engine:this.get("debug.engine"),engineSettings:this.get("debug.engineSettings"),openDebugPane:this.get("debug.openDebugPane"),sourceFileMap:e}}get hoverActions(){return{enable:this.get("hover.actions.enable"),implementations:this.get("hover.actions.implementations.enable"),references:this.get("hover.actions.references.enable"),run:this.get("hover.actions.run.enable"),debug:this.get("hover.actions.debug.enable"),gotoTypeDef:this.get("hover.actions.gotoTypeDef.enable")}}};async function Cm(n){let e=[["assist.allowMergingIntoGlobImports","imports.merge.glob"],["assist.exprFillDefault","assist.expressionFillDefault"],["assist.importEnforceGranularity","imports.granularity.enforce"],["assist.importGranularity","imports.granularity.group"],["assist.importMergeBehavior","imports.granularity.group"],["assist.importMergeBehaviour","imports.granularity.group"],["assist.importGroup","imports.group.enable"],["assist.importPrefix","imports.prefix"],["primeCaches.enable","cachePriming.enable"],["cache.warmup","cachePriming.enable"],["cargo.loadOutDirsFromCheck","cargo.buildScripts.enable"],["cargo.runBuildScripts","cargo.buildScripts.enable"],["cargo.runBuildScriptsCommand","cargo.buildScripts.overrideCommand"],["cargo.useRustcWrapperForBuildScripts","cargo.buildScripts.useRustcWrapper"],["completion.snippets","completion.snippets.custom"],["diagnostics.enableExperimental","diagnostics.experimental.enable"],["experimental.procAttrMacros","procMacro.attributes.enable"],["highlighting.strings","semanticHighlighting.strings.enable"],["highlightRelated.breakPoints","highlightRelated.breakPoints.enable"],["highlightRelated.exitPoints","highlightRelated.exitPoints.enable"],["highlightRelated.yieldPoints","highlightRelated.yieldPoints.enable"],["highlightRelated.references","highlightRelated.references.enable"],["hover.documentation","hover.documentation.enable"],["hover.linksInHover","hover.links.enable"],["hoverActions.linksInHover","hover.links.enable"],["hoverActions.debug","hover.actions.debug.enable"],["hoverActions.enable","hover.actions.enable.enable"],["hoverActions.gotoTypeDef","hover.actions.gotoTypeDef.enable"],["hoverActions.implementations","hover.actions.implementations.enable"],["hoverActions.references","hover.actions.references.enable"],["hoverActions.run","hover.actions.run.enable"],["inlayHints.chainingHints","inlayHints.chainingHints.enable"],["inlayHints.closureReturnTypeHints","inlayHints.closureReturnTypeHints.enable"],["inlayHints.hideNamedConstructorHints","inlayHints.typeHints.hideNamedConstructor"],["inlayHints.parameterHints","inlayHints.parameterHints.enable"],["inlayHints.reborrowHints","inlayHints.reborrowHints.enable"],["inlayHints.typeHints","inlayHints.typeHints.enable"],["lruCapacity","lru.capacity"],["runnables.cargoExtraArgs","runnables.extraArgs"],["runnables.overrideCargo","runnables.command"],["rustcSource","rustc.source"],["rustfmt.enableRangeFormatting","rustfmt.rangeFormatting.enable"]];for(let[t,r]of e){let i=n.inspect(t);if(i!==void 0){let o=[{val:i.globalValue,langVal:i.globalLanguageValue,target:Ot.ConfigurationTarget.Global},{val:i.workspaceFolderValue,langVal:i.workspaceFolderLanguageValue,target:Ot.ConfigurationTarget.WorkspaceFolder},{val:i.workspaceValue,langVal:i.workspaceLanguageValue,target:Ot.ConfigurationTarget.Workspace}];for(let{val:s,langVal:a,target:c}of o){let l=g=>g!==void 0&&!(typeof g=="object"&&g!==null&&(t==="completion.snippets"||!g.hasOwnProperty("custom")));l(s)&&(await n.update(r,s,c,!1),await n.update(t,void 0,c,!1)),l(a)&&(await n.update(r,a,c,!0),await n.update(t,void 0,c,!0))}}}}function wm(n){let e=new Set,t=new Set(Object.keys(n).map(c=>`env:${c}`)),r=Object.fromEntries(Object.entries(n).map(([c,l])=>{let g=new Set,m=new RegExp(/\${(?<depName>.+?)}/g),h;for(;h=m.exec(l);){let C=h.groups.depName;g.add(C),t.has(C)||e.add(C)}return[`env:${c}`,{deps:[...g],value:l}]})),i=new Set;for(let c of e){let l=/(?<prefix>.*?):(?<body>.+)/.exec(c);if(l){let{prefix:g,body:m}=l.groups;if(g==="env"){let h=m;r[c]={value:process.env[h]??"",deps:[]},i.add(c)}else r[c]={value:"${"+c+"}",deps:[]},i.add(c)}else r[c]={value:Rm(c),deps:[]}}let o=new Set(Object.keys(r)),s;do{s=o.size;for(let c of o)r[c].deps.every(l=>i.has(l))&&(r[c].value=r[c].value.replace(/\${(?<depName>.+?)}/g,(l,g)=>r[g].value),i.add(c),o.delete(c))}while(o.size>0&&o.size<s);let a={};for(let c of Object.keys(n))a[c]=r[`env:${c}`].value;return a}function Rm(n){let e={workspaceFolder:()=>{let t=Ot.workspace.workspaceFolders??[];return t.length===1||t.length>1?t[0].uri.fsPath:""},workspaceFolderBasename:()=>{let t=Rm("workspaceFolder");return t?ym.basename(t):""},cwd:()=>process.cwd(),execPath:()=>process.env.VSCODE_EXEC_PATH??process.execPath,pathSeparator:()=>ym.sep};return n in e?e[n]():"${"+n+"}"}var bm=require("crypto"),io=new Map;setInterval(function(){let e=[...io.keys()],t=e.slice(0,e.length-10);for(let r of t)io.delete(r)},10*60*1e3);function _S(n){let e=(0,bm.randomUUID)();return io.set(e,n),`[${n.title}](command:rust-analyzer.linkToCommand?${encodeURIComponent(JSON.stringify([e]))} '${n.tooltip}')`}function PS(n){let e=n.map(r=>(r.title?r.title+" ":"")+r.commands.map(_S).join(" | ")).join("___"),t=new Pn.MarkdownString(e);return t.isTrusted=!0,t}async function Dm(n,e,t){let r=wm(Object.assign({},process.env,t)),i={command:n,options:{env:r}},o={run:i,debug:i},s=Pn.workspace.getConfiguration("rust-analyzer");await Cm(s).catch(l=>{Pn.window.showErrorMessage(`Failed updating old config keys: ${l.message}`)}),e.kind==="Detached Files"&&(s={detachedFiles:e.files.map(l=>l.uri.fsPath),...s});let a={documentSelector:[{scheme:"file",language:"rust"}],initializationOptions:s,diagnosticCollectionName:"rustc",traceOutputChannel:Ul(),outputChannel:Kl(),middleware:{async handleDiagnostics(l,g,m){for(let h of g)if(h.message||(h.message=" "),h.relatedInformation)for(let C of h.relatedInformation)C.message||(C.message=" ");m(l,g)},async provideHover(l,g,m,h){var x;let C=Pn.window.activeTextEditor,b=(x=C==null?void 0:C.selection)!=null&&x.contains(g)?c.code2ProtocolConverter.asRange(C.selection):c.code2ProtocolConverter.asPosition(g);return c.sendRequest(Ag,{textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(l),position:b},m).then(q=>{let O=c.protocol2CodeConverter.asHover(q);if(O){let I=q.actions;I&&O.contents.push(PS(I))}return O},q=>(c.handleFailedRequest(En.HoverRequest.type,m,q,null),Promise.resolve(null)))},async provideCodeActions(l,g,m,h,C){let b={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(l),range:c.code2ProtocolConverter.asRange(g),context:await c.code2ProtocolConverter.asCodeActionContext(m,h)};return c.sendRequest(En.CodeActionRequest.type,b,h).then(async x=>{if(x===null)return;let q=[],O=new Map;for(let I of x){if(En.CodeAction.is(I)){eo(!I.command,"We don't expect to receive commands in CodeActions");let de=await c.protocol2CodeConverter.asCodeAction(I,h);q.push(de);continue}eo(ES(I),"We don't expect edits or commands here");let N=c.protocol2CodeConverter.asCodeActionKind(I.kind),$=new Pn.CodeAction(I.title,N),K=I.group;if($.command={command:"rust-analyzer.resolveCodeAction",title:I.title,arguments:[I]},$.edit=new Wl.WorkspaceEdit,K){let de=O.get(K);de||(de={index:q.length,items:[]},O.set(K,de),q.push($)),de.items.push($)}else q.push($)}for(let[I,{index:N,items:$}]of O)if($.length===1)q[N]=$[0];else{let K=new Pn.CodeAction(I);K.kind=$[0].kind,K.command={command:"rust-analyzer.applyActionGroup",title:"",arguments:[$.map(de=>({label:de.title,arguments:de.command.arguments[0]}))]},K.edit=new Wl.WorkspaceEdit,q[N]=K}return q},x=>{})}},markdown:{supportHtml:!0}},c=new En.LanguageClient("rust-analyzer","Rust Analyzer Language Server",o,a);return c.registerFeature(new zl),c}var zl=class{fillClientCapabilities(e){let t=e.experimental??{};t.snippetTextEdit=!0,t.codeActionGroup=!0,t.hoverActions=!0,t.serverStatusNotification=!0,t.commands={commands:["rust-analyzer.runSingle","rust-analyzer.debugSingle","rust-analyzer.showReferences","rust-analyzer.gotoLocation","editor.action.triggerParameterHints"]},e.experimental=t}initialize(e,t){}dispose(){}};function ES(n){let e=n;return e&&ro.string(e.title)&&(e.diagnostics===void 0||ro.typedArray(e.diagnostics,En.Diagnostic.is))&&(e.kind===void 0||ro.string(e.kind))&&e.edit===void 0&&e.command===void 0}function _m(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer-status://status");this.eventEmitter=new M.EventEmitter}provideTextDocumentContent(t){var o;if(!M.window.activeTextEditor)return"";let r={},i=(o=n.activeRustEditor)==null?void 0:o.document;return i!=null&&(r.textDocument=n.client.code2ProtocolConverter.asTextDocumentIdentifier(i)),n.client.sendRequest(Og,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer-status",e)),async()=>{let t=await M.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await M.window.showTextDocument(t,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function Pm(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer-memory://memory");this.eventEmitter=new M.EventEmitter}provideTextDocumentContent(t){return M.window.activeTextEditor?n.client.sendRequest(Ig).then(r=>`Per-query memory usage:
`+r+`
(note: database has been cleared)`):""}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer-memory",e)),async()=>{e.eventEmitter.fire(e.uri);let t=await M.workspace.openTextDocument(e.uri);return M.window.showTextDocument(t,M.ViewColumn.Two,!0)}}function Em(n){return async()=>{let e=n.client;!e||await e.sendRequest(Ng)}}function xm(n){return async()=>{let e=n.activeRustEditor,t=n.client;if(!e||!t)return;let r=await t.sendRequest(Vg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document),positions:e.selections.map(i=>t.code2ProtocolConverter.asPosition(i.active))});e.selections=e.selections.map((i,o)=>{let s=t.protocol2CodeConverter.asPosition(r[o]),a=i.isEmpty?s:i.anchor;return new M.Selection(a,s)}),e.revealRange(e.selection)}}function km(n){return async()=>{let e=n.activeRustEditor,t=n.client;if(!e||!t)return;let r=await t.sendRequest(Gg,{ranges:e.selections.map(o=>t.code2ProtocolConverter.asRange(o)),textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document)}),i=await t.protocol2CodeConverter.asTextEdits(r);await e.edit(o=>{i.forEach(s=>{o.replace(s.range,s.newText)})})}}function qm(n){return Im(n,"Up")}function Om(n){return Im(n,"Down")}function Im(n,e){return async()=>{let t=n.activeRustEditor,r=n.client;if(!t||!r)return;let i=await r.sendRequest(Zg,{range:r.code2ProtocolConverter.asRange(t.selection),textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(t.document),direction:e});if(!i)return;let o=await r.protocol2CodeConverter.asTextEdits(i);await Ss(t,o)}}function Nm(n){async function e(){let t=n.activeRustEditor,r=n.client;if(!t||!r)return!1;let i=await r.sendRequest(Xg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(t.document),position:r.code2ProtocolConverter.asPosition(t.selection.active)}).catch(s=>null);if(!i)return!1;let o=await r.protocol2CodeConverter.asTextEdits(i);return await Ss(t,o),!0}return async()=>{await e()||await M.commands.executeCommand("default:type",{text:`
`})}}function Fm(n){return async()=>{let e=M.window.activeTextEditor,t=n.client;if(!e||!t||!(Vn(e.document)||rm(e.document)))return;let r=await t.sendRequest(Bg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document),position:t.code2ProtocolConverter.asPosition(e.selection.active)});if(!!r)if(r.length===1){let i=r[0],o=t.protocol2CodeConverter.asUri(i.targetUri),s=t.protocol2CodeConverter.asRange(i.targetRange),a=await M.workspace.openTextDocument(o),c=await M.window.showTextDocument(a);c.selection=new M.Selection(s.start,s.start),c.revealRange(s,M.TextEditorRevealType.InCenter)}else{let i=e.document.uri.toString(),o=t.code2ProtocolConverter.asPosition(e.selection.active);await Vl(t,i,o,r.map(s=>oo.Location.create(s.targetUri,s.targetRange)))}}}function Lm(n){return async()=>{let e=n.activeRustEditor,t=n.client;if(!e||!t)return;let r=await t.sendRequest(Yg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document)});if(!r)return;let i=t.protocol2CodeConverter.asUri(r.uri),o=t.protocol2CodeConverter.asRange(r.range),s=await M.workspace.openTextDocument(i),a=await M.window.showTextDocument(s);a.selection=new M.Selection(o.start,o.start),a.revealRange(o,M.TextEditorRevealType.InCenter)}}function Am(n){return async()=>{let e=M.window.activeTextEditor,t=n.client;if(!e||!t)return;let r=e.selection.active,i=e.selections,o=n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document),s={value:"() ==>> ()",prompt:"Enter request, for example 'Foo($a) ==>> Foo::new($a)' ",validateInput:async c=>{try{await t.sendRequest(El,{query:c,parseOnly:!0,textDocument:o,position:r,selections:i})}catch(l){return l.toString()}return null}},a=await M.window.showInputBox(s);!a||await M.window.withProgress({location:M.ProgressLocation.Notification,title:"Structured search replace in progress...",cancellable:!1},async(c,l)=>{let g=await t.sendRequest(El,{query:a,parseOnly:!1,textDocument:o,position:r,selections:i});await M.workspace.applyEdit(await t.protocol2CodeConverter.asWorkspaceEdit(g,l))})}}function Mm(n){return async()=>{let{stdout:e}=(0,Sm.spawnSync)(n.serverPath,["--version"],{encoding:"utf8"}),t=e.slice(14).trim();M.window.showInformationMessage(`rust-analyzer version: ${t}`)}}function jm(n){return async()=>{let e=M.workspace.getConfiguration("editor.inlayHints",{languageId:"rust"}),t=e.get("enabled"),r;typeof t=="string"?r=t:r=t?"on":"off";let o={on:"off",off:"on",onUnlessPressed:"offUnlessPressed",offUnlessPressed:"onUnlessPressed"}[r]??"on";await e.update("enabled",o,M.ConfigurationTarget.Global)}}function $m(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer-syntax-tree://syntaxtree/tree.rast");this.eventEmitter=new M.EventEmitter;M.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),M.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Vn(t.document)&&to(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&_n(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor;if(!i)return"";let o=t.query==="range=true"&&!i.selection.isEmpty?n.client.code2ProtocolConverter.asRange(i.selection):null,s={textDocument:{uri:i.document.uri.toString()},range:o};return n.client.sendRequest(Mg,s,r)}get onDidChange(){return this.eventEmitter.event}};return new ks(n),n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer-syntax-tree",e)),n.pushCleanup(M.languages.setLanguageConfiguration("ra_syntax_tree",{brackets:[["[",")"]]})),async()=>{let t=M.window.activeTextEditor,i=!!t&&!t.selection.isEmpty?M.Uri.parse(`${e.uri.toString()}?range=true`):e.uri,o=await M.workspace.openTextDocument(i);e.eventEmitter.fire(i),await M.window.showTextDocument(o,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function Hm(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer-hir://viewHir/hir.rs");this.eventEmitter=new M.EventEmitter;M.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),M.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Vn(t.document)&&to(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&_n(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor,o=n.client;if(!i||!o)return"";let s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(i.document),position:o.code2ProtocolConverter.asPosition(i.selection.active)};return o.sendRequest(jg,s,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer-hir",e)),async()=>{let t=await M.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await M.window.showTextDocument(t,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function Wm(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer-file-text://viewFileText/file.rs");this.eventEmitter=new M.EventEmitter;M.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),M.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Vn(t.document)&&to(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&_n(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor,o=n.client;if(!i||!o)return"";let s=o.code2ProtocolConverter.asTextDocumentIdentifier(i.document);return o.sendRequest($g,s,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer-file-text",e)),async()=>{let t=await M.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await M.window.showTextDocument(t,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function zm(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer-item-tree://viewItemTree/itemtree.rs");this.eventEmitter=new M.EventEmitter;M.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),M.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Vn(t.document)&&to(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&_n(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor,o=n.client;if(!i||!o)return"";let s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(i.document)};return o.sendRequest(Hg,s,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer-item-tree",e)),async()=>{let t=await M.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await M.window.showTextDocument(t,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function Um(n,e){return async()=>{let t=M.Uri.file(Tm.join(n.extensionPath,"node_modules")),r=M.window.createWebviewPanel("rust-analyzer.crate-graph","rust-analyzer crate graph",M.ViewColumn.Two,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[t]}),i={full:e},o=await n.client.sendRequest(Wg,i),s=r.webview.asWebviewUri(t),a=`
            <!DOCTYPE html>
            <meta charset="utf-8">
            <head>
                <style>
                    /* Fill the entire view */
                    html, body { margin:0; padding:0; overflow:hidden }
                    svg { position:fixed; top:0; left:0; height:100%; width:100% }

                    /* Disable the graphviz background and fill the polygons */
                    .graph > polygon { display:none; }
                    :is(.node,.edge) polygon { fill: white; }

                    /* Invert the line colours for dark themes */
                    body:not(.vscode-light) .edge path { stroke: white; }
                </style>
            </head>
            <body>
                <script type="text/javascript" src="${s}/d3/dist/d3.min.js"><\/script>
                <script type="text/javascript" src="${s}/@hpcc-js/wasm/dist/index.min.js"><\/script>
                <script type="text/javascript" src="${s}/d3-graphviz/build/d3-graphviz.min.js"><\/script>
                <div id="graph"></div>
                <script>
                    let graph = d3.select("#graph")
                                  .graphviz()
                                  .fit(true)
                                  .zoomScaleExtent([0.1, Infinity])
                                  .renderDot(\`${o}\`);

                    d3.select(window).on("click", (event) => {
                        if (event.ctrlKey) {
                            graph.resetZoom(d3.transition().duration(100));
                        }
                    });
                <\/script>
            </body>
            `;r.webview.html=a}}function Km(n){return Um(n,!1)}function Vm(n){return Um(n,!0)}function Bm(n){function e(r){let i=`// Recursive expansion of ${r.name}! macro
`;return i+="// "+"=".repeat(i.length-3),i+=`

`,i+=r.expansion,i}let t=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer-expand-macro://expandMacro/[EXPANSION].rs");this.eventEmitter=new M.EventEmitter}async provideTextDocumentContent(r){let i=M.window.activeTextEditor,o=n.client;if(!i||!o)return"";let s=i.selection.active,a=await o.sendRequest(zg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(i.document),position:s});return a==null?"Not available":e(a)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer-expand-macro",t)),async()=>{let r=await M.workspace.openTextDocument(t.uri);return t.eventEmitter.fire(t.uri),M.window.showTextDocument(r,M.ViewColumn.Two,!0)}}function Gm(n){return async()=>n.client.sendRequest(Lg)}async function Vl(n,e,t,r){n&&await M.commands.executeCommand("editor.action.showReferences",M.Uri.parse(e),n.protocol2CodeConverter.asPosition(t),r.map(n.protocol2CodeConverter.asLocation))}function Xm(n){return async(e,t,r)=>{await Vl(n.client,e,t,r)}}function Qm(n){return async e=>{let t=await M.window.showQuickPick(e);!t||await M.commands.executeCommand("rust-analyzer.resolveCodeAction",t.arguments)}}function Jm(n){return async e=>{let t=n.client;if(t){let r=t.protocol2CodeConverter.asUri(e.targetUri),i=t.protocol2CodeConverter.asRange(e.targetSelectionRange);i=i.with({end:i.start}),await M.window.showTextDocument(r,{selection:i})}}}function Ym(n){return async()=>{let e=n.client,t=M.window.activeTextEditor;if(!t||!e)return;let r=t.selection.active,i={uri:t.document.uri.toString()},o=await e.sendRequest(Jg,{position:r,textDocument:i});o!=null&&await M.commands.executeCommand("vscode.open",M.Uri.parse(o))}}function Zm(n){return async()=>{await n.client.sendRequest(Kg)}}function ev(n){let e=n.client;return async t=>{var c;t.command=void 0;let r=await e.sendRequest(oo.CodeActionResolveRequest.type,t);if(!r.edit)return;let i=r.edit,o=await e.protocol2CodeConverter.asWorkspaceEdit(i),s={...i,documentChanges:(c=i.documentChanges)==null?void 0:c.filter(l=>"kind"in l)},a=await e.protocol2CodeConverter.asWorkspaceEdit(s);await M.workspace.applyEdit(a),await Ol(o),r.command!=null&&await M.commands.executeCommand(r.command.command,r.command.arguments)}}function tv(n){return async e=>{await Ol(e)}}function nv(n){let e;return async()=>{let t=await no(n,e);if(!t)return;t.detail="rerun",e=t;let r=await jl(t.runnable,n.config);return await M.tasks.executeTask(r)}}function rv(n){let e=n.client;return async()=>{let t=n.activeRustEditor;!t||!e||await M.window.withProgress({location:M.ProgressLocation.Notification,title:"Looking for tests...",cancellable:!1},async(r,i)=>{let o=t.document.uri.toString(),s=e.code2ProtocolConverter.asPosition(t.selection.active),c=(await e.sendRequest(Ug,{textDocument:{uri:o},position:s})).map(l=>oo.Location.create(l.runnable.location.targetUri,l.runnable.location.targetSelectionRange));await Vl(e,o,s,c)})}}function iv(n){return async e=>{if(!n.activeRustEditor)return;let r=await jl(e,n.config);return r.group=M.TaskGroup.Build,r.presentationOptions={reveal:M.TaskRevealKind.Always,panel:M.TaskPanelKind.Dedicated,clear:!0},M.tasks.executeTask(r)}}function ov(n){let e;return async()=>{let t=await no(n,e);if(!t)return;let r=$l(t.runnable),i=["cargo",...r].join(" ");await M.env.clipboard.writeText(i),await M.window.showInformationMessage("Cargo invocation copied to the clipboard.")}}function sv(n){let e;return async()=>{let t=await no(n,e,!0);if(!!t)return t.detail="restart",e=t,await Ll(n,t.runnable)}}function av(n){return async e=>{await Ll(n,e)}}function cv(n){return async()=>{let e=await no(n,void 0,!0,!1);!e||await xs(n,e.runnable)}}function uv(n){return async e=>{let t=io.get(e);if(n.client&&t){let{command:r,arguments:i=[]}=t;await M.commands.executeCommand(r,...i)}}}var Gt=Oe(require("vscode"));var Ar=class{constructor(e,t,r,i,o){this.config=e;this.extCtx=t;this.client=r;this.serverPath=i;this.statusBar=o}static async create(e,t,r,i){let o=await Dm(r,i,e.serverExtraEnv),s=Gt.window.createStatusBarItem(Gt.StatusBarAlignment.Left);t.subscriptions.push(s),s.text="rust-analyzer",s.tooltip="ready",s.command="rust-analyzer.analyzerStatus",s.show();let a=new Ar(e,t,o,r,s);return a.pushCleanup(o.start()),await o.onReady(),o.onNotification(Fg,c=>a.setServerStatus(c)),a}get activeRustEditor(){let e=Gt.window.activeTextEditor;return e&&_n(e)?e:void 0}get visibleRustEditors(){return Gt.window.visibleTextEditors.filter(_n)}registerCommand(e,t){let r=`rust-analyzer.${e}`,i=t(this),o=Gt.commands.registerCommand(r,i);this.pushCleanup(o)}get extensionPath(){return this.extCtx.extensionPath}get globalState(){return this.extCtx.globalState}get subscriptions(){return this.extCtx.subscriptions}setServerStatus(e){let t="",r=this.statusBar;switch(e.health){case"ok":r.tooltip=e.message??"Ready",r.command=void 0,r.color=void 0,r.backgroundColor=void 0;break;case"warning":r.tooltip=(e.message?e.message+`
`:"")+"Click to reload.",r.command="rust-analyzer.reloadWorkspace",r.color=new Gt.ThemeColor("statusBarItem.warningForeground"),r.backgroundColor=new Gt.ThemeColor("statusBarItem.warningBackground"),t="$(warning) ";break;case"error":r.tooltip=(e.message?e.message+`
`:"")+"Click to reload.",r.command="rust-analyzer.reloadWorkspace",r.color=new Gt.ThemeColor("statusBarItem.errorForeground"),r.backgroundColor=new Gt.ThemeColor("statusBarItem.errorBackground"),t="$(error) ";break}e.quiescent||(t="$(sync~spin) "),r.text=`${t}rust-analyzer`}pushCleanup(e){this.extCtx.subscriptions.push(e)}};var Os=class{constructor(e){this.globalState=e;let{serverVersion:t}=this;De.info("PersistentState:",{serverVersion:t})}get serverVersion(){return this.globalState.get("serverVersion")}async updateServerVersion(e){await this.globalState.update("serverVersion",e)}};var dv=require("child_process"),It,fv="inRustProject",Mr=null;function Ul(){return Mr||(Mr=pe.window.createOutputChannel("Rust Analyzer Language Server Trace")),Mr}var jr=null;function Kl(){return jr||(jr=pe.window.createOutputChannel("Rust Analyzer Language Server")),jr}async function pv(n){return await kS(n).catch(e=>{throw pe.window.showErrorMessage(`Cannot activate rust-analyzer: ${e.message}`),e})}async function kS(n){let e=new qs(n),t=new Os(n.globalState),r=await IS(n,e,t).catch(i=>{let o="bootstrap error. ";throw o+='See the logs in "OUTPUT > Rust Analyzer Client" (should open automatically). ',o+='To enable verbose logs use { "rust-analyzer.trace.extension": true }',De.error("Bootstrap error",i),new Error(o)});if((pe.workspace.workspaceFolders||[]).length===0){let i=pe.workspace.textDocuments.filter(o=>Vn(o));if(i.length>0)It=await Ar.create(e,n,r,{kind:"Detached Files",files:i});else throw new Error("no rust files are opened")}else It=await Ar.create(e,n,r,{kind:"Workspace Folder"}),It.pushCleanup(hm(It.config));return await qS(n,It),MS(),e.typingContinueCommentsOnNewline&&It.pushCleanup(jS()),pe.workspace.onDidChangeConfiguration(i=>{var o;return(o=It==null?void 0:It.client)==null?void 0:o.sendNotification("workspace/didChangeConfiguration",{settings:""}).catch(De.error)},null,It.subscriptions),{client:It.client}}async function qS(n,e){let t=pe.commands.registerCommand("rust-analyzer.onEnter",()=>pe.commands.executeCommand("default:type",{text:`
`}));n.subscriptions.push(t),await kl(fv,!0),e.registerCommand("reload",r=>async()=>{for(pe.window.showInformationMessage("Reloading rust-analyzer..."),await hv();n.subscriptions.length>0;)try{n.subscriptions.pop().dispose()}catch(i){De.error("Dispose error:",i)}await pv(n).catch(De.error)}),e.registerCommand("analyzerStatus",_m),e.registerCommand("memoryUsage",Pm),e.registerCommand("shuffleCrateGraph",Em),e.registerCommand("reloadWorkspace",Gm),e.registerCommand("matchingBrace",xm),e.registerCommand("joinLines",km),e.registerCommand("parentModule",Fm),e.registerCommand("syntaxTree",$m),e.registerCommand("viewHir",Hm),e.registerCommand("viewFileText",Wm),e.registerCommand("viewItemTree",zm),e.registerCommand("viewCrateGraph",Km),e.registerCommand("viewFullCrateGraph",Vm),e.registerCommand("expandMacro",Bm),e.registerCommand("run",nv),e.registerCommand("copyRunCommandLine",ov),e.registerCommand("debug",sv),e.registerCommand("newDebugConfig",cv),e.registerCommand("openDocs",Ym),e.registerCommand("openCargoToml",Lm),e.registerCommand("peekTests",rv),e.registerCommand("moveItemUp",qm),e.registerCommand("moveItemDown",Om),e.registerCommand("cancelFlycheck",Zm),t.dispose(),e.registerCommand("onEnter",Nm),e.registerCommand("ssr",Am),e.registerCommand("serverVersion",Mm),e.registerCommand("toggleInlayHints",jm),e.registerCommand("runSingle",iv),e.registerCommand("debugSingle",av),e.registerCommand("showReferences",Xm),e.registerCommand("applySnippetWorkspaceEdit",tv),e.registerCommand("resolveCodeAction",ev),e.registerCommand("applyActionGroup",Qm),e.registerCommand("gotoLocation",Jm),e.registerCommand("linkToCommand",uv)}async function OS(){Mr==null||Mr.dispose(),Mr=null,jr==null||jr.dispose(),jr=null,await hv()}async function hv(){await kl(fv,void 0),await(It==null?void 0:It.client.stop()),It=void 0}async function IS(n,e,t){let r=await FS(n,e,t);if(!r)throw new Error("Rust Analyzer Language Server is not available. Please, ensure its [proper installation](https://rust-analyzer.github.io/manual.html#installation).");if(De.info("Using server binary at",r),!im(r))throw e.serverPath?new Error(`Failed to execute ${r} --version. \`config.server.path\` or \`config.serverPath\` has been set explicitly.            Consider removing this config or making a valid server binary available at that path.`):new Error(`Failed to execute ${r} --version`);return r}async function NS(n){await pe.window.withProgress({location:pe.ProgressLocation.Notification,title:"Patching rust-analyzer for NixOS"},async(e,t)=>{let r=`
            {srcStr, pkgs ? import <nixpkgs> {}}:
                pkgs.stdenv.mkDerivation {
                    name = "rust-analyzer";
                    src = /. + srcStr;
                    phases = [ "installPhase" "fixupPhase" ];
                    installPhase = "cp $src $out";
                    fixupPhase = ''
                    chmod 755 $out
                    patchelf --set-interpreter "$(cat $NIX_CC/nix-support/dynamic-linker)" $out
                    '';
                }
            `,i=pe.Uri.file(n.fsPath+"-orig");await pe.workspace.fs.rename(n,i,{overwrite:!0});try{e.report({message:"Patching executable",increment:20}),await new Promise((o,s)=>{var c,l;let a=(0,dv.exec)(`nix-build -E - --argstr srcStr '${i.fsPath}' -o '${n.fsPath}'`,(g,m,h)=>{g!=null?s(Error(h)):o(m)});(c=a.stdin)==null||c.write(r),(l=a.stdin)==null||l.end()})}finally{await pe.workspace.fs.delete(i)}})}async function FS(n,e,t){let r=LS(e);if(r)return r.startsWith("~/")?lv.homedir()+r.slice(1):r;if(e.package.releaseTag===null)return"rust-analyzer";let i=process.platform==="win32"?".exe":"",o=pe.Uri.joinPath(n.extensionUri,"server",`rust-analyzer${i}`);if(await pe.workspace.fs.stat(o).then(()=>!0,()=>!1)){let a=o;if(await AS()){await pe.workspace.fs.createDirectory(e.globalStorageUri).then();let c=pe.Uri.joinPath(e.globalStorageUri,`rust-analyzer${i}`),l=await pe.workspace.fs.stat(c).then(()=>!0,()=>!1);l&&e.package.version!==t.serverVersion&&(await pe.workspace.fs.delete(c),l=!1),l||(await pe.workspace.fs.copy(o,c),await NS(c)),a=c}return await t.updateServerVersion(e.package.version),a.fsPath}await t.updateServerVersion(void 0),await pe.window.showErrorMessage("Unfortunately we don't ship binaries for your platform yet. You need to manually clone the rust-analyzer repository and run `cargo xtask install --server` to build the language server from sources. If you feel that your platform should be supported, please create an issue about that [here](https://github.com/rust-lang/rust-analyzer/issues) and we will consider it.")}function LS(n){return process.env.__RA_LSP_SERVER_DEBUG??n.serverPath}async function AS(){try{return((await pe.workspace.fs.readFile(pe.Uri.file("/etc/os-release"))).toString().split(`
`).find(t=>t.startsWith("ID="))||"ID=linux").indexOf("nixos")!==-1}catch{return!1}}function MS(){pe.extensions.getExtension("rust-lang.rust")&&pe.window.showWarningMessage("You have both the rust-analyzer (rust-lang.rust-analyzer) and Rust (rust-lang.rust) plugins enabled. These are known to conflict and cause various functions of both plugins to not work correctly. You should disable one of them.","Got it").then(()=>{},console.error)}function jS(){let n=pe.IndentAction.None;return pe.languages.setLanguageConfiguration("rust",{onEnterRules:[{beforeText:/^\s*\/{3}.*$/,action:{indentAction:n,appendText:"/// "}},{beforeText:/^\s*\/{2}\!.*$/,action:{indentAction:n,appendText:"//! "}},{beforeText:/^\s*\/\*(\*|\!)(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:pe.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*(\*|\!)(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:n,appendText:" * "}},{beforeText:/^(\ \ )*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:n,appendText:"* "}},{beforeText:/^(\ \ )*\ \*\/\s*$/,action:{indentAction:n,removeText:1}}]})}0&&(module.exports={activate,deactivate,outputChannel,traceOutputChannel});
